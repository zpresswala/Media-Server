var voiceBase=function(e){"use strict";var t={instances:[],init:function(e){var s=t.instances.length;t.instances.push(new t.create_instance(s,e)),s++,this.current_instance=s-1},create_instance:function(e,s){this.instance_index=e,this.player=new t.Player(this,s)}};t.default_settings={apiUrl:"https://api.voicebase.com/services",apiKey:null,externalId:null,apiVersion:"1.1",mediaId:null,password:null,token:null,tokenTimeOut:10,example:!1,exampleTokenUrl:"http://demo.voicsebasejwplayer.dev4.sibers.com/extoken.php",helpUrl:"http://www.voicebase.com/developers/",stream:!1,mediaTypeOverride:null,vbsButtons:{share:!0,comment:!0,downloadMedia:!0,downloadTranscript:!0,remove:!0,favorite:!0,help:!0,evernote:!0,edit:!1,print:!0,orderTranscript:!0,prev:!0,next:!0,fullscreen:!0,readermode:!0,pwrdb:!0,unquotes:!0},webHooks:{},addThisButtons:["gmail","facebook","twitter","google_plusone_share","compact"],mediumResponsiveWithSpeakers:600,mediumResponsive:450,minResponsive:400,voicebaseShare:!1,shareTitle:"Checkout this!",showMore:!1,shareParams:{},shareUrl:!1,trackEvents:!1,mediaBlock:"vbs-media",mediaWidth:!1,controlsBlock:"vbs-controls",controlsWidth:!1,searchBarOuter:!0,searchBarBlock:"vbs-searchbar-block",searchBarBlockWidth:!1,tabView:!1,tabViewForMobile:!0,keywordsBlock:"vbs-keywords",keywordsHeight:170,keywordsWidth:!1,keywordsResizable:!1,keywordsGroups:!0,keywordsCounter:!0,showAutoGeneratedKeywords:!0,editKeywords:!1,transcriptBlock:"vbs-transcript",transcriptHeight:148,transcriptWidth:!1,transcriptResizable:!1,transcriptHighlight:10,transcriptCheckTimer:10,turnTimes:!0,lineBreak:!1,commentsBlock:"vbs-comments",humanOnly:!1,animation:!0,localApp:!1,localSearch:!1,localSearchHelperUrl:"js/workers/",colors:["#78c361","#9932cc","#ff69b4","#6495ed","#ffd700","#f6a7a1","#7fb397","#009999"],filterSpeaker:"all",playerType:"youtube",playerId:"ytplayer",keywordsColumns:!1,topicHover:!0,zeroclipboard:"ZeroClipboard.swf",commentsUsername:!1,commentsUserhandle:!1,contextMenu:!0,debug:!0,toggleBlocks:!0,toggleMediaBlock:!0,toggleKeywordsBlock:!0,toggleTranscriptBlock:!0,toggleCommentBlock:!0,hasMediaBlockHeader:!0,hasKeywordsBlockHeader:!0,hasTranscriptBlockHeader:!0,hasCommentsBlockHeader:!0,showControlsBlock:!0,showKeywordsBlock:!0,showTranscriptBlock:!0,showCommentsBlock:!0,expandMediaBlock:!0,expandKeywordsBlock:!0,expandTranscriptBlock:!0,expandCommentsBlock:!1,expandNewsBlock:!1,newsUrl:"https://stage.voicebase.com/bing/search?query=",newsBlock:"vbs-news",newsWidth:!1,showNewsBlock:!1,toggleNewsBlock:!0,hasNewsBlockHeader:!0,markersInNativeTimeline:!1,cssPathForPlayerFrame:"css/vbs-kaltura-iframe.css",modalErrors:!1,modalSave:!1,nativePlaylist:!0,restrictions:[],ready:function(){}},t.settings={},t.reSettings=function(r){t.settings=jQuery.extend(!0,{},t.default_settings),t.data=jQuery.extend(!0,{},t.default_data);var n=t.common.keysToLowerCase(r);if(s(n,"apiUrl"),s(n,"apiKey"),s(n,"externalId"),s(n,"apiVersion"),s(n,"mediaId"),s(n,"password"),s(n,"token"),s(n,"tokenTimeOut"),s(n,"example"),s(n,"exampleTokenUrl"),s(n,"stream"),s(n,"debug"),s(n,"toggleBlocks"),s(n,"showControlsBlock"),s(n,"showKeywordsBlock"),s(n,"showTranscriptBlock"),s(n,"showCommentsBlock"),s(n,"showNewsBlock"),s(n,"newsUrl"),s(n,"modalErrors"),s(n,"mediaTypeOverride"),t.settings.toggleBlocks?(s(n,"toggleMediaBlock"),s(n,"toggleKeywordsBlock"),s(n,"toggleTranscriptBlock"),s(n,"toggleCommentBlock"),s(n,"toggleNewsBlock"),s(n,"expandMediaBlock"),s(n,"expandKeywordsBlock"),s(n,"expandTranscriptBlock"),s(n,"expandCommentsBlock"),s(n,"expandNewsBlock")):(t.settings.toggleMediaBlock=!1,t.settings.toggleKeywordsBlock=!1,t.settings.toggleTranscriptBlock=!1,t.settings.toggleCommentBlock=!1,t.settings.toggleNewsBlock=!1,t.settings.expandMediaBlock=!0,t.settings.expandKeywordsBlock=!0,t.settings.expandTranscriptBlock=!0,t.settings.expandCommentsBlock=!0,t.settings.expandNewsBlock=!0),t.settings.toggleMediaBlock||(t.settings.expandMediaBlock=!0),t.settings.toggleKeywordsBlock||(t.settings.expandKeywordsBlock=!0),t.settings.toggleTranscriptBlock||(t.settings.expandTranscriptBlock=!0),t.settings.toggleCommentBlock||(t.settings.expandCommentsBlock=!0),t.settings.toggleNewsBlock||(t.settings.expandNewsBlock=!0),s(n,"hasMediaBlockHeader"),t.settings.hasMediaBlockHeader||(t.settings.toggleMediaBlock=!1),s(n,"hasKeywordsBlockHeader"),t.settings.hasKeywordsBlockHeader||(t.settings.toggleKeywordsBlock=!1),s(n,"hasTranscriptBlockHeader"),t.settings.hasTranscriptBlockHeader||(t.settings.toggleTranscriptBlock=!1),s(n,"hasCommentsBlockHeader"),t.settings.hasCommentsBlockHeader||(t.settings.toggleCommentBlock=!1),s(n,"hasNewsBlockHeader"),t.settings.hasNewsBlockHeader||(t.settings.toggleNewsBlock=!1),"undefined"!=typeof n.actionflag)for(var i in n.actionflag)t.settings.vbsButtons[i]=n.actionflag[i];if(s(n,"webHooks"),s(n,"helpUrl"),t.settings.helpUrl||t.settings.webHooks.help||(t.settings.vbsButtons.help=!1),s(n,"mediumResponsiveWithSpeakers"),s(n,"mediumResponsive"),s(n,"minResponsive"),s(n,"showMore"),s(n,"animation"),s(n,"playerType"),s(n,"playerId"),s(n,"contextMenu"),s(n,"trackEvents"),s(n,"shareParams"),s(n,"shareUrl"),s(n,"shareTitle"),s(n,"addThisButtons"),s(n,"voicebaseShare"),s(n,"zeroclipboard"),s(n,"mediaBlock"),a(n,"mediaWidth"),s(n,"controlsBlock"),a(n,"controlsWidth"),s(n,"tabView"),s(n,"tabViewForMobile"),t.helper.isMobile()&&t.settings.tabViewForMobile&&(t.settings.tabView=!0),t.settings.tabView?(t.settings.searchBarOuter=!0,e("#"+n.keywordsblock).empty()):(s(n,"searchBarOuter"),s(n,"keywordsBlock"),s(n,"keywordsHeight"),a(n,"keywordsWidth")),t.settings.searchBarOuter&&(s(n,"searchBarBlock"),a(n,"searchBarBlockWidth")),s(n,"keywordsColumns"),s(n,"keywordsResizable"),s(n,"editKeywords"),s(n,"localApp"),s(n,"localSearch"),t.settings.localApp&&"undefined"!=typeof Fuse&&(t.settings.localSearch=!0,t.settings.showCommentsBlock=!1,t.settings.vbsButtons.edit=!1,t.settings.vbsButtons.downloadMedia=!1,t.settings.vbsButtons.downloadTranscript=!1,t.settings.vbsButtons.favorite=!1,t.settings.vbsButtons.remove=!1,t.settings.vbsButtons.share=!1,t.settings.vbsButtons.orderTranscript=!1),"undefined"==typeof Fuse&&(t.settings.localSearch=!1),s(n,"localSearchHelperUrl"),t.settings.localSearch&&"undefined"==typeof localSearchHelper&&jQuery.ajax({url:t.settings.localSearchHelperUrl+"localSearchHelper.js",dataType:"script",async:!0}),s(n,"topicHover"),s(n,"keywordsGroups"),s(n,"showAutoGeneratedKeywords"),s(n,"keywordsCounter"),t.settings.tabView?e("#"+n.transcriptblock).empty():(s(n,"transcriptBlock"),s(n,"transcriptHeight"),a(n,"transcriptWidth")),s(n,"transcriptResizable"),s(n,"transcriptHighlight"),s(n,"turnTimes"),s(n,"lineBreak"),s(n,"humanOnly"),t.settings.tabView?e("#"+n.commentsblock).empty():(s(n,"commentsBlock"),a(n,"commentsWidth")),s(n,"commentsUsername"),s(n,"commentsUserhandle"),"jwplayer"==t.settings.playerType){var o=jwplayer(t.settings.playerId).config.playlist;t.settings.hasPlaylist=!(!(o&&o.length>1)||t.settings.mediaId)}t.settings.tabView?e("#"+n.newsblock).empty():(s(n,"newsBlock"),a(n,"newsWidth")),s(n,"markersInNativeTimeline"),t.settings.markersInNativeTimeline&&(t.settings.showControlsBlock=!1),s(n,"cssPathForPlayerFrame"),s(n,"modalSave"),s(n,"nativePlaylist"),s(n,"restrictions"),t.settings.restrictions.length>0&&(t.settings.vbsButtons.edit=t.settings.restrictions.indexOf("updateTranscript")>-1,t.settings.editKeywords=t.settings.restrictions.indexOf("manageKeywords")>-1,t.settings.vbsButtons.remove=t.settings.restrictions.indexOf("deleteFile")>-1,t.settings.vbsButtons.share=t.settings.restrictions.indexOf("manageShares")>-1),s(n,"ready")};var s=function(e,s){var a=s.toLowerCase();t.settings[s]="undefined"!=typeof e[a]?e[a]:t.settings[s]},a=function(e,s){var a=s.toLowerCase();t.helper.isMobile(),t.settings[s]="undefined"!=typeof e[a]?e[a]<220?220:e[a]:t.settings[s]};return t.default_data={customMarkers:{},speakers:{},allSpeakers:[],vbsSpeakers:{},keywords:{},duration:null,vclass:null,sclass:null,position:0,commentsThreads:null,startParams:[],played:0,playerDom:null,playerHeight:null,movelistner:!1,dragging:!1,draggingVol:!1,kf:!1,tf:!1,lspeaker:null,clicker:!1,waiterSave:!1,metadataWaiter:!1,isSaving:!1,searcht:null,searchHits:null,localData:{},isMobile:!1,keywordClickEvent:null,playlist_meta:null,highlightSnippets:null},t.data={},e.fn.voicebase=function(s){return t.methods[s]?t.methods[s].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof s&&s?(e.error("Method "+s+" does not exist on jQuery.vbplugin"),void 0):t.methods.init.apply(this,arguments)},t}(jQuery);voiceBase=function(e,t){"use strict";return e.api={inited:!1,init:function(){this.inited=!0,this.parameters=jQuery.extend(!0,{},this.default_parameters),e.settings.mediaId?(this.parameters.mediaid=e.settings.mediaId,delete this.parameters.externalid):(this.parameters.externalid=e.settings.externalId,delete this.parameters.mediaid),e.settings.token||e.settings.example?(this.parameters.token=e.settings.token,delete this.parameters.apikey,delete this.parameters.password):(delete this.parameters.token,this.parameters.apikey=e.settings.apiKey,this.parameters.password=e.settings.password),e.api.response={metadata:null,keywords:null,transcript:null,comments:null},e.api.data={keywords:{},comments:{},tmp:{}},e.api.ready={metadata:!1,keywords:!1,transcript:!1,comments:!1},e.api.errors={processing:0,failure:0},this.showProcessingMsg=!1,this.endSearch=!1},default_parameters:{version:e.default_settings.apiVersion,ModPagespeed:"off"},parameters:{},getToken:function(t){if(e.helper.isApi2_0())e.api2_0.getToken();else{var s={};jQuery.extend(s,this.parameters),s.action="getToken",s.timeout=t,delete s.mediaid,delete s.externalid,e.settings.restrictions&&e.settings.restrictions.length>0&&(s.privs=e.settings.restrictions.join(",")),e.api.call(s,e.api.setToken)}},setToken:function(t){"SUCCESS"==t.requestStatus?(e.settings.token=t.token,e.api.parameters.token=t.token,delete e.api.parameters.apikey,delete e.api.parameters.password,e.view.initWithToken()):alert(t.statusMessage)},getExampleToken:function(){var t={};e.api.callCustom(e.settings.exampleTokenUrl,t,e.api.setExampleToken)},setExampleToken:function(t){t.success===!0?(e.settings.token=t.token,e.api.parameters.token=t.token,e.view.initWithToken()):alert(t.message)},getMetaData:function(){e.data.metadataWaiter=setInterval(function(){if(e.data.metadataWaiter&&e.PlayerApi.isPlayerReady())if(clearInterval(e.data.metadataWaiter),e.data.metadataWaiter=null,e.settings.hasPlaylist&&e.settings.stream){var t=e.PlayerApi.getPlaylist();if(e.data.playlist_meta){var s=e.PlayerApi.getCurrentPlaylistItem(),a=e.PlayerApi.getPlaylistItemId(s);e.api.setMetaData(e.data.playlist_meta.metadata[a.id])}else e.api.getMetaDataForPlaylist(t)}else if(e.helper.isApi2_0())e.api2_0.getMetaData();else{var r={};jQuery.extend(r,e.api.parameters),r.action="getFileMetaData",r.confidence="0.0",e.api.call(r,e.api.setMetaData)}},10)},setMetaData:function(s){var a=e.helper.find(".vbs-media-block");if("SUCCESS"!=s.requestStatus&&(s=e.api.createMetaData()),"SUCCESS"==s.requestStatus&&"PROCESSING"!=s.response.fileStatus){s.self_made&&(a.find(".vbs-download-audio-btn").addClass("vbs-disable-button"),a.find(".vbs-del-btn").addClass("vbs-disable-button"),a.find(".vbs-star-btn").addClass("vbs-disable-button")),e.api.response.metadata=s,s.response.lengthMs?(e.data.duration=s.response.lengthMs/1e3,e.view.renderTimeInMediaTitle()):t(".vbs-time").hide(),e.helper.find(".voicebase_record_times").show(),e.helper.find(".vplayer").show();var r=t("#"+e.settings.playerId);if("jwplayer"==e.settings.playerType)e.data.playerDom="flash"===e.PlayerApi.getRenderingMode()?r.parent():r,e.data.playerDom.addClass("vbs-player-wrapper vbs-"+e.helper.randId());else if("kaltura"==e.settings.playerType)e.data.playerDom=t("#"+e.settings.playerId),e.data.playerDom.addClass("vbs-player-wrapper vbs-"+e.helper.randId());else if("sublime"==e.settings.playerType){e.data.playerDom=r.parent(),e.data.playerDom.addClass("vbs-player-wrapper vbs-"+e.helper.randId());var n=t("#"+e.settings.controlsBlock);n.find(".vbs-record-player").addClass("vbs-1-right-btns").find(".vbs-volume-toolbar").remove()}else if("jplayer"==e.settings.playerType){var i=e.instances[e.current_instance].player.interface;i&&(e.data.playerDom=i.getGui(),e.data.playerDom.addClass("vbs-player-wrapper vbs-"+e.helper.randId()))}else 0===t(".vbs-player-wrapper").length&&(e.data.playerDom=t("#"+e.settings.playerId),e.data.playerDom.before('<div class="vbs-player-wrapper vbs-'+e.helper.randId()+'"></div>'));if(e.helper.isMediaTypeEqualVideo()){a.addClass("vbs-video"),t(".vbs-video .vbs-section-title").attr("data-title","Hide Video"),e.helper.find(".vbs-record-player").addClass("vbs-video");var o=e.helper.findc(".vbs-player-wrapper"),l=t("#"+e.settings.playerId).width();t("#"+e.settings.mediaBlock).insertBefore(o).css("width",l),l<e.settings.mediumResponsive&&l>=e.settings.minResponsive?a.addClass("less-600px"):l<e.settings.minResponsive&&a.addClass("less-600px").addClass("less-460px"),e.settings.vbsButtons.fullscreen&&a.find(".vbs-section-btns ul").append('<li><a href="#" class="vbs-expand-btn" data-title="Expand Video"></a></li>'),e.settings.expandMediaBlock||e.helper.find(".vbs-media-block .vbs-section-title").click()}else e.PlayerApi.hidePlayer();e.helper.adjustMediaTime(),s.response.isFavorite?e.helper.find(".vbs-star-btn").addClass("vbs-active").attr("data-title","Remove to Favorites"):e.helper.find(".vbs-star-btn").attr("data-title","Add from Favorites"),e.helper.checkAutoStart()}else a.append(e.templates.get("disabler")),e.helper.find(".vbs-record-player").append(e.templates.get("disabler")),e.api.setErrors(s);e.api.ready.metadata=!0},getMetaDataForPlaylist:function(s){e.data.playlist_meta={},e.data.playlist_meta.promises=[],e.data.playlist_meta.metadata={};for(var a=0;a<s.length;a++){var r=s[a];e.api.setMetaDataPromise(r)}t.when.apply(this,e.data.playlist_meta.promises).then(function(){e.api.resolveMetaDataPromise(s)})},setMetaDataPromise:function(s){var a={};jQuery.extend(a,this.parameters),a.action="getFileMetaData",a.confidence="0.0",delete a.mediaid,delete a.externalid;var r;s.vbs_mediaid?a.mediaid=r=s.vbs_mediaid:s.vbs_externalid&&(a.externalid=r=s.vbs_externalid);var n=t.getJSON(e.settings.apiUrl,a).done(function(t){e.data.playlist_meta.metadata[r]=t}).fail(function(e){console.log(e)});e.data.playlist_meta.promises.push(n)},resolveMetaDataPromise:function(t){for(var s=[],a=0;a<t.length;a++){var r=t[a],n=e.PlayerApi.getPlaylistItemId(r),i=n.id;if(e.data.playlist_meta.metadata[i]){var o,l=e.data.playlist_meta.metadata[i].response;l?o=e.PlayerApi.getStreamUrl(l):(o=r.file,e.data.playlist_meta.metadata[i]=e.api.createMetaData());var d={file:o,title:r.title};n.isMediaid?d.vbs_mediaid=i:d.vbs_externalid=i,s.push(d),0===a&&e.api.setMetaData(e.data.playlist_meta.metadata[i])}}e.PlayerApi.loadFile(s)},setLocalMetaData:function(){e.data.localData.metadata=e.api.createMetaData(),e.api.setMetaData(e.data.localData.metadata)},createMetaData:function(){var t=1e3*e.PlayerApi.getDuration(),s=t>0?t:0;return{requestStatus:"SUCCESS",self_made:!0,response:{lengthMs:s,hasVideo:!0,isFavorite:!1}}},getKeywords:function(){var t={};jQuery.extend(t,this.parameters),t.action="getFileAnalyticsSnippets",t.returnCategories="1",t.includeStartTimes=!0,e.settings.keywordsGroups&&(t.returnGroups=!0),e.api.call(t,e.api.setKeywords)},setKeywords:function(s){var a=e.helper.find(".vbs-keywords-block");if("SUCCESS"==s.requestStatus){e.api.response.keywords=s;var r=[],n=[],i=[],o=[];for(var l in s.categories)n.push(s.categories[l]);if(e.settings.keywordsGroups)for(l in s.groups)n.push(s.groups[l]);r=s.keywords;var d=jQuery.map(n,function(t){var s=e.speakers.parseSpeakersInCategory(t,o,i);return o=s.speakersName,i=s.speakersArray,{name:t.name,score:t.score,subcategories:t.subcategories,similarCategories:t.similarCategories,speakers:s.isps,type:t.type}});d.sort(function(e,t){return e.score-t.score}),d.reverse();var c={name:"ALL TOPICS",keywords:r,subcategories:{},similarCategories:{},speakers:i.join()};d.unshift(c);var p=[];for(var v in s.keywords)p.push(s.keywords[v].name);e.data.keywords=p,n.push(c);var u='<ul class="vbs-topics-list">',b="",m=0;for(var f in d)if("undefined"!=typeof d[f]){var h="";if("undefined"!=typeof d[f].subcategories&&d[f].subcategories.length)for(var g in d[f].subcategories)h+=d[f].subcategories[g].name+"<br/>";var y="group"==d[f].type?"group":"",k="ALL TOPICS"==d[f].name?"vbs-all-topics":y;b+=" "+e.templates.parse("categoriesLiTemplate",{title:d[f].name,subcategories:h,speakers:d[f].speakers,liclass:k}),m++}u+=b+"</ul>",n.sort(function(e,t){return t.keywords.length-e.keywords.length});var w=[],C=t();for(var _ in n){var S="group"==n[_].type?'class="group"':"",x="ALL TOPICS"==n[_].name?'class=""':S,T=t('<ul tid="'+n[_].name+'" '+x+"></ul>"),B=n[_].keywords;for(l in B){{var P="",I=[],M=[];B[l]}for(var A in B[l].t){if(""!==B[l].t&&B[l].t[A]){var D=B[l].t[A];for(var E in D)M.push(D[E])}var H=e.helper.replaceAndTrim(A),N=e.speakers.getSpeakerKeyByName(H);P+="data-spt-"+N+'="'+(""!==B[l].t&&B[l].t[A]?B[l].t[A].join():"")+'" ',I.push(N),"-1"==w.indexOf(H)&&w.push(H)}var j=B[l].t?'class="key"':"",U="undefined"==typeof B[l].internalName?B[l].name:B[l].internalName.join(),R=e.settings.keywordsCounter?" <span>("+M.length+")</span>":"",O="<li "+j+'>   <a href="#" t="'+M.join()+'" speakers="'+I+'" '+P+">"+B[l].name+"</a>"+R+"</li>",K=t(O);K.find("a").data("keywordInternalName",U),T.append(K)}C=C.add(T)}e.settings.keywordsColumns&&"auto"!=e.settings.keywordsColumns&&e.helper.find(".vbs-keywords-list-wrapper").addClass(e.helper.getColumnClassByNumber(e.settings.keywordsColumns)),a.find(".vbs-topics").html(u),a.find(".vbs-keywords-list-tab").html(C),e.settings.showAutoGeneratedKeywords?a.find(".vbs-topics").find("li").first().click():e.helper.hideAutoGeneratedKeywords(),e.settings.expandKeywordsBlock?a.slideDown("fast",function(){e.settings.keywordsColumns&&"auto"==e.settings.keywordsColumns?e.helper.keywordsAutoColumns():e.settings.keywordsColumns&&"topics"==e.settings.keywordsColumns&&e.helper.keywordsAutoTopicsColumns()}):(a.show(),a.find(".vbs-section-title").attr("data-title","Show Keywords"),a.find(".vbs-section-body").hide(),a.find(".vbs-search-form").hide())}else a.append(e.templates.get("disabler")),e.settings.tabView||(a.show(),a.find(".vbs-search-form").hide(),a.find(".vbs-section-body").hide()),e.settings.searchBarOuter&&(t("#vbs-voice_search_txt").prop("disabled","disabled"),t("#vbs-searchbar-block").find(".vbs-search-form").addClass("vbs-form-disabled")),e.api.setErrors(s);e.api.ready.keywords=!0},getTranscript:function(){var t={};jQuery.extend(t,this.parameters),t.action="getKeywords",t.confidence="0.0",e.api.call(t,e.api.setTranscript)},setTranscript:function(s){e.api.response.transcript=s;var a=e.helper.find(".vbs-transcript-block");if(("FAILURE"==s.requestStatus||"MACHINECOMPLETE"!=s.fileStatus&&"HUMANCOMPLETE"!=s.fileStatus)&&(e.api.ready.transcript=!0,e.api.setErrors(s),"FAILURE"===s.requestStatus&&(!s.transcript||s.transcript&&0===s.transcript.length)))return a.addClass("vbs-ho").append(e.templates.get("disabler")).show(),!1;if("human"==s.transcriptType?a.addClass("vbs-human").find(".vbs-section-title").attr("data-title","Hide Transcript"):e.settings.vbsButtons.orderTranscript&&a.addClass("vbs-with-order-btn"),e.settings.humanOnly&&"machine"==s.transcriptType)return!1;for(var r=[],n="",i=0,o=s.transcript,l=0,d=0,c=!1,p=o.length,v=0;p>v;v++){var u=o[v];0===v&&(n+='<span t="0">');for(var b=2;10>=b;b++)Math.floor(u.s/1e3)>=l+e.settings.transcriptHighlight*b&&(l+=e.settings.transcriptHighlight*b,n+='<span t="'+l+'"></span>');Math.floor(u.s/1e3)>=l+e.settings.transcriptHighlight&&(l+=e.settings.transcriptHighlight,n+='</span><span t="'+l+'">'),i+=u.s;var m=e.helper.isTurn(u.m),f=e.speakers.createSpeakerAttr(u);d=m?d+1:d;var h=m&&v>2?"<br/><br/>":"",g=e.settings.lineBreak&&"undefined"!=typeof o[v-1]&&o[v].s-o[v-1].e>1e3*e.settings.lineBreak?"<br/><br/>":"",y="";0===v&&"undefined"==typeof u.m&&(y="data-f=true",c=!0);var k=e.helper.replaceN(u.w);n+=u.w.match(/\w+/g)?h+g+'<span class="w vbs-trans-word" t="'+u.s+'" '+f+" "+y+"> "+k+"</span>":'<span class="vbs-punc vbs-trans-word" t="'+u.s+'" '+f+">"+k+"</span>"}n+="</span>",a.find(".vbs-transcript-wrapper").html(n),d&&c&&a.find(".vbs-transcript-wrapper span[data-f=true]").before('<span class="w" t="0" m=">> "><br><br>&gt;&gt; </span>'),a.not(".vbs-human").length&&!e.settings.expandTranscriptBlock&&(a.find(".vbs-section-body").hide(),a.find(".vbs-section-title").addClass("vbs-hidden").attr("data-title","Show Transcript")),a.find(".vbs-transcript-prewrapper").css("height",e.settings.transcriptHeight+"px"),a.slideDown("fast");var w=e.settings.apiUrl.replace("services","orderTranscript"),C=e.settings.mediaId?e.settings.mediaId:e.settings.externalId,_=w+"/"+C+"?token="+e.settings.token+"&cancel=close";if(e.helper.find(".vbs-order-human-trans a").attr("href",_),t.map(s.transcript,function(e){r.push(e.w)}),e.api.ready.transcript=!0,e.settings.transcriptResizable&&t.isFunction(t.fn.resizable)){var S=t("#"+e.settings.transcriptBlock),x=S.find(".vbs-section-body"),T=S.width(),B=S.offset(),P=B&&B.left?t(document).width()-Math.round(B.left)-10:S.width();e.helper.find(".vbs-resizable").resizable({minWidth:T,maxWidth:P,resize:function(){var s=t(this).width();x.width(s),x.siblings(".vbs-section-header").width(s),e.helper.checkScrollForResize(x)}}),e.helper.checkScrollForResize(x)}"REPROCESSING"!=s.fileStatus||e.settings.modalSave||(e.helper.setIsSaving(!0),e.api.triggerTranscriptStatus())},searchInfo:function(){var t=this;t.showProcessingMsg=!1,t.endSearch=!1,setTimeout(function(){t.showProcessingMsg=!0,t.endSearch||e.helper.showMessage("Processing your search...","info")},500),setTimeout(function(){if(!t.endSearch&&t.showProcessingMsg){e.helper.clearMessage();var s=e.templates.get("endSearchMessage");e.helper.appendMessage(s)}},2e3)},getSearch:function(t,s){var a=this,r=e.api.validateSearch(t);if(!r)return e.helper.showMessage("Search phrase is invalid. Its length can be up to 254 characters.","error"),e.helper.hideLoader(),!1;if(e.data.clicker=!0,e.data.keywordClickEvent||e.helper.collapseNewsBlock(),s=!("undefined"!=typeof s&&s===!1),e.settings.localSearch)e.api.getLocalSearch(t,s);else{var n=t.join(" ").toLowerCase(),i={};jQuery.extend(i,this.parameters),i.action="searchFile",i.terms=n,e.api.searchInfo(),e.api.call(i,function(t,s){a.endSearch=!0,t.numberOfHits>1e3&&e.helper.showMessage("Displaying your search results...","info"),e.api.setSearch(t,s)},{start:s,terms:t})}},validateSearch:function(e){var t=e.join(" ");return t.length<255},getLocalSearch:function(s,a){var r,n=this;window.Worker&&"undefined"!=typeof localSearchHelper?(e.api.searchInfo(),e.data.searchWorker=new Worker(e.settings.localSearchHelperUrl+"localSearchWorker.js"),e.data.searchWorker.onerror=function(t){e.helper.showMessage("Search error!","error"),console.log(["ERROR: Line ",t.lineno," in ",t.filename,": ",t.message].join(""))},e.data.searchWorker.onmessage=function(i){clearInterval(e.events.time),e.events.time=null,n.endSearch=!0,r=i.data.results;var o=0;r.hits.hits.forEach(function(e){o+=e.hits.length}),o>1e3&&e.helper.showMessage("Displaying your search results...","info");var l=setInterval(function(){l&&t(".vbs-markers").find(".vbs-marker").length===o&&(clearInterval(l),l=null,e.helper.clearMessage(),e.helper.setOnTimeInterval())},100);setTimeout(function(){e.api.setSearch(r,{start:a,terms:s})},10)},e.data.searchWorker.postMessage({transcript:e.api.response.transcript.transcript,terms:s})):(r=localSearchHelper.localTranscriptSearch(e.api.response.transcript.transcript,s),e.api.setSearch(r,{start:a,terms:s}))},setSearch:function(s,a){console.time("setSearch");var r=a.start,n=a.terms;e.data.clicker=!1;var i=e.helper.find(".vbs-record-timeline-wrap");e.data.markersStyles={markersWrapper:i,markersContainer:i.find(".vbs-markers"),markersWrapperWidth:i.width()};var o={};if(e.helper.find(".vbs-widget .vbs-word").each(function(e,s){var a=t(s),r=a.find(".vbs-search_word").text().replace(/"/g,"").trim().toLowerCase();o[r]=a.find(".vbs-marker").css("border-bottom-color")}),"SUCCESS"==s.requestStatus){var l=[];if(s.hits.length){var d=0,c="";s.hits.hits.map(function(t){var s=[],a=[];t.hits.map(function(r){if(e.speakers.filterResultForSpeaker(r.time)){s=s.concat(r.time);var n=r.phrase?r.phrase:e.helper.getPhraseByTime(r.time,r.end,t.term);a=a.concat(n)}}),c+=e.view.markerWidget(s,a,o[t.term]),l=l.concat(s),d++}),setTimeout(function(){c.length&&e.helper.find(".vbs-next-action-btn").removeClass("vbs-next-notactive"),e.data.markersStyles.markersContainer.append(c)},0),e.settings.editKeywords&&s.hits.hits.length>0?(e.data.searcht=l,e.data.searchHits=s.hits.hits,e.helper.checkKeyword(n,l,s.hits.hits)):(e.data.searcht=null,e.data.searchHits=null)}l.sort(function(e,t){return e-t}),r&&e.PlayerApi.seek(l[0])}else"FAILURE"==s.requestStatus&&e.helper.hideLoader();e.helper.clearMessage(),console.timeEnd("setSearch")},downloadAudio:function(){var t={};jQuery.extend(t,this.parameters),t.action="getFileMetadata",e.api.call(t,e.api.setDownloadAudio)},setDownloadAudio:function(t){"SUCCESS"==t.requestStatus?window.location=t.response.downloadMediaUrl:e.helper.showMessage(t.statusMessage,"error")},favorite:function(t){var s={};jQuery.extend(s,this.parameters),t="undefined"!=typeof t?t:!0,s.action="updateMediaFile",s.favorite=t?"add":"remove",e.view.favorite(t),e.api.call(s,e.api.sendFavorite)},sendFavorite:function(t){"SUCCESS"!=t.requestStatus&&(e.view.favoriteToggle(),e.helper.showMessage(t.statusMessage,"error"))},getAutoNotesHtmlURL:function(){var t={};return jQuery.extend(t,this.parameters),t.action="getAutoNotesHtml",t.content=!0,e.settings.apiUrl+"?"+e.common.getStringFromObject(t)},editKeyword:function(s,a,r,n){var i={};jQuery.extend(i,this.parameters),i.keywordname=a,i.action="moveKeyword",i.categoryname="ALL TOPICS"!=r?r:"",i.mode=s;var o=t(n).parent();e.api.call(i,e.api.responseEditKeywords,{mode:s,li:o})},responseEditKeywords:function(t,s){"SUCCESS"==t.requestStatus?("up"==s.mode?s.li.insertBefore(s.li.prev()):"down"==s.mode?s.li.insertAfter(s.li.next()):"first"==s.mode&&s.li.insertBefore(s.li.siblings(":eq(0)")),"delete"==s.mode&&s.li.remove()):e.helper.showMessage(t.statusMessage,"error")},removeKeyword:function(s,a,r){if(s){var n={};jQuery.extend(n,this.parameters),n.action="deleteKeyword",n.keywordname=s,n.categoryname="ALL TOPICS"!=a?a:"";var i=t(r).parent();e.api.call(n,e.api.responseRemoveKeyword,{category_name:a,keyword_name:s,li:i})}},responseRemoveKeyword:function(t,s){"SUCCESS"==t.requestStatus?("ALL TOPICS"==s.category_name&&e.data.keywords.splice(e.data.keywords.indexOf(s.keyword_name)),s.li.remove()):e.helper.showMessage(t.statusMessage,"error")},removeTopic:function(t){var s={};jQuery.extend(s,this.parameters),s.categoryname=t,s.action="deleteKeywordCategory",e.api.call(s,e.api.responseRemoveTopic)},responseRemoveTopic:function(s){if("SUCCESS"==s.requestStatus){var a=e.helper.find(".vbs-topics-list");a.find("li.vbs-active").remove();var r=a.find("li.vbs-all-topics");r.parent().find(".vbs-active").removeClass("vbs-active"),r.addClass("vbs-active");var n=r.find("a").text().trim(),i=e.helper.find(".vbs-keywords-list-tab");i.find("ul").removeClass("vbs-active"),i.find('ul[tid="'+n+'"]').addClass("vbs-active"),t(".vbs-topic-delete-popup").remove(),"topics"==e.settings.keywordsColumns&&e.helper.keywordsAutoTopicsColumns()}else e.helper.showMessage(s.statusMessage,"error")},addKeywords:function(t,s){var a={};jQuery.extend(a,this.parameters),a.keyword=t,a.action="addKeyword",e.api.call(a,e.api.responseAddKeywords,{keywords:t,times:s})},responseAddKeywords:function(s,a){if("SUCCESS"==s.requestStatus){var r=e.helper.find(".vbs-topics-list li.vbs-all-topics");r.parent().find(".vbs-active").removeClass("vbs-active"),r.addClass("vbs-active");var n=r.find("a").text().trim(),i=e.helper.find(".vbs-keywords-list-tab");i.find("ul").removeClass("vbs-active"),i.find('ul[tid="'+n+'"]').addClass("vbs-active");var o=a.keywords.replace(/"/g,"");e.data.keywords.push(o);var l=e.settings.keywordsCounter?" <span>("+a.times.split(",").length+")</span>":"",d=t('<li class="key"><a href="#" t="'+a.times+'" speakers="">'+o+"</a>"+l+"</li>");d.find("a").data("keywordInternalName",o),i.find("ul.vbs-active").prepend(d),e.helper.find(".vbs-add-search-word").each(function(){t(this).data("data-kwa").replace(/"/g,"")===o&&t(this).remove()}),"topics"==e.settings.keywordsColumns&&e.helper.keywordsAutoTopicsColumns()}else e.helper.showMessage(s.statusMessage,"error")},saveTrancript:function(t){var s={};jQuery.extend(s,this.parameters),s.content=t,s.action="updateTranscript",e.helper.setIsSaving(!0),e.api.callPost(s,e.api.responseSaveTrancript,t)},responseSaveTrancript:function(t){"SUCCESS"==t.requestStatus?setTimeout(function(){e.api.triggerTranscriptStatus()},1e3*e.settings.transcriptCheckTimer):e.helper.saveTranscriptError(t.statusMessage)},triggerTranscriptStatus:function(){var t={};jQuery.extend(t,this.parameters),t.action="getFileStatus",e.api.call(t,e.api.responseTriggerTranscriptStatus)},responseTriggerTranscriptStatus:function(t){"SUCCESS"!=t.requestStatus||"PROCESSING"!=t.fileStatus&&"REPROCESSING"!=t.fileStatus?"SUCCESS"==t.requestStatus&&"ERROR"==t.fileStatus?e.helper.saveTranscriptError(t.response):"SUCCESS"==t.requestStatus?e.helper.saveTranscriptComplete():"FAILURE"==t.requestStatus?e.helper.saveTranscriptError(t.statusMessage):e.helper.showMessage(t.statusMessage,"error"):setTimeout(function(){e.api.triggerTranscriptStatus()},1e3*e.settings.transcriptCheckTimer)},getNews:function(){var s=e.helper.getSearchWordsArray();if(0===s.length)return e.api.addEmptyMessageForNews("empty"),!1;if(t("#"+e.settings.newsBlock).find(".vbs-section-title").hasClass("vbs-hidden"))return!1;if(e.settings.showNewsBlock){var a=e.helper.find(".vbs-news-block"),r=s;if(t.isArray(r)&&(r=r.join(" ")),e.data.prevNewsRequest===r)return!1;e.data.prevNewsRequest=r,a.find(".vbs-news-wrapper").html('<div class="vbs-loader"></div>');var n=encodeURI(e.settings.newsUrl+r);return t.ajax({type:"GET",url:n,success:function(t){t=JSON.parse(t),e.api.setNews(t,s)},error:function(e,t,s){console.log(s+": Error "+e.status)}}),!0}},setNews:function(s,a){var r=s&&s.d?s.d.results:[];if(r.length>0){t.isArray(a)&&(a=a.join(", "));var n=e.helper.find(".vbs-news-block");n.find(".vbs-news-words").html(a);for(var i="",o=0;o<r.length;o++){var l=r[o],d=l.Title||"",c=l.Source||"",p=l.Date,v=l.Url;i+=e.templates.parse("vbs-news-elem",{title:d,source:c,time:p,url:v})}n.find(".vbs-news-wrapper").html(i),n.find(".vbs-news-elem:odd").addClass("vbs-news-elem-odd").after('<div class="clear-block"></div>'),e.settings.hasNewsBlockHeader||n.addClass("vbs-no-header")}else e.api.addEmptyMessageForNews("not_found");console.log("news:\n",s)},addEmptyMessageForNews:function(t){var s="";"not_found"===t?s="News are not founded":"empty"===t&&(s="Please select a keyword");var a=e.templates.parse("vbs-empty-news",{message:s});e.helper.find(".vbs-news-block").find(".vbs-news-wrapper").html(a)},call:function(t,s,a){a="undefined"!=typeof a?a:!1,this.inited||this.init();var r=9===e.helper.isIe();jQuery.ajax({url:e.settings.apiUrl,type:"GET",data:t,dataType:r?"jsonp":"json"}).done(function(e){s(e,a)}).fail(function(e){console.log(e)})},callPost:function(t,s,a){a="undefined"!=typeof a?a:!1;var r=9===e.helper.isIe();jQuery.ajax({url:e.settings.apiUrl,type:"POST",data:t,dataType:r?"jsonp":"json"}).done(function(e){s(e,a)}).fail(function(e){console.log(e)})},callCustom:function(t,s,a,r){r="undefined"!=typeof r?r:!1;var n=9===e.helper.isIe();jQuery.ajax({url:t,type:"POST",data:s,dataType:n?"jsonp":"json"}).done(function(e){a(e,r)}).fail(function(e){console.log(e)})},setErrors:function(t){"FAILURE"==t.requestStatus?e.api.errors.failure++:t.response&&"PROCESSING"==t.response.fileStatus?e.api.errors.processing++:"PROCESSING"==t.fileStatus&&e.api.errors.processing++
}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.api2_0={getToken:function(){var s=e.settings.apiKey,a=e.settings.password,r=e.settings.apiUrl+"access/users/+"+s.toLowerCase()+"/tokens";t.ajax({type:"GET",url:r,headers:{Authorization:"Basic "+btoa(s+":"+a)},success:function(t){t.tokens&&t.tokens.length>0&&e.api.setToken({token:t.tokens[0].token,requestStatus:"SUCCESS"})},error:function(e,t,s){console.log(s+": Error "+e.status)}})},getMetaData:function(){var s=e.settings.apiUrl+"media/"+e.settings.mediaId;t.ajax({type:"GET",url:s,beforeSend:function(t){t.setRequestHeader("Authorization","Bearer "+e.settings.token)},success:function(s){var a=s.media,r={requestStatus:"PLUGIN"};if(a&&a.metadata&&!t.isEmptyObject(a.metadata)&&(r={requestStatus:"SUCCESS",response:{lengthMs:a.metadata.length.milliseconds}}),e.api.setMetaData(r),a){if(a.keywords&&a.keywords.latest){var n=a.keywords.latest,i={requestStatus:"SUCCESS",keywords:n.words||[],categories:n.categories||{},groups:n.groups||[]};e.api.setKeywords(i)}if(a.transcripts&&a.transcripts.latest){var o=a.transcripts.latest,l={requestStatus:"SUCCESS",transcriptType:o.type,transcript:o.words};e.api.setTranscript(l)}e.api.ready.comments=!0}},error:function(e,t,s){console.log(s+": Error "+e.status)}})}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.comments={getComments:function(t,s){var a={};jQuery.extend(a,e.api.parameters),e.api.data.tmp.hide="undefined"!=typeof t?t:e.settings.expandCommentsBlock?!1:!0,e.api.data.tmp.rebuild="undefined"!=typeof s?s:!1,a.action="getComments",e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(a.username=e.settings.commentsUsername),e.api.call(a,e.comments.setComments)},setComments:function(s){if("SUCCESS"==s.requestStatus){var a="",r="";if(void 0!==s.response.threads){var n=0,i=0;e.data.commentsThreads=s.response.threads;for(var o in s.response.threads){var l=s.response.threads[o];for(var d in l.comments){var c=l.comments[d],p=c.level;c.level>"5"&&(p="5");var v=e.helper.parseTime(l.timeStamp);a+='<div class="vbs-comment-row vbs-answer'+p+'">\n                                                              <div class="vbs-comment-title">\n                                                                  <span class="vbs-comment-author">'+c.userName+"</span> ",a+=1==p?'<span>commented at</span>\n                                                                  <a href="javascript:void(0)" class="vbs-comment-time" data-vbct="'+l.timeStamp+'">'+v+"</a>":"<span>replied</span>";var u=c.canEdit?"vbs-with-edition-btns":"";a+='</div>\n                                                              <div class="vbs-comment-content '+u+'">\n                                                                  <div class="vbs-arrow"></div>\n                                                                  <div class="vbs-comment-message">\n                                                                      <p>'+c.content+"</p>\n                                                                  </div>";var b=!0;e.settings.restrictions.length>0&&(b=e.settings.restrictions.indexOf("manageComments")>-1||e.settings.restrictions.indexOf("manageOwnComments")>-1),b&&(a+=c.canEdit?'<div class="vbs-comment-edit-wrapper">\n                                                <div class="vbs-comment-edit-btn-wrapper">\n                                                    <a href="#" c_id="'+c.id+'" c_tm="'+l.timeStamp+'" class="vbs-comment-edit vbs-popup-btn">Edit</a>\n                                                </div>\n                                                <div class="vbs-comment-delete-btn-wrapper">\n                                                    <a href="#" c_id="'+c.id+'" class="vbs-comment-delete vbs-popup-btn">Delete</a>\n                                                </div>\n                                            </div>':'<div class="vbs-comment-reply-wrapper">\n                                                <a href="#"  c_id="'+c.id+'" class="vbs-comment-reply vbs-popup-btn">Reply</a>\n                                            </div>'),a+="</div>\n                                                          </div>\n                                                      </div>",i++,n++}}r+=n+" Comment(s)"}else r+="No Comments",a+='<div class="vbs-comment-row"><div class="vbs-comment-title">No Comments</div></div>';t(".vbs-comments-block .vbs-section-name").attr("style","width: 200px;").text(r),e.comments.commentsWidget(a,e.api.data.tmp.hide),e.api.data.tmp.rebuild&&e.comments.commentsTWidget()}else{var m=e.helper.find(".vbs-comments-block");m.append(e.templates.get("disabler")),e.settings.tabView||(m.show(),m.find(".vbs-section-body").hide(),m.find(".vbs-section-title .vbs-section-name").text("Comments")),e.api.setErrors(s)}e.api.ready.comments=!0},addComment:function(t){var s={};jQuery.extend(s,e.api.parameters),s.action="addComment",s.comment=t.comment,t.comment_timestamp!==!1&&(s.timeStamp=t.comment_timestamp),t.parent_comment_id!==!1&&(s.commentId=t.parent_comment_id),e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(s.username=e.settings.commentsUsername),e.settings.commentsUserhandle&&""!==e.settings.commentsUserhandle&&(s.userhandle=e.settings.commentsUserhandle),e.api.call(s,e.comments.sendComment)},sendComment:function(t){"SUCCESS"==t.requestStatus?e.comments.getComments(e.helper.find(".vbs-comments-block .vbs-section-title").hasClass("vbs-hidden"),!0):e.helper.showMessage(t.statusMessage,"error")},editComment:function(t){var s={};jQuery.extend(s,e.api.parameters),s.action="editComment",s.comment=t.comment,s.commentId=t.comment_id,e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(s.username=e.settings.commentsUsername),e.api.call(s,e.comments.sendEditComment)},sendEditComment:function(t){var s=e.api.data.tmp.commentParent,a=e.api.data.tmp.commentData;if("SUCCESS"==t.requestStatus){s.parents(".vbs-comment-content").find(".vbs-comment-message p").text(a.comment),s.remove();var r=a.comment_id,n=e.data.commentsThreads;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i].comments;o.forEach(function(e){e.id==r&&(e.content=a.comment)})}e.comments.commentsTWidget()}else s.find("textarea").attr("disabled",!1),e.helper.showMessage(t.statusMessage,"error")},deleteComment:function(t){var s={};jQuery.extend(s,e.api.parameters),s.action="deleteComment",s.commentId=t,e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(s.username=e.settings.commentsUsername),e.api.call(s,e.comments.sendComment)},commentsWidget:function(t,s){var a=e.helper.find(".vbs-comments-block");a.find(".vbs-section-body").html(t),s&&(a.find(".vbs-section-body").hide(),a.find(".vbs-section-title").addClass("vbs-hidden")),a.slideDown("fast")},commentsTWidget:function(){var t=e.helper.find(".vbs-record-timeline-wrap"),s="";for(var a in e.data.commentsThreads){var r=e.data.commentsThreads[a].timeStamp,n=r*t.width()/e.data.duration,i=r>e.data.duration/2?"vbs-from-right":"",o=e.data.commentsThreads[a].comments[0].content;s+=e.templates.parse("vbsCommentsTimeline",{position:n,rightClass:i,stime:r,commentText:o})}e.helper.find(".vbs-comments-wrapper-block").html(s),e.settings.markersInNativeTimeline&&e.settings.cssPathForPlayerFrame&&e.comments.commentsWidgetForNativeTimeline()},resizeCommentsTWidget:function(){var s=e.helper.find(".vbs-record-timeline-wrap").width(),a=e.data.duration;e.helper.find(".vbs-comments-wrapper-block div.vbs-comments-wrapper ").each(function(){var e=t(this),r=e.attr("stime"),n=r*s/a;e.css("left",n)})},commentsWidgetForNativeTimeline:function(){var s=t(".vbs-comments-wrapper-block").find(".vbs-comments-wrapper"),a=e.PlayerApi.getPlayerIframe(),r=a.find(".scrubber");0===r.find(".vbs-comments-wrapper-block").length&&r.append('<div class="vbs-comments-wrapper-block"></div>');var n=r.find(".vbs-comments-wrapper-block");n.empty(),t.each(s,function(t,s){e.comments.createScruberComment(s,n)})},createScruberComment:function(s,a){var r=e.data.duration,n=t(s).attr("stime"),i=n/r*100,o=n>e.data.duration/2?"vbs-from-right":"",l=t(s).find("a").text(),d=t(e.templates.parse("vbsCommentsTimeline",{position:"0",rightClass:o,stime:n,commentText:l}));d.css({top:"-15px",left:i+"%"}),d.find(".vbs-comment-preview").css({"z-index":99999999991}),o||d.find(".vbs-comment-preview").css({"padding-left":"10px"}),a.append(d)},toggleBlockHandler:function(t){t.toggleClass("vbs-hidden");var s=t.parents(".vbs-comments-block").find(".vbs-section-body");t.hasClass("vbs-hidden")?(t.attr("data-title","Show Comments"),s.slideUp()):(t.attr("data-title","Hide Comments"),s.slideDown(),e.helper.collapseNewsBlock())},clickAddCommentHandler:function(s){var a={},r=e.data.position;a.vbt=Math.round(r);var n=e.helper.parseTime(Math.round(r)),i=e.templates.parse("commentPopup",{vbt:a.vbt,vbspTime:n}),o=e.helper.find(".vbs-comments-popup"),l=e.helper.find(".vbs-comments-block .vbs-section-btns");s.hasClass("vbs-active")?o.fadeOut("fast",function(){l.find(".vbs-comments-btn").removeClass("vbs-active"),o.remove()}):(e.helper.find(".vbs-comments-popup").each(function(){t(this).remove()}),l.find(".vbs-clearfix li").append(i),l.find(".vbs-comments-btn").addClass("vbs-active"),e.helper.find(".vbs-comments-popup").show(),t("#vbs-comment-text").focus()),e.helper.collapseNewsBlock()},confirmAddCommentHandler:function(t){e.helper.collapseNewsBlock();var s=t.parent(".vbs-comment-footer").parent(".vbs-comments-popup"),a={},r=s.find("#vbs-comment-text").val(),n=s.find("#vbs-comment-timeline").attr("vbct");return""===r?(alert("Text of comment is required."),!1):(e.helper.find(".vbs-comments-popup").fadeOut("fast",function(){e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active"),e.helper.find(".vbs-comments-popup").addClass("vbs-hidden")}),a.comment=r,a.comment_timestamp=n,a.parent_comment_id=!1,e.comments.addComment(a),void 0)},playCommentHandler:function(t){var s=setTimeout(function(){clearTimeout(s),e.PlayerApi.seek(t.parent(".vbs-comment-popup-row").find("#vbs-comment-timeline").attr("vbct"))},250)},replyHandler:function(t){var s=e.templates.parse("commentReplyPopup",{c_id:t.attr("c_id")}),a=t.parent(".vbs-comment-reply-wrapper");0===a.find(".vbs-comments-popup").length?(e.helper.find(".vbs-comments-popup").addClass("old_reply_popup"),a.append(s),a.find(".vbs-comments-popup").show()):a.find(".vbs-comments-popup").remove(),e.helper.find(".vbs-comments-popup.old_reply_popup").remove(),e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active")},replyConfirmHandler:function(t){var s=t.parents(".vbs-comment-footer").parents(".vbs-comments-popup"),a={},r=s.find("#vbs-comment-reply-text").val(),n=t.attr("c_id");return""===r?(alert("Text of comment is required."),!1):(s.parents(".vbs-comment-reply-wrapper").find(".vbs-comments-popup").remove(),a.comment=r,a.comment_timestamp=!1,a.parent_comment_id=n,e.comments.addComment(a),void 0)},editHandler:function(t){var s=t.attr("c_tm"),a=e.helper.parseTime(Math.round(s)),r=t.parents(".vbs-comment-row"),n=r.find(".vbs-comment-message p").text(),i={c_id:t.attr("c_id"),vbt:s,vbspTime:a,commentText:n},o=r.hasClass("vbs-answer1")?e.templates.parse("commentEditFirstPopup",i):e.templates.parse("commentEditPopup",i),l=t.parent(".vbs-comment-edit-btn-wrapper");0===l.find(".vbs-comments-popup").length?(e.helper.find(".vbs-comments-popup").addClass("old_reply_popup"),l.append(o),l.find(".vbs-comments-popup").show(),l.find("textarea").focus()):l.find(".vbs-comments-popup").remove(),e.helper.find(".vbs-comments-popup.old_reply_popup").remove(),e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active")},editConfirmHandler:function(t){var s=t.parents(".vbs-comments-popup"),a={},r=s.find("textarea").val(),n=t.attr("c_id");return""===r?(alert("Text of comment is required."),!1):(a.comment=r,a.comment_timestamp=!1,a.comment_id=n,s.find("textarea").attr("disabled",!0),e.api.data.tmp.commentParent=s,e.api.data.tmp.commentData=a,e.comments.editComment(a),void 0)},deleteHandler:function(t){var s=e.templates.parse("commentDeletePopup",{c_id:t.attr("c_id")}),a=t.parent(".vbs-comment-delete-btn-wrapper");0===a.find(".vbs-comments-popup").length?(e.helper.find(".vbs-comments-popup").addClass("old_reply_popup"),a.append(s),a.find(".vbs-comments-popup").show()):a.find(".vbs-comments-popup").remove(),e.helper.find(".vbs-comments-popup.old_reply_popup").remove(),e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active")},deleteConfirmHandler:function(t){var s=t.attr("c_id");e.comments.deleteComment(s),t.parents(".vbs-comment-edit-wrapper").remove()},cancelHandler:function(t){var s=t.parents(".vbs-comments-popup");s.fadeOut("fast",function(){e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active"),s.addClass("vbs-hidden").remove()})},commentTimeHandler:function(t){var s=t.attr("data-vbct");s&&e.PlayerApi.seek(s)},updateTimeInPopup:function(t){var s=t||0===t?t:e.data.played;e.helper.find(".vbs-comments-add-popup #vbs-comment-timeline").html(e.helper.parseTime(s)).attr("vbct",s)}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=s.length;return function(r){if("object"!=typeof r&&("function"!=typeof r||null===r))throw new TypeError("Object.keys called on non-object");var n,i,o=[];for(n in r)e.call(r,n)&&o.push(n);if(t)for(i=0;a>i;i++)e.call(r,s[i])&&o.push(s[i]);return o}}()),String.prototype.padLeft=function(e){return new Array(e-this.length+1).join("0")+this},jQuery.extend(jQuery.expr[":"],{wordtime:function(e,s,a){var r=parseFloat(t(e).attr("t")),n=a[3].split(/\s?,\s?/),i=parseFloat(n[0]),o=parseFloat(n[1]);return!isNaN(r)&&!isNaN(i)&&!isNaN(o)&&o>=r&&r>=i}}),e.common={getStringFromObject:function(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")},inArrayV:function(e,t){for(var s in e)if(e[s]==t)return!0;return!1},findTermInArray:function(t,s){for(var a=!1,r=0;r<t.length;r++){var n=t[r];if(n=e.helper.replaceTrimAndLower(n),n===s){a=!0;break}}return a},keysToLowerCase:function(e){for(var t=Object.keys(e),s=t.length;s--;){var a=t[s];a!==a.toLowerCase()&&(e[a.toLowerCase()]=e[a],delete e[a])}return e},vbmenus:function(s,a,r){var n="undefined"!=typeof t.fn.zclip,i="undefined"!=typeof addthis;if(n===!1&&i===!1&&e.settings.editKeywords===!1||e.settings.contextMenu===!1&&"keyword"!==a)return!1;s.preventDefault();var o={},l=t(r).parents("ul").hasClass("group");if("timeline"===a){var d;if("ins"==s.target.localName)d=t(s.target).parent().attr("stime");else{var c=s.offsetX||s.clientX-t(s.target).offset().left;d=Math.round(e.data.duration*(c+s.target.offsetLeft)/e.helper.find(".vbs-record-timeline-wrap").width())}o.vbt=d;var p=t("#vbs-voice_search_txt");p.val().length&&(o.vbs=encodeURI(p.val()))}else if("keyword"==a){var v=t(r).data("keywordInternalName");v.match(/\s+/g)&&(v='"'+v+'"'),o.vbs=encodeURI(v)}else if("transcript"==a){var u=t(r).text();u=encodeURI(u),o.vbs=u}t("ul.vbs-vbcmenu").remove();var b=e.helper.getNewUrl(o),m=t("<ul class='vbs-vbcmenu'></ul>");if(n&&e.settings.contextMenu&&m.append('<li id="vbc_url"><a href="#">Copy URL</a></li>'),i&&e.settings.contextMenu&&m.append('<li id="vbc_share"><a class="addthis_button_expanded addthis_default_style" addthis:url="'+b+'" addthis:title="Check out">Share</a></li>'),"keyword"==a&&e.settings.editKeywords&&!l){var f=t(r),h='<span class="vbs-keyword_controls">';f.parent().prev().length&&(h+='<span class="vbs-vbe vbs-voicebase_first" title="Move to Top">Move to Top</span><span class="vbs-vbe vbs-voicebase_up" title="Move up">Move up</span>'),f.parent().next().length&&(h+='<span class="vbs-vbe vbs-voicebase_down" title="Move down">Move down</span>'),h+='<span class="vbs-vbe vbs-voicebase_remove" title="Remove">Remove</span></span>';var g=t(h);g.data("keywordInternalName",f.data("keywordInternalName"));var y=t('<li id="vbc_move"></li>');y.append(g),m.append(y)}m.appendTo("body");var k=t(".vbs-vbcmenu"),w=e.view.getPositionElementForTooltip(t(r));k.height()+s.pageY<document.body.clientHeight?k.css({top:w.top+t(r).height()+"px",left:w.left+w.width/2+"px"}):k.css({top:w.top-t(r).height()-k.height()+"px",left:w.left+w.width/2+"px"}),n&&t("#vbc_url").find("a").zclip({path:e.settings.zeroclipboard,copy:b}),i&&addthis.toolbox("#vbc_share")},vbEditMenu:function(e,s){var a=t(s),r=t(".vbs-edit-mode-wrapper");t("ul.vbs-vbcmenu").remove(),r.find(".vbs-menu-target").removeClass("vbs-menu-target"),a.addClass("vbs-menu-target");var n=a.attr("t")/1e3,i=n>1?n-1:n,o="";if(o+='<li><a href="#" class="vbsc-edit-play" data-time="'+i+'">Play</a></li>',a.hasClass("vbs-edit-speaker")||a.prev().hasClass("vbs-edit-speaker")||(o+='<li><a href="#" class="vbsc-edit-speaker" data-time="'+1e3*n+'">Insert Speaker</a></li>'),a.hasClass("vbs-edit-speaker")){var l=a.attr("m")||"";o+='<li><a href="#" class="vbsc-rename-speaker" data-speaker-key="'+l+'">Rename Speaker</a></li>'}r.append("<ul class='vbs-vbcmenu'>"+o+"</ul>");var d=t(".vbs-vbcmenu"),c=e.clientY+r.scrollTop();d.height()+e.clientY<document.body.clientHeight?d.css({top:c+"px",left:e.pageX+"px"}):(t(s).find("br").length>0&&(c+=15*t(s).find("br").length),d.css({top:c-d.height()-a.height()+"px",left:e.pageX+"px"}))},uniqueArray:function(e){e=e?e:[];for(var t={},s=0;s<e.length;s++)t[e[s]]=!0;return e=Object.keys(t)},hidePopup:function(e){e.fadeOut("fast",function(){t(this).remove()})},unEscapeHtml:function(e){return e.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;lt;/g,"&lt;").replace(/&amp;gt;/g,"&gt;")}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.events={time:null,onTime:function(){if(e.instances[e.current_instance].player&&e.instances[e.current_instance].player.interface){Math.round(e.data.position)!=Math.round(e.PlayerApi.getPosition())&&(e.data.clicker||e.helper.hideLoader(),e.settings.transcriptHighlight!==!1&&e.helper.highlight(e.PlayerApi.getPosition()),e.data.movelistner=!1),e.data.position===e.data.duration&&e.helper.hideLoader();var t=e.data.position=e.PlayerApi.getPosition();"PLAYING"===e.PlayerApi.getStatus()&&-1!==e.PlayerApi.getDuration()&&e.data.duration!==e.PlayerApi.getDuration()&&(e.data.duration=e.PlayerApi.getDuration(),e.view.renderTimeInMediaTitle());var s=e.data.duration;if(e.data.dragging===!1&&e.data.movelistner===!1&&"undefined"!=typeof t&&s){e.helper.find(".vbs-player-slider").css("left",100*t/s+"%"),e.helper.find(".vbs-record-progress").css("width",100*t/s+"%");var a=e.helper.parseTime(t);e.helper.find(".vbs-ctime").html(a),e.comments.updateTimeInPopup(t),e.helper.find(".vbs-share-popup").find(".vbsp-time").attr("vbct",t).html(a)}e.data.clicker||("PAUSED"==e.PlayerApi.getStatus()?e.helper.find(".vbs-player-control .vbs-play-btn").removeClass("vbs-playing").attr("data-title","Play"):"PLAYING"==e.PlayerApi.getStatus()&&e.helper.find(".vbs-player-control .vbs-play-btn").addClass("vbs-playing").attr("data-title","Pause")),e.PlayerApi.getBuffer()&&e.helper.find(".vbs-record_buffer").css("width",e.PlayerApi.getBuffer()+"%"),e.speakers.speakerIsSpeaking()}},registerEvents:function(){e.settings.toggleBlocks&&e.settings.toggleMediaBlock&&e.helper.find(".vbs-media-block .vbs-section-title").off("touchstart click").on("click touchstart",function(s){s.preventDefault();var a=t(this);a.toggleClass("vbs-hidden"),a.hasClass("vbs-hidden")?(e.data.playerHeight=e.data.playerDom.height(),"sublime"==e.settings.playerType||"video_js"==e.settings.playerType||"jplayer"==e.settings.playerType||"jwplayer"==e.settings.playerType&&"html5"===e.PlayerApi.getRenderingMode()?e.data.playerDom.hide():e.data.playerDom.css({height:"0px"}),e.helper.find(".vbs-expand-btn").hide(),e.helper.findc(".vbs-player-wrapper .vbs-time").hide(),a.parents(".vbs-media-block").hasClass("vbs-video")&&t(".vbs-tooltip").text("Show Video"),a.attr("data-title","Show Video")):("sublime"==e.settings.playerType||"video_js"==e.settings.playerType||"jplayer"==e.settings.playerType||"jwplayer"==e.settings.playerType&&"html5"===e.PlayerApi.getRenderingMode()?e.data.playerDom.show():e.data.playerDom.css({height:e.data.playerHeight+"px"}),e.helper.find(".vbs-expand-btn").show(),e.helper.findc(".vbs-player-wrapper .vbs-time").show(),a.parents(".vbs-media-block").hasClass("vbs-video")&&t(".vbs-tooltip").text("Hide Video"),a.attr("data-title","Hide Video"))}),e.settings.markersInNativeTimeline&&t(document).off("DOMSubtreeModified",".vbs-markers").on("DOMSubtreeModified",".vbs-markers",function(t){t.target.innerHTML.length>0?e.view.markerWidgetForNativeTimeline():e.view.clearScrubberOfMarks()}),e.helper.find(".vbs-markers,.vbs-custom-markers").on("touchstart click","a.vbs-marker",function(s){s.preventDefault();var a=t(this).attr("stime");return e.PlayerApi.seek(a),!1}),e.helper.find(".vbs-comments-wrapper-block").on("touchstart click",".vbs-comment-preview a",function(s){s.preventDefault(),e.helper.collapseNewsBlock();var a=t(this).attr("stime");return e.PlayerApi.seek(a),!1}),t("."+e.data.vclass+" .vbs-player-control, ."+e.data.vclass+" .vbs-edit-mode-prewrapper").on("touchstart click",".vbs-play-btn",function(s){s.preventDefault();var a=t(this),r=t(".vbs-tooltip");return a.hasClass("vbs-playing")?(a.removeClass("vbs-playing").attr("data-title","Play"),e.helper.track("pause"),r.text("Play"),e.helper.hideLoader(),e.PlayerApi.pause()):(e.helper.track("play"),a.addClass("vbs-playing").attr("data-title","Pause"),r.text("Pause"),e.helper.showLoader(),e.PlayerApi.play()),!1}),t(document).off("touchstart click",".vbs-prev-btn").on("touchstart click",".vbs-prev-btn",function(t){t.preventDefault();var s=e.PlayerApi.getPosition()-15;return s=0>s?.001:s,e.PlayerApi.seek(s),!1}),e.helper.find(".vbs-next-action-btn").on("touchstart click",function(s){if(s.preventDefault(),!t(this).hasClass("vbs-next-notactive")){var a=e.helper.find(".vbs-record-timeline-wrap .vbs-markers");e.helper.moveToNextMarker(a)}}),t(window).off("resize.vbs_resize").on("resize.vbs_resize",function(){if(e.view.resizeTimelineElements(),e.helper.isMobile()){var s=e.PlayerApi.getMobilePlayerSize();e.PlayerApi.setSizePlayer(s.mobile_width,s.mobile_height),t("#"+e.settings.mediaBlock).css("width",e.helper.getMobileWidth())}e.view.checkResponsive()}),t(document).off("mousedown",".vbs-record-timeline-wrap .vbs-dragger").on("mousedown",".vbs-record-timeline-wrap .vbs-dragger",function(s){s.preventDefault();var a=t(this).parents(".vbs-record-timeline-wrap");if(0===s.button){var r=100*(s.pageX-a.offset().left)/a.width();e.helper.find(".vbs-player-slider").css("left",r+"%"),e.helper.find(".vbs-record-progress").css("width",r+"%"),e.data.movelistner=!0,e.data.dragging=!0}}).off("mousemove",".vbs-record-timeline-wrap .vbs-dragger").on("mousemove",".vbs-record-timeline-wrap .vbs-dragger",function(s){s.preventDefault();var a=t(this).parents(".vbs-record-timeline-wrap"),r=100*(s.pageX-a.offset().left)/a.width();r>100?r=100:0>r&&(r=0),e.data.played=Math.round(e.data.duration*r/100),e.data.dragging&&(e.helper.find(".vbs-player-slider").css("left",r+"%"),e.helper.find(".vbs-record-progress").css("width",r+"%"),e.helper.find(".vbs-ctime").html(e.helper.parseTime(e.data.played)),e.helper.find(".vbs-share-popup .vbsp-time").html(e.helper.parseTime(e.data.played)).attr("vbct",e.data.played),e.comments.updateTimeInPopup(null))}).off("mouseup.vbs_mouseup").on("mouseup.vbs_mouseup",function(){if(e.data.dragging&&(e.PlayerApi.seek(e.data.played),e.helper.track("seek",e.data.played),e.helper.find(".vbs-share-popup .vbsp-time").html(e.helper.parseTime(e.data.played)).attr("vbct",e.data.played),e.comments.updateTimeInPopup(null),e.helper.find("#vbs-share-position").is(":checked"))){var s={};s.vbt=e.data.played;var a=e.helper.getNewUrl(s);t("#vbsp-url").val(a),"undefined"!=typeof addthis&&addthis.update("share","url",a)}e.data.dragging=!1}),e.helper.find(".vbs-markers,.vbs-custom-markers").on({mouseover:function(s){e.helper.find('[ctime="'+t(s.target).parent().attr("stime")+'"]').fadeIn(75)},mouseout:function(s){e.helper.find('[ctime="'+t(s.target).parent().attr("stime")+'"]').fadeOut(100)}}),e.helper.find(".vbs-utterance-markers").on("touchstart click",".vbs-utter-marker",function(s){s.preventDefault();var a=t(this).attr("data-stime");return e.PlayerApi.seek(a),!1}),t(document).off("change",".vbs-utterance-block input[type=checkbox]").on("change",".vbs-utterance-block input[type=checkbox]",function(){var s=t(this).attr("data-row");e.helper.find(".vbs-utterance-markers").find(".vbs-utter-row"+s).toggle()}),e.helper.find(".vbs-volume-toolbar, ."+e.data.vclass+" .vbs-edit-mode-prewrapper").on("touchstart click",".vbs-volume-btn",function(s){s.preventDefault();var a=t(this),r=e.helper.find(".vbs-volume-toolbar-block");if(a.hasClass("show"))r.fadeOut("fast"),a.removeClass("show");else{var n=e.PlayerApi.getVolume();e.PlayerApi.setUiVolume(n),r.fadeIn(100),a.addClass("show")}}),t(document).off("mousedown",".vbs-volume-toolbar-block").on("mousedown",".vbs-volume-toolbar-block",function(s){var a=t(this);if(0===s.button){var r=100-100*(s.pageY-a.find(".vbs-volume-slider").offset().top)/t(this).height();r>100?r=100:0>r&&(r=0),e.PlayerApi.setUiVolume(r),e.PlayerApi.setVolume(r),e.data.draggingVol=!0}}).off("mousemove",".vbs-volume-toolbar-block").on("mousemove",".vbs-volume-toolbar-block",function(s){s.preventDefault();var a=t(this);if(e.data.draggingVol){var r=100-100*(s.pageY-a.find(".vbs-volume-slider").offset().top)/t(this).height();r>100?r=100:0>r&&(r=0),e.PlayerApi.setUiVolume(r),e.PlayerApi.setVolume(r)}}).on("mouseup mouseleave",function(){e.data.draggingVol=!1}),e.helper.find(".vbs-keywords-block").on("click touchstart",".vbs-keywords-list-tab li a",function(s){s.preventDefault(),e.data.keywordClickEvent=!0,"PLAYING"==e.PlayerApi.getStatus()&&e.PlayerApi.pause(),e.helper.showLoader();var a=t(this);e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.helper.removeBold();var r=a.data("keywordInternalName"),n=e.helper.termFor(r,"url"),i=e.helper.termFor(r,"marker");e.helper.find("#vbs-voice_search_txt").val(n).change(),a.addClass("bold"),i.length&&e.view.searchWordWidget(i);var o=e.helper.find("#vbs-voice_search_txt");return o.data("data-val",o.val()),e.helper.track("keyword",r),e.api.getSearch(i),e.api.getNews(),e.data.keywordClickEvent=!1,!1}),e.settings.toggleBlocks&&e.settings.toggleKeywordsBlock&&e.helper.find(".vbs-keywords-block .vbs-section-title").on("touchstart click",function(e){e.preventDefault();var s=t(this);s.toggleClass("vbs-hidden");var a=s.parents(".vbs-keywords-block");s.hasClass("vbs-hidden")?(s.attr("data-title","Show Keywords"),a.find(".vbs-section-body").slideUp(),a.find(".vbs-search-form").hide()):(s.attr("data-title","Hide Keywords"),a.find(".vbs-section-body").slideDown(),a.find(".vbs-search-form").show())}),e.helper.find(".vbs-keywords-block .vbs-more-btn a").on("touchstart click",function(s){s.preventDefault(),e.settings.keywordsHeight>e.helper.getMaxKeywordHeight()&&(e.settings.keywordsHeight=e.helper.getKeywordHeight());var a="100%";e.helper.find(".vbs-keywords-list-wrapper").css({height:a});var r=t(this);return e.data.kf?(e.data.kf=!1,r.text("Show More..."),e.helper.find(".vbs-keywords-wrapper").animate({height:e.settings.keywordsHeight+"px"},700)):(e.helper.find(".vbs-keywords-wrapper").animate({height:e.helper.getMaxKeywordHeight()+"px"},700),r.text("Hide More..."),e.data.kf=!0),!1}),t(document).off("touchstart click",".vbs-widget em").on("touchstart click",".vbs-widget em",function(s){s.preventDefault();var a=t(this),r=a.find(".vbs_word"),n=t("#vbs-voice_search_txt"),i=[];r.length&&(t.each(r,function(e,s){i.push(t(s).find(".search_word").text()),t(s).remove()}),n.val(i.join(" "))),e.helper.find(".vbs-widget-wrap").addClass("focused"),n.css("opacity","1"),e.helper.find("#vbs-search-string").hide(),n.focus()}),e.helper.find("#vbs-clear-string").on("touchstart click",function(s){return s.preventDefault(),t(this).parents(".vbs-search-form").hasClass("vbs-filled")&&(e.helper.collapseNewsBlock(),e.PlayerApi.pause(),e.helper.find(".vbs-markers, .vbs-search-word-widget").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.helper.find("#vbs-voice_search_txt").val("").change(),e.helper.find(".vbs-kwe-add").remove(),e.helper.find("#vbs-search-string .vbs-marquee .vbs-search-word-widget").stop(!0).css("left",0)),!1}),e.helper.find("#vbs-voice_search_txt").on("keyup",function(){var t=e.helper.getSearchWordsArray();t.length?e.helper.find(".vbs-powered-by-label").addClass("vbs-hidden-p"):e.helper.find(".vbs-powered-by-label").removeClass("vbs-hidden-p")}),e.helper.find("#vbs-voice_search_txt").on("blur",function(){var s=e.helper.getSearchWordsArray();s.length?(e.view.searchWordWidget(s),e.helper.find(".vbs-powered-by-label").addClass("vbs-hidden-p")):(e.helper.find(".vbs-markers, .vbs-search-word-widget").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.helper.find(".vbs-powered-by-label").removeClass("vbs-hidden-p"));var a=t(this);a.data("data-val",a.val()),e.helper.find(".vbs-widget-wrap").removeClass("focused"),e.helper.find("#vbs-search-string").show()}),e.helper.find("#vbs-voice_search_txt").on("change",function(){var s=t(this);e.helper.removeBold();var a=e.helper.find("#vbs-search-string");if(s.val().length>0?e.helper.find(".vbs-search-form").addClass("vbs-filled"):(e.helper.find(".vbs-search-form").removeClass("vbs-filled"),s.css("opacity","1"),a.hide(),e.helper.find("#vbs-voice_search_txt").focus()),t("#vbs-share-search").is(":checked")){var r={};r.vbs=encodeURI(s.val());var n=e.helper.getNewUrl(r);e.helper.find("#vbsp-url").val(n),"undefined"!=typeof addthis&&addthis.update("share","url",n)}e.helper.find(".vbs-kwe-add").remove(),e.helper.updateQuotesVisibility(),a.show()}),e.helper.find("#vbs-search-btn").on("touchstart click",function(t){t.preventDefault(),e.helper.find("#vbs-search-form").submit()}),e.helper.find("#vbs-search-form").on("submit",function(){if(t("#vbs-searchbar-block").find(".vbs-search-form").hasClass("vbs-form-disabled"))return!1;"PLAYING"==e.PlayerApi.getStatus()&&e.PlayerApi.pause(),e.helper.find("#vbs-voice_search_txt").blur(),e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.helper.find(".vbs-kwe-add").remove();var s=e.helper.getSearchWordsArray();return s.length>0?(e.helper.showLoader(),e.view.searchWordWidget(s),e.api.getSearch(s)):e.helper.updateQuotesVisibility(),!1}),t(document).off("touchstart click",".vbs-unquote-btn").on("touchstart click",".vbs-unquote-btn",function(t){t.preventDefault(),e.helper.removeQuotes()}),e.helper.find("#vbs-search-string").on("touchstart click",function(s){s.preventDefault(),(t(s.target).hasClass("vbs-search-word-widget")||0===e.helper.find("#vbs-voice_search_txt").val().length)&&(t(this).hide(),e.helper.find("#vbs-voice_search_txt").css("opacity","1").focus())}),e.helper.find(".vbs-topics").on("touchstart click",'.vbs-topics-list li[class="vbs-active"]',function(e){e.preventDefault()}),e.helper.find(".vbs-topics").on("touchstart click",'.vbs-topics-list li[class!="vbs-active"]',function(){var s=t(this);if(s.hasClass("vbs-active")||s.hasClass("vbs-disabled"))return!1;s.parent().find(".vbs-active").removeClass("vbs-active"),s.addClass("vbs-active");var a=s.find("a"),r=a.text().trim();e.helper.find(".vbs-keywords-list-tab ul").removeClass("vbs-active"),e.helper.find('.vbs-keywords-list-tab ul[tid="'+r+'"]').addClass("vbs-active"),"topics"==e.settings.keywordsColumns&&e.helper.keywordsAutoTopicsColumns(),e.settings.editKeywords&&t(".vbs-topic-delete-popup").fadeOut("fast",function(){t(this).remove()
}),e.speakers.filterSpeakersList(a.attr("speakers").split(","))}),e.helper.find(".vbs-keywords-list-tab").on("mouseenter touchstart","li.key a",function(s){var a=t(s.target).is("span")?t(s.target).parent():t(s.target),r=a.attr("t");e.view.keywordHover(r)}),e.helper.find(".vbs-keywords-list-tab").on("mouseleave touchend","li.key a",function(){e.view.removeKeywordHover()}),e.settings.topicHover===!0&&e.helper.find(".vbs-keywords-block").on({mouseover:function(){var s=t(this).text().trim(),a=[];e.helper.find('.vbs-keywords-list-tab ul[tid="'+s+'"]').find("li.key a").each(function(){a.push(t(this).attr("t"))});var r=[];t.each(a.join().split(","),function(e,s){-1===t.inArray(s,r)&&r.push(s)}),e.view.keywordHover(r.join())},mouseout:function(){e.view.removeKeywordHover()}},".vbs-topics-list li a"),e.helper.find(".vbs-select-language").on("touchstart click",function(e){e.preventDefault(),s(t(this))}),e.helper.find(".vbs-select-language-wrapper .vbs-select-dropdown").on("touchstart click","li",function(s){s.preventDefault();var a=t(this);return a.hasClass("vbs-disabled")?!1:(a.parents(".vbs-select-dropdown").fadeOut("fast"),e.view.selectLanguage({lang_code:a.attr("data-lang-code"),lang_name:a.text()}),void 0)}),e.helper.find(".vbs-select-speaker").on("touchstart click",function(e){e.preventDefault(),s(t(this))});var s=function(t){t.hasClass("vbs-s-show")?(e.helper.find(".vbs-select-dropdown").fadeOut("fast"),t.removeClass("vbs-s-show")):(e.helper.find(".vbs-select-dropdown").fadeIn(100),t.addClass("vbs-s-show"))},a=e.helper.find(".vbs-select-speaker"),r=e.helper.find(".vbs-search-btn"),n=e.helper.find(".vbs-widget-wrap"),i=parseInt(n.css("paddingLeft"))+parseInt(n.css("paddingRight")),o=r.width()+parseInt(r.css("borderLeft")),l=parseInt(a.css("paddingLeft"))+parseInt(a.css("paddingRight")),d=parseInt(a.css("borderLeftWidth"))+parseInt(a.css("borderRightWidth")),c=parseInt(n.css("minWidth"));if(t("#vbs-keywords").width()<=437&&(a.addClass("vbs-fixed-width"),n.addClass("vbs-without-min-width")),t("#vbs-keywords").width()<=360&&e.helper.find(".vbs-search-form").addClass("less-360px"),e.helper.find(".vbs-select-speaker-wrapper .vbs-select-dropdown").on("touchstart click","li",function(s){s.preventDefault(),a.css("width","auto");var p=t(this);if(p.hasClass("vbs-disabled"))return!1;e.helper.find(".vbs-select-dropdown").fadeOut("fast");var v=p.attr("data-speaker"),u="all"==v?"Select speaker...":p.text();if(e.helper.find(".vbs-select-speaker").removeClass("vbs-s-show").html(u),e.helper.filterKeywords(v),!e.settings.searchBarOuter){var b,m,f,h=p.parents("#vbs-keywords");if(h.hasClass("less-600px")){if(h.width()<=437)return!1;b=a.width()+l+d;var g=12;if(r.css("right",b+g),n.css("marginRight",b+o+g),n.width()<=c){m=e.helper.find(".vbs-keywords-block").width();var y=e.helper.find(".vbs-widget-wrap"),k=parseInt(y.css("borderLeftWidth"))+parseInt(y.css("borderRightWidth"));f=m-(c+k+o+g+d+l+i),a.css("width",f),r.css("right",f+l+d+g),n.css("marginRight",f+l+d+o+g)}}else if(b=a.width()+l+d,r.css("right",b),n.css("marginRight",b+o),n.width()<=c){m=e.helper.find(".vbs-keywords-block").width()-parseInt(e.helper.find(".vbs-keywords-block .vbs-section-header").css("borderLeftWidth"))-parseInt(e.helper.find(".vbs-keywords-block .vbs-section-header").css("borderRightWidth"));var w=e.helper.find(".vbs-keywords-block .vbs-section-title").width()+parseInt(e.helper.find(".vbs-keywords-block .vbs-search-form").css("borderLeftWidth"));f=m-(w+o+c+d+l+i+1),a.css("width",f),r.css("right",f+l+d),n.css("marginRight",f+l+d+o)}}}),e.settings.editKeywords){t(document).off("touchstart click",".vbs-voicebase_up").on("touchstart click",".vbs-voicebase_up",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.keywordUp)return e.settings.webHooks.keywordUp(),!1;var a,r=t(this),n=r.parent().data("keywordInternalName"),i=p(n);e.helper.find(".vbs-topics")&&(a=e.helper.find(".vbs-topics-list li.vbs-active").text());var o=t(i).text();e.api.editKeyword("up",o,a,i)}),t(document).off("touchstart click",".vbs-voicebase_down").on("touchstart click",".vbs-voicebase_down",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.keywordDown)return e.settings.webHooks.keywordDown(),!1;var a,r=t(this),n=r.parent().data("keywordInternalName"),i=p(n);e.helper.find(".vbs-topics")&&(a=e.helper.find(".vbs-topics-list li.vbs-active").text());var o=t(i).text();e.api.editKeyword("down",o,a,i)}),t(document).off("touchstart click",".vbs-voicebase_first").on("touchstart click",".vbs-voicebase_first",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.keywordFirst)return e.settings.webHooks.keywordFirst(),!1;var a,r=t(this),n=r.parent().data("keywordInternalName"),i=p(n);e.helper.find(".vbs-topics")&&(a=e.helper.find(".vbs-topics-list li.vbs-active").text());var o=t(i).text();e.api.editKeyword("first",o,a,i)}),t(document).off("touchstart click",".vbs-voicebase_remove").on("touchstart click",".vbs-voicebase_remove",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.removeKeyword)return e.settings.webHooks.removeKeyword(),!1;var a,r=t(this),n=r.parent().data("keywordInternalName"),i=p(n);e.helper.find(".vbs-topics")&&(a=e.helper.find(".vbs-topics-list li.vbs-active").text());var o=t(i).text();e.api.removeKeyword(o,a,i)});var p=function(s){var a;return e.helper.find(".vbs-keywords-list-tab ul.vbs-active").find("a").each(function(){return t(this).data("keywordInternalName")==s?(a=t(this),!0):void 0}),a};t(document).off("touchstart click",".vbs-topic-del-btn-wrap .vbs-cross-btn").on("touchstart click",".vbs-topic-del-btn-wrap .vbs-cross-btn",function(s){s.preventDefault();var a=t(".vbs-topic-delete-popup"),r=t(this);if(a.length)a.fadeOut("fast",function(){a.remove()});else{var n=t(document).find(".vbs-popup");n.hide().siblings("a").removeClass("vbs-active"),t(e.templates.parse("deleteTopicPopup",{topicname:r.parents("li").find("a").text()})).appendTo("body");var i=t(this).offset().top,o=t(this).offset().left,l=t(".vbs-topic-delete-popup");l.css({top:i+"px",left:o+"px"}),e.helper.find(".vbs-edit-topics").scroll(function(){l.fadeOut("fast",function(){t(this).remove()})})}}),t(document).off("touchstart click",".vbs-add-search-word").on("touchstart click",".vbs-add-search-word",function(s){s.preventDefault(),e.api.addKeywords(t(this).data("data-kwa"),t(this).data("data-kwt"))})}t(document).off("touchstart click",".vbs-topic-delete-popup .vbs-confirm-btn").on("touchstart click",".vbs-topic-delete-popup .vbs-confirm-btn",function(e){e.preventDefault(),t(".vbs-topic-delete-popup").fadeOut("fast",function(){t(this).remove()})}),t(document).off("touchstart click",".vbs-topic-delete-popup .vbs-cancel-btn").on("touchstart click",".vbs-topic-delete-popup .vbs-cancel-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.removeTopic)return e.settings.webHooks.removeTopic(),!1;var a=t(this),r=a.parents(".vbs-topic-delete-popup").attr("data-topic");e.api.removeTopic(r)}),e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper").on("touchstart click","span.w",function(s){s.preventDefault(),"PLAYING"==e.PlayerApi.getStatus()&&e.PlayerApi.pause(),e.helper.showLoader(),e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive");var a=t(this),r=a.attr("t")/1e3;r=r>1?r-1:r,e.helper.find(".vbs-player-slider").css("left",r/e.data.duration*100+"%"),e.helper.find(".vbs-record-progress").css("width",r/e.data.duration*100+"%"),e.PlayerApi.seek(r);var n=a.text().trim();e.helper.track("transcript",n),n.match(/\s+/g)&&(n='"'+n+'"');var i=e.helper.find("#vbs-voice_search_txt");return i.val(n).change(),n.length&&e.view.searchWordWidget([n]),i.data("data-val",i.val()),e.api.getSearch([n],!1),!1}),e.settings.toggleBlocks&&e.settings.toggleTranscriptBlock&&e.helper.find(".vbs-transcript-block .vbs-section-title").on("touchstart click",function(e){e.preventDefault();var s=t(this);s.toggleClass("vbs-hidden"),s.hasClass("vbs-hidden")?(s.attr("data-title","Show Transcript"),s.parents(".vbs-transcript-block").find(".vbs-section-body").slideUp()):(s.attr("data-title","Hide Transcript"),s.parents(".vbs-transcript-block").find(".vbs-section-body").slideDown())}),e.helper.find(".vbs-transcript-block .vbs-more-btn a").on("touchstart click",function(s){s.preventDefault();var a=e.helper.find(".vbs-transcript-wrapper").height(),r=t(this);e.data.tf?(e.data.tf=!1,r.text("Show More..."),t(".vbs-transcript-prewrapper").animate({height:e.settings.transcriptHeight+"px"},700)):(t(".vbs-transcript-prewrapper").animate({height:a+20+"px"},700,"linear",function(){t(this).css({height:"auto"})}),r.text("Hide More..."),e.data.tf=!0)}),e.helper.find(".vbs-transcript-block .vbs-transcript-prewrapper").on({mouseover:function(){t(this).addClass("vbs-t-hover")},mouseout:function(){t(this).removeClass("vbs-t-hover")}}),e.helper.find(".vbs-section-btns").on("touchstart click",".vbs-cloud-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.downloadMedia)return e.settings.webHooks.downloadMedia(),!1;var a=t(this);a.hasClass("vbs-active")?(a.removeClass("vbs-active"),a.parent().find(".vbs-download-popup").fadeOut("fast")):(a.addClass("vbs-active"),a.parent().find(".vbs-download-popup").fadeIn("fast"))}),e.helper.find(".vbs-download-popup").on("touchstart click",".vbs-donwload-pdf, .vbs-donwload-rtf, .vbs-donwload-srt",function(s){s.preventDefault(),e.helper.find(".vbs-cloud-btn").removeClass("vbs-active"),e.helper.find(".vbs-download-popup").fadeOut("fast");var a=t(this).attr("format");e.helper.downloadFile(a)}),e.helper.find(".vbs-media-block").on("touchstart click",".vbs-download-audio-btn",function(s){return s.preventDefault(),t(this).hasClass("vbs-disable-button")?!1:"undefined"!=typeof e.settings.webHooks.downloadTranscript?(e.settings.webHooks.downloadTranscript(),!1):(e.api.downloadAudio(),void 0)}),e.helper.find(".vbs-share-btn-wrapper").on("touchstart click",".vbs-share-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.socialShare)return e.settings.webHooks.socialShare(),!1;var a={},r=e.PlayerApi.getPosition();a.vbt=Math.round(r);var n=e.helper.getNewUrl(a),i=e.helper.parseTime(Math.round(r)),o="undefined"!=typeof t.fn.zclip?"":"vbs-no-zclip",l="";for(var d in e.settings.addThisButtons)l+='<a class="addthis_button_'+e.settings.addThisButtons[d]+'"></a>';var c="undefined"!=typeof addthis?'<div class="vbs-share-social-row vbs-clearfix">\n                        <span>Choose one:</span>\n                        <div class="vbs-social-wrapper">\n                            <div class="vbs-addthis-toolbox addthis_toolbox addthis_default_style">'+l+'<a class="addthis_counter addthis_bubble_style"></a>\n                            </div>\n                        </div>\n                    </div>':"",p=e.settings.voicebaseShare?'<span>or</span><a href="#" class="vbs-voicebase-share-btn">Share with E-mail</a>':"",v=e.templates.parse("sharePopup",{vbt:a.vbt,vbspTime:i,zclip:o,addthis:c,url:n,vbShareButton:p}),u=e.helper.find(".vbs-share-popup");0===u.length||u.hasClass("vbs-hidden")?(e.helper.find(".vbs-share-popup.vbs-hidden").remove(),e.helper.find(".vbs-share-btn-wrapper").append(v),"undefined"!=typeof t.fn.zclip&&e.helper.find(".vbs-copy-btn").zclip({path:e.settings.zeroclipboard,copy:function(){return e.helper.find("#vbsp-url").val()}}),"undefined"!=typeof addthis&&addthis.toolbox(".vbs-addthis-toolbox",{},{url:n,title:e.settings.shareTitle})):u.fadeOut("fast",function(){u.addClass("vbs-hidden").show()})}),t(document).off("touchstart click","#vbs-share-position").on("touchstart click","#vbs-share-position",function(){var t=e.PlayerApi.getPosition(),s=e.helper.parseTime(Math.round(t)),a={vbt:Math.round(t)};v(a,this),e.helper.find(".vbsp-time").html(s).attr("vbct",s)}),t(document).off("touchstart click","#vbs-share-search").on("touchstart click","#vbs-share-search",function(){var e={vbs:encodeURI(t("#vbs-voice_search_txt").val())};v(e,this)}),t(document).off("touchstart click","#vbs-share-file").on("touchstart click","#vbs-share-file",function(){var e={vbt:0};v(e,this)});var v=function(s,a){e.helper.find(".vbs-share-popup .vbs-share-radio-row").removeClass("vbs-checked"),t(a).parents(".vbs-share-radio-row").addClass("vbs-checked");var r=e.helper.getNewUrl(s);e.helper.find("#vbsp-url").val(r),"undefined"!=typeof addthis&&addthis.update("share","url",r)};e.helper.find(".vbs-share-btn-wrapper").on("touchstart click",".vbs-cancel-btn",function(e){e.preventDefault(),b()}),e.helper.find(".vbs-share-btn-wrapper").on("touchstart click",".vbs-addthis-toolbox a",function(e){e.preventDefault(),b()}),e.helper.find(".vbs-share-btn-wrapper").on("touchstart click",".vbsp-url",function(e){e.preventDefault(),t(this).select()});var u;e.helper.find(".vbs-share-btn-wrapper").on("touchstart click",".vbs-play-btn",function(s){s.preventDefault(),clearTimeout(u),u=setTimeout(function(){e.PlayerApi.seek(t(".vbsp-time").attr("vbct"))},250)}),e.helper.find(".vbs-share-btn-wrapper").on("touchstart click",".vbs-voicebase-share-btn",function(t){return t.preventDefault(),"undefined"!=typeof e.settings.webHooks.vbShare?(e.settings.webHooks.vbShare(),("undefined"==typeof e.settings.webHooks.vbShareClose||"undefined"!=typeof e.settings.webHooks.vbShareClose&&e.settings.webHooks.vbShareClose===!0)&&b(),!1):(alert("Default Voicebase Share action"),void 0)});var b=function(){var t=e.helper.find(".vbs-share-popup");t.fadeOut("fast",function(){t.addClass("vbs-hidden").show()})};e.helper.find(".vbs-section-btns").on("touchstart click",".vbs-del-btn",function(e){e.preventDefault();var s=t(this);if(s.hasClass("vbs-disable-button"))return!1;var a=s.parent().find(".vbs-download-popup");s.hasClass("vbs-active")?(s.removeClass("vbs-active"),a.fadeOut("fast")):(s.addClass("vbs-active"),a.fadeIn("fast"))}),window.addEventListener("storage",function(t){"vbs-deleted-ids"===t.key&&e.helper.clearUiForDeletedIds()},!1),e.helper.find(".vbs-section-btns").on("touchstart click",".vbs-red-btn",function(s){return s.preventDefault(),e.helper.find(".vbs-section-btns .vbs-del-btn").removeClass("vbs-active"),t(this).parents(".vbs-popup").fadeOut("fast"),e.helper.setDeletedIdsInLocalStorage(),"undefined"!=typeof e.settings.webHooks.remove?(e.settings.webHooks.remove(),!1):(alert("Default delete action"),void 0)}),e.helper.find(".vbs-section-btns").on("touchstart click",".vbs-blue-btn",function(s){s.preventDefault(),e.helper.find(".vbs-section-btns .vbs-del-btn").removeClass("vbs-active"),t(this).parents(".vbs-popup").fadeOut("fast")}),e.helper.find(".vbs-section-btns").on("touchstart click",".vbs-star-btn",function(s){s.preventDefault();var a=t(this);if(a.hasClass("vbs-disable-button"))return!1;if(a.hasClass("vbs-active")){if("undefined"!=typeof e.settings.webHooks.favoriteTrue)return e.settings.webHooks.favoriteTrue(),!1;e.api.favorite(!1)}else{if("undefined"!=typeof e.settings.webHooks.favoriteFalse)return e.settings.webHooks.favoriteFalse(),!1;e.api.favorite(!0)}}),e.helper.find(".vbs-section-btns").on("touchstart click",".vbs-help-btn",function(t){return t.preventDefault(),"undefined"!=typeof e.settings.webHooks.help?(e.settings.webHooks.help(),!1):(window.open(e.settings.helpUrl,"_blank"),void 0)}),e.helper.find(".vbs-section-btns").on("touchstart click",".vbs-expand-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.fullscreen)return e.settings.webHooks.fullscreen(),!1;if(t("body").addClass("vbs-fullscreen"),"sublime"==e.settings.playerType||"jplayer"==e.settings.playerType){var a=e.helper.findc(".vbs-player-wrapper");e.PlayerApi.setSizePlayer(a.width(),a.height())}var r=t("#"+e.settings.controlsBlock);return e.settings.markersInNativeTimeline?m("full"):h("full"),r.append('<a href="#" class="vbs-fullscreen-exit">Exit</a>').wrap('<div class="vbs-controls-wrapper"></div>').addClass("vbs-controls-box"),e.settings.markersInNativeTimeline&&f("full"),e.view.resizeTimelineElements(),e.helper.collapseNewsBlock(),!1}),t(document).off("touchstart click",".vbs-fullscreen-exit").on("touchstart click",".vbs-fullscreen-exit",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.fullscreenExit)return e.settings.webHooks.fullscreenExit(),!1;t("body").removeClass("vbs-fullscreen"),("sublime"==e.settings.playerType||"jplayer"==e.settings.playerType)&&e.PlayerApi.setDefaultSizePlayer(),t(this).remove();var a=t("#"+e.settings.controlsBlock);a.unwrap().removeClass("vbs-controls-box"),e.settings.markersInNativeTimeline?(m("exit_full"),f("exit_full")):h("exit_full"),e.view.resizeTimelineElements()});var m=function(s){var a=t("#"+e.settings.controlsBlock),r=t("#vbs-searchbar-block");if("full"==s)if(a.addClass("vbs-native-markers"),e.settings.searchBarOuter)a.append(r);else{var n='<div id="vbs-searchbar-block" class="vbs-controls-after-searchbar vbs-searchbar-outer"></div>';a.append(n),r=t("#vbs-searchbar-block"),r.append(t(".vbs-search-form")),r.append(t(".vbs-after-controls-wrapper"))}else"exit_full"==s&&(a.removeClass("vbs-native-markers"),e.settings.searchBarOuter?a.after(r):(t(".vbs-keywords-block .vbs-section-title").after(t(".vbs-search-form")),t(".vbs-keywords-block").find(".vbs-controls-after-searchbar").empty().append(t(".vbs-after-controls-wrapper")),t("#vbs-searchbar-block").remove()))},f=function(s){var a=t("#vbs-searchbar-block");if("full"==s){var r=a.width()-t(".vbs-fullscreen-exit").width()-t(".vbs-after-controls-wrapper").width()-20;a.find(".vbs-search-form").width(r),t(".vbs-controls-wrapper").height("85px")}else"exit_full"==s&&(e.settings.searchBarOuter?a.find(".vbs-search-form").width(a.width()-t(".vbs-controls-after-searchbar .vbs-after-controls-wrapper").width()-2):t(".vbs-search-form").width("inherit"))};e.helper.find(".vbs-section-btns").on("touchstart click",".vbs-readermode-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.readermode)return e.settings.webHooks.readermode(),!1;e.view.hideTooltips(),t("body").addClass("vbs-readermode");var a=t("#"+e.settings.controlsBlock);h("full"),a.append('<a href="javascript:void(0)" class="vbs-reader-exit">Exit</a>').wrap('<div id="vbs-controls-placement"><div class="vbs-controls-wrapper"></div></div>').addClass("vbs-controls-box"),e.view.resizeTimelineElements();var r=e.data.vclass;e.settings.localApp&&(r+=" vbs-local-app"),t("body").append('<div id="vbs-reader-wrap" class="'+r+'"></div>'),t(".vbs-controls-wrapper").appendTo("#vbs-reader-wrap"),t(".vbs-transcript-block").appendTo("#vbs-reader-wrap"),e.helper.collapseNewsBlock()}),t(document).off("touchstart click",".vbs-reader-exit").on("touchstart click",".vbs-reader-exit",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.readermodeExit)return e.settings.webHooks.readermodeExit(),!1;t("body").removeClass("vbs-readermode"),t(this).remove(),t(".vbs-controls-wrapper").appendTo("#vbs-controls-placement").unwrap(),t(".vbs-transcript-block").appendTo("#"+e.settings.transcriptBlock),t("#vbs-reader-wrap").remove();var a=t("#"+e.settings.controlsBlock);a.unwrap().removeClass("vbs-controls-box"),h("exit_full"),e.view.resizeTimelineElements()});var h=function(s){var a=t("#"+e.settings.controlsBlock),r=t("#vbs-searchbar-block");"full"==s?(e.settings.searchBarOuter?(r.css("height",0),a.append(r)):a.append(t(".vbs-search-form")),a.hasClass("less-600px")&&!e.helper.isMobile()&&a.removeClass("less-600px").addClass("less-600px-backup"),e.settings.markersInNativeTimeline&&e.view.resetControlsPlace()):"exit_full"==s&&(e.settings.searchBarOuter?(r.css("height","32px"),a.after(r)):t(".vbs-keywords-block .vbs-section-title").after(t(".vbs-search-form")),a.hasClass("less-600px-backup")&&!e.helper.isMobile()&&a.removeClass("less-600px-backup").addClass("less-600px"),e.settings.markersInNativeTimeline&&e.view.renderControlsAfterSearchBar())};e.settings.toggleBlocks&&e.settings.toggleCommentBlock&&e.helper.find(".vbs-comments-block .vbs-section-title").on("touchstart click",function(s){s.preventDefault(),e.comments.toggleBlockHandler(t(this))}),e.helper.find(".vbs-comments-block .vbs-section-btns").on("touchstart click",".vbs-comments-btn",function(s){return s.preventDefault(),"undefined"!=typeof e.settings.webHooks.comment?(e.settings.webHooks.comment(),!1):(e.comments.clickAddCommentHandler(t(this)),void 0)}),e.helper.find(".vbs-comments-block").on("touchstart click",".vbs-section-header .vbs-confirm-btn",function(s){s.preventDefault(),e.comments.confirmAddCommentHandler(t(this))}),e.helper.find(".vbs-comments-block").on("touchstart click",".vbs-play-btn",function(s){s.preventDefault(),e.helper.collapseNewsBlock(),e.comments.playCommentHandler(t(this))}),e.helper.find(".vbs-comments-block").on("touchstart click",".vbs-comment-time",function(s){s.preventDefault(),e.comments.commentTimeHandler(t(this)),e.helper.collapseNewsBlock()}),e.helper.find(".vbs-comments-block").on("touchstart click",".vbs-comment-reply",function(s){return s.preventDefault(),e.helper.collapseNewsBlock(),"undefined"!=typeof e.settings.webHooks.comment?(e.settings.webHooks.comment(),!1):(e.comments.replyHandler(t(this)),void 0)}),e.helper.find(".vbs-comments-block").on("touchstart click",".vbs-comment-edit",function(s){return s.preventDefault(),e.helper.collapseNewsBlock(),"undefined"!=typeof e.settings.webHooks.commentEdit?(e.settings.webHooks.commentEdit(),!1):(e.comments.editHandler(t(this)),void 0)}),e.helper.find(".vbs-comments-block").on("touchstart click",".vbs-section-header .vbs-cancel-btn, .vbs-comment-reply-wrapper .vbs-cancel-btn, .vbs-comment-edit-btn-wrapper .vbs-cancel-btn, .vbs-comment-delete-btn-wrapper .vbs-confirm-btn",function(s){s.preventDefault(),e.helper.collapseNewsBlock(),e.comments.cancelHandler(t(this))}),e.helper.find(".vbs-comments-block").on("touchstart click",".vbs-comment-reply-wrapper .vbs-confirm-btn",function(s){s.preventDefault(),e.helper.collapseNewsBlock(),e.comments.replyConfirmHandler(t(this))}),e.helper.find(".vbs-comments-block").on("touchstart click",".vbs-comment-edit-btn-wrapper .vbs-confirm-btn",function(s){s.preventDefault(),e.helper.collapseNewsBlock(),e.comments.editConfirmHandler(t(this))}),e.helper.find(".vbs-comments-block").on("touchstart click",".vbs-comment-delete",function(s){s.preventDefault(),e.helper.collapseNewsBlock(),e.comments.deleteHandler(t(this))}),e.helper.find(".vbs-comments-block").on("touchstart click",".vbs-comment-delete-btn-wrapper .vbs-cancel-btn",function(s){return s.preventDefault(),"undefined"!=typeof e.settings.webHooks.commentDelete?(e.settings.webHooks.commentDelete(),!1):(e.comments.deleteConfirmHandler(t(this)),void 0)}),e.helper.find(".vbs-section-btns").on("touchstart click",".vbs-evernote-btn",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.evernote)return e.settings.webHooks.evernote(),!1;if("undefined"!=typeof filepicker){var s=null!==e.api.response.metadata&&""!==e.api.response.metadata.response.title?e.api.response.metadata.response.title:"VoiceBase";filepicker.exportFile(e.api.getAutoNotesHtmlURL(),{service:"EVERNOTE",suggestedFilename:s})}}),e.helper.find(".vbs-section-btns").on("touchstart click",".vbs-edit-btn",function(s){if(s.preventDefault(),e.helper.getIsSaving())return!1;if("undefined"!=typeof e.settings.webHooks.editTranscript)return e.settings.webHooks.editTranscript(),!1;e.view.hideTooltips(),e.data.savingSpeakers=t.extend({},e.data.speakers),e.helper.find(".vbs-edit-mode-prewrapper").html(e.templates.parse("vbs-edit-trans-mode",{ourtranscript:e.helper.editTranscriptText()})),t("body").addClass("vbs-no-scroll");var a=t("#"+e.settings.transcriptBlock);a.wrap('<div id="transcript_placement"></div>'),t("body").append('<div id="vbs-edit-wrap"  class="'+e.data.vclass+'"></div>'),a.appendTo("#vbs-edit-wrap"),e.helper.collapseNewsBlock()}),e.helper.find(".vbs-transcript-block").on("touchstart click",".vbs-edit-mode-exit",function(s){return s.preventDefault(),"undefined"!=typeof e.settings.webHooks.editTranscriptExit?(e.settings.webHooks.editTranscriptExit(),!1):(e.data.speakers=e.data.savingSpeakers,t("#"+e.settings.transcriptBlock).appendTo("#transcript_placement").unwrap(),t("#vbs-edit-wrap").remove(),e.helper.find(".vbs-edit-mode-prewrapper").html(""),t("body").removeClass("vbs-no-scroll"),void 0)}),e.helper.find(".vbs-transcript-block").on("touchstart click",".vbs-save-edition-popup-trigger",function(t){t.preventDefault(),e.helper.showSaveQuestion()}),e.helper.find(".vbs-transcript-block").on("touchstart click",".vbs-cancel-edition-btn",function(t){t.preventDefault(),e.helper.find(".vbs-save-popup-wrapper").fadeOut("fast")}),e.helper.find(".vbs-transcript-block").on("touchstart click",".vbs-discard-edition-btn",function(t){t.preventDefault(),e.helper.find(".vbs-edit-mode-prewrapper").html(e.templates.parse("vbs-edit-trans-mode",{ourtranscript:e.helper.editTranscriptText()}))}),e.helper.find(".vbs-transcript-block").on("touchstart click",".vbs-save-edition-btn",function(t){t.preventDefault(),e.helper.saveTranscript()}),t(".vbs-section-btns").on("touchstart click",".vbs-print-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.print)return e.settings.webHooks.print(),!1;var a=window.open("","","height="+screen.availHeight+",width="+screen.availWidth+",left=0,top=0");a.document.write("<html><head><title></title>"),a.document.write("</head><body >");var r=t(".vbs-transcript-wrapper").clone();r.find(".vbs-trans-info").remove(),a.document.write(r.html()),a.document.write("</body></html>"),a.document.close(),a.focus(),a.print(),a.close()}),t(".vbs-transcript-block").on("touchstart click",".vbs-order-human-trans a",function(){if("undefined"!=typeof e.settings.webHooks.orderTranscript){var t=(e.data.duration/60).toFixed(2);return e.settings.webHooks.orderTranscript({apiUrl:e.settings.apiUrl,version:e.settings.version,apiKey:e.settings.apiKey,password:e.settings.password,mediaId:e.settings.mediaId,mediaUrl:e.api.response.metadata.response.streamUrl,recordName:e.api.response.metadata.response.title,mediaLengthInMinutes:t}),!1}}),e.settings.toggleBlocks&&e.settings.toggleNewsBlock&&e.helper.find(".vbs-news-block .vbs-section-title").on("touchstart click",function(s){s.preventDefault();var a=t(this);a.toggleClass("vbs-hidden");a.parents(".vbs-news-block").find(".vbs-section-body");a.hasClass("vbs-hidden")?e.helper.collapseNewsBlock():(e.helper.expandNewsBlock(),e.api.getNews())}),t(document).off("touchstart click",".vbs-reload-overlay,.vbs-white-popup-overlay").on("touchstart click",".vbs-reload-overlay,.vbs-white-popup-overlay",function(s){s.preventDefault();var a=t(this);if(a.hasClass("vbs-white-popup-overlay")&&e.settings.tabView)return!1;a.fadeOut("fast",function(){a.remove()});var r=t(s.target);r.hasClass("vbs-reload-btn")&&location.reload()}),(e.settings.contextMenu||e.settings.editKeywords)&&(e.helper.find(".vbs-record-timeline-wrap").on("contextmenu taphold",function(t){e.common.vbmenus(t,"timeline",this)}),e.helper.find(".vbs-keywords-wrapper").on("contextmenu taphold",".vbs-keywords-list-wrapper li a",function(t){e.common.vbmenus(t,"keyword",this)}),e.helper.find(".vbs-transcript-prewrapper").on("contextmenu taphold",".vbs-transcript-wrapper span.w",function(t){e.common.vbmenus(t,"transcript",this)}),t(document).off("click.vbs_vbcmenu").on("click.vbs_vbcmenu",function(e){1===e.which&&t("ul.vbs-vbcmenu").css({top:"-5000px"})})),e.helper.find(".vbs-transcript-block").on("contextmenu taphold",".vbs-edition-block span.vbs-wd",function(t){t.preventDefault(),e.common.vbEditMenu(t,this)}),t(document).off("keydown",".vbs-edition-block").on("keydown",".vbs-edition-block",function(e){13==e.keyCode&&document.execCommand("insertHTML",!1,"<br>")}),t(document).off("touchstart click",".vbsc-edit-play").on("touchstart click",".vbsc-edit-play",function(s){s.preventDefault();var a=t(this).attr("data-time");e.PlayerApi.seek(a)}),t(document).off("touchstart click",".vbsc-edit-speaker").on("touchstart click",".vbsc-edit-speaker",function(s){s.preventDefault(),e.speakers.createInsertSpeakerDialog(t(this))}),t(document).off("touchstart click",".vbs-select-insert-speaker").on("touchstart click",".vbs-select-insert-speaker",function(e){e.preventDefault(),s(t(this))}),t(document).off("touchstart click",".vbs-select-insert-speaker-wrapper .vbs-select-dropdown li").on("touchstart click",".vbs-select-insert-speaker-wrapper .vbs-select-dropdown li",function(s){s.preventDefault(),e.speakers.selectSpeakerInInsertDialog(t(this))}),t(document).off("touchstart click",".vbs-insert-speaker-popup .vbs-cancel-btn").on("touchstart click",".vbs-insert-speaker-popup .vbs-cancel-btn",function(s){s.preventDefault(),e.common.hidePopup(t(".vbs-insert-speaker-popup"))}),t(document).off("touchstart click",".vbs-insert-speaker-popup .vbs-confirm-btn").on("touchstart click",".vbs-insert-speaker-popup .vbs-confirm-btn",function(s){s.preventDefault();var a=t(".vbs-insert-speaker-popup"),r=e.validator.validate(a);r&&(e.speakers.insertSpeakerToEditor(),e.common.hidePopup(a))}),t(document).off("touchstart click",".vbsc-rename-speaker").on("touchstart click",".vbsc-rename-speaker",function(s){s.preventDefault(),e.speakers.createRenameSpeakerDialog(t(this))}),t(document).off("touchstart click",".vbs-rename-speaker-popup .vbs-cancel-btn").on("touchstart click",".vbs-rename-speaker-popup .vbs-cancel-btn",function(s){s.preventDefault(),e.speakers.enableRenameAllSpeakersInEditor(),e.common.hidePopup(t(".vbs-rename-speaker-popup"))}),t(document).off("touchstart click",".vbs-rename-speaker-popup .vbs-confirm-btn").on("touchstart click",".vbs-rename-speaker-popup .vbs-confirm-btn",function(s){s.preventDefault();var a=t(".vbs-rename-speaker-popup"),r=e.validator.validate(a);r&&(e.speakers.renameSpeaker(),e.common.hidePopup(a))}),t(document).off("blur keyup paste",".vbs-edition-block").on("blur keyup paste",".vbs-edition-block",function(){var s=window.getSelection?window.getSelection():document.selection;if(s.focusNode&&s.focusNode.parentElement){var a=t(s.focusNode.parentElement);a.hasClass("vbs-edit-speaker")&&e.speakers.renameSpeakerFromEditor(a)}}),e.settings.debug&&t(document).off("keydown.vbs_keydown").on("keydown.vbs_keydown",function(t){var s=t.which||t.keyCode;71===s&&(t.metaKey||t.ctrlKey)&&t.altKey&&e.helper.debug()}),e.settings.tabView&&t(document).off("click touchstart",".vbs-tabs-links a").on("click touchstart",".vbs-tabs-links a",function(e){e.preventDefault();var s=t(this),a=s.attr("data-href");return s.hasClass("vbs-active")||(s.siblings().removeClass("vbs-active"),s.addClass("vbs-active")),t(".vbs-tab").each(function(){t(this).removeClass("vbs-tab-visible")}),t(a).addClass("vbs-tab-visible"),!1}),t(document).off("touchstart click",".vbs-selected-playlist-item").on("touchstart click",".vbs-selected-playlist-item",function(s){s.preventDefault();var a=t(this).parents(".vbs-playlist");if(a.toggleClass("collapsed"),!a.hasClass("collapsed")){var r=e.PlayerApi.getPlaylistItemIndex(),n=a.find("[data-playlist-item-index="+r+"]");a.animate({scrollTop:n.offset().top-n.parent().offset().top})}}),t(document).off("touchstart click",".vbs-playlist-item").on("touchstart click",".vbs-playlist-item",function(s){s.preventDefault();var a=t(this).attr("data-playlist-item-index"),r=t(this).parents(".vbs-playlist");r.addClass("collapsed"),e.PlayerApi.setPlaylistItem(a)}),t(document).off("touchstart click",".vbs-cancel-search").on("touchstart click",".vbs-cancel-search",function(t){t.preventDefault(),e.data.searchWorker&&e.data.searchWorker.terminate(),e.helper.clearMessage(),e.helper.hideLoader(),e.data.clicker=!1,e.PlayerApi.play()})}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.helper={isRand:!1,randConstant:null,css:"",randId:function(){return this.isRand||this.randConstant||(this.isRand=!0,this.randConstant=this.rand()),this.randConstant},rand:function(){return Math.ceil(1e9*Math.random())},loadCss:function(e){if(-1==this.css.indexOf("["+e+"]")){this.css+="["+e+"]";
var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),"undefined"!=typeof t&&document.getElementsByTagName("head")[0].appendChild(t)}},find:function(s){return t("."+e.data.vclass+" "+s)},findc:function(s){return t("."+e.data.vclass+s)},showLoader:function(){var t=e.helper.find(".vbs-record-timeline-wrap");e.settings.animation&&t.has(".vbs-loader")&&t.prepend('<div class="vbs-loader"></div>')},hideLoader:function(){e.helper.find(".vbs-record-timeline-wrap .vbs-loader").fadeOut("fast",function(){t(this).remove()})},removeBold:function(){e.helper.find(".vbs-keywords-list-wrapper .vbs-keywords-list-tab li a.bold").removeClass("bold")},termFor:function(e,t){var s=e.split(","),a=[];for(var r in s)s[r].match(/\s+/g)?a.push('"'+s[r]+'"'):a.push(s[r]);return"undefined"!=typeof t&&"url"==t?a.join(" "):a},parseTime:function(e){var t=Math.floor(e/3600)+"",s=Math.floor(e%3600/60)+"",a=Math.floor(e%3600%60)+"";return t.padLeft(2)+":"+s.padLeft(2)+":"+a.padLeft(2)},getSearchWordsArray:function(){var t=e.helper.find("#vbs-voice_search_txt").val().trim();return t=e.helper.matchWords(t),t=t?t:[]},matchWords:function(t){return t=e.helper.checkQuotes(t),t=t.replace(/""/g,'"'),t.match(/("[^"]+")+|[\S]+/gi)},checkQuotes:function(e){for(var t=[],s=!1,a=-1;!s;)a=e.indexOf('"',a+1),-1!==a?t.push(a):s=!0;if(t.length%2!==0)if(1===t.length)e+='"';else if(t.length>=3){var r=t[t.length-2],n=e.substring(0,r+1),i=e.substring(r+1);e=n+' "'+i}return e},keywordsAutoTopicsColumns:function(s){s="undefined"!=typeof s?s:5;var a=e.helper.find(".vbs-keywords-list-wrapper"),r=this;return 0===s?!1:(a.removeClass(r.getColumnClassByNumber(s+1)).addClass(r.getColumnClassByNumber(s)),a.find("ul.vbs-active li").each(function(){return t(this).height()>18?(r.keywordsAutoTopicsColumns(s-1),!1):void 0}),void 0)},keywordsAutoColumns:function(s){s="undefined"!=typeof s?s:5;var a=e.helper.find(".vbs-keywords-list-wrapper"),r=this;return 0===s?(a.removeClass("vbs-auto-columns"),!1):(a.addClass("vbs-auto-columns"),a.removeClass(this.getColumnClassByNumber(s+1)).addClass(this.getColumnClassByNumber(s)),a.find("ul li").each(function(){return t(this).height()>18?(r.keywordsAutoColumns(s-1),!1):void 0}),a.removeClass("vbs-auto-columns"),void 0)},getColumnClassByNumber:function(e){switch(e){case 1:return"vbs-one-col";case 2:return"vbs-two-col";case 3:return"vbs-three-col";case 4:return"vbs-four-col";case 5:return"vbs-five-col";default:return""}},filterKeywords:function(s){e.settings.filterSpeaker=s;var a=e.helper.find(".vbs-topics .vbs-topics-list li");a.removeClass("vbs-disabled"),a.find("a").each(function(){var e=t(this);"all"==s||(e.is('[speakers*="'+s+'"]')||e.parent().addClass("vbs-disabled"),e.attr("t",e.attr("data-spt-"+s)))}),e.helper.find(".vbs-keywords-list-wrapper .vbs-keywords-list-tab li a").each(function(){var a=t(this);if(a.parent().removeClass("key"),"all"==s){a.parent().addClass("key").show();var r=[];for(var n in e.data.speakers)"undefined"!=typeof a.attr("data-spt-"+n)&&r.push(a.attr("data-spt-"+n));a.attr("t",r.join())}else a.is('[speakers*="'+s+'"]')?a.parent().addClass("key").show():a.parent().hide(),a.attr("t",a.attr("data-spt-"+s))});var r=e.helper.find(".vbs-topics .vbs-topics-list li.vbs-active");if(r.is(":hidden")){var n=e.helper.find(".vbs-topics-list li.vbs-all-topics");n.parent().find(".vbs-active").removeClass("vbs-active"),n.addClass("vbs-active");var i=n.find("a").text().trim();e.helper.find(".vbs-keywords-list-tab ul").removeClass("vbs-active"),e.helper.find('.vbs-keywords-list-tab ul[tid="'+i+'"]').addClass("vbs-active")}e.helper.find("#vbs-voice_search_txt").val().trim().length>0&&(e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.api.getSearch([e.helper.find("#vbs-voice_search_txt").val().trim()],!1)),e.settings.keywordsCounter&&e.helper.find(".vbs-keywords-list-tab li a").each(function(){var e=t(this),s=e.attr("t");e.parent().find("span").html("("+s.split(",").length+")")})},setUtterance:function(s){for(var a="",r="",n=s.length,i=0;n>i;i++){for(var o=s[i],l=o.segments,d=l.length,c=0;d>c;c++){var p=l[c],v=e.PlayerApi.getOffset(p.s),u=e.PlayerApi.getOffset(p.e),b=u-v,m=e.helper.parseTime(p.s)+" to "+e.helper.parseTime(p.e),f=65,h=p.u.substr(0,f-3)+"...";a+=e.templates.parse("utteranceMarker",{startTime:p.s,rownum:i+1,width:b,position:v,title:h,time:m})}r+=e.templates.parse("utteranceCheckBox",{rownum:i+1,title:o.name,segmentsCount:l.length})}if(e.helper.find(".vbs-utterance-markers").empty().append(a),r){var g=e.templates.get("utteranceBlock");t("#"+e.settings.controlsBlock).after(t(g)),t(".vbs-utterance-block").addClass(e.data.vclass).find("ul").append(r)}},downloadFile:function(t){var s=e.api.parameters;s.action="getTranscript",s.content=!0,s.format=t;var a=e.settings.apiUrl+"?"+e.common.getStringFromObject(s);window.location=a},getNewUrl:function(t){var s=window.location.search.substring(1),a=s.split("&"),r={},n=[];if(s.length>0)for(var i=a.length,o=0;i>o;o++){var l=a[o].split("=");if("vbt"!=l[0]&&"vbs"!=l[0]){r[l[0]]=l[1];for(var d in t)decodeURIComponent(l[0])==d&&(r[l[0]]=t[d])}}for(var c in e.settings.shareParams)"undefined"==typeof r[c]&&(r[c]=e.settings.shareParams[c]);for(var p in t)"undefined"==typeof r[p]&&(r[p]=t[p]);for(var v in r)n.push(v+"="+r[v]);return e.settings.shareUrl?e.settings.shareUrl+"?"+n.join("&"):window.location.origin+window.location.pathname+"?"+n.join("&")},checkAutoStart:function(){for(var t=window.location.search.substring(1),s=["vbt","vbs"],a=t.split("&"),r={},n=a.length,i=0;n>i;i++){var o=a[i].split("=");for(var l in s)decodeURIComponent(o[0])==s[l]&&(r[s[l]]=o[1])}return e.data.startParams=r,!1},waitReady:function(){if(e.api.ready.keywords&&e.api.ready.metadata&&e.api.ready.transcript&&e.api.ready.comments){if(clearInterval(e.data.waiter),e.data.waiter=null,e.helper.checkErrors(),e.speakers.speakersWidget(),Object.keys(e.data.speakers).length>1&&e.speakers.speakerFilterWidget(e.data.speakers,"all"),e.comments.commentsTWidget(),e.settings.editKeywords&&t(".vbs-keywords-block .vbs-topics").addClass("vbs-edit-topics"),t(".vbs-media-block").hasClass(".less-600px")||t(".vbs-record-player .vbs-time-name-wrapper-narrow").css({opacity:0}),"jwplayer"===e.settings.playerType&&null!==e.api.response.metadata&&!e.settings.hasPlaylist)if(e.helper.isApi2_0()&&e.settings.stream){var s=e.settings.apiUrl+e.settings.mediaId+"/streams/original?"+e.settings.token;e.PlayerApi.loadFile(s)}else if("html5"!=e.PlayerApi.getRenderingMode()&&"rtmp"==e.settings.stream){var a=e.api.response.metadata.response.rtmpUrl+""+e.api.response.metadata.response.rtmpFile;e.PlayerApi.loadFile(a)}else("http"===e.settings.stream||e.settings.stream===!0)&&e.PlayerApi.loadFile(e.api.response.metadata.response.streamUrl);e.data.startParams!==!1&&this.autoStart(e.data.startParams),e.api.response.keywords&&e.api.response.keywords.utterances&&e.helper.setUtterance(e.api.response.keywords.utterances),e.view.checkEmptyHeadersForTabs(),e.view.tooltips(),e.methods.ready()}return!1},waitReadyAfterSave:function(){if(e.api.ready.keywords&&e.api.ready.metadata&&e.api.ready.transcript&&e.api.ready.comments){if(clearTimeout(e.data.waiterSave),e.data.waiterSave=null,e.settings.modalSave){var s=e.helper.find(".vbs-save-popup-wrapper");s.find(".vbs-save-loading-popup").fadeOut("fast"),s.find(".vbs-save-done-popup").fadeIn("fast")}else e.helper.clearSavingMessages(),t("#"+e.settings.controlsBlock).after(e.templates.get("successSavingMessage")),setTimeout(function(){e.helper.clearSavingMessages()},3e3);setTimeout(function(){e.settings.modalSave&&e.helper.exitEditFullscreen(),e.helper.checkErrors(),e.speakers.speakersWidget(),e.comments.commentsTWidget(),e.view.tooltips()},800)}return!1},exitEditFullscreen:function(){t("#"+e.settings.transcriptBlock).appendTo("#transcript_placement").unwrap(),e.helper.find(".vbs-edit-mode-prewrapper").html(""),t("body").removeClass("vbs-no-scroll")},autoStart:function(t){var s;if("undefined"!=typeof t.vbs){e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive");var a=decodeURI(t.vbs).trim();a=e.helper.matchWords(a),a=a?a:[];var r=a.join(" ");e.helper.find("#vbs-voice_search_txt").val(r).data("data-val",r).change(),a.length&&e.view.searchWordWidget(a);var n=!0;return"undefined"!=typeof t.vbt&&(n=!1,s=t.vbt,e.PlayerApi.seek(s)),e.api.getSearch(a,n),!1}"undefined"!=typeof t.vbt&&(s=t.vbt,e.PlayerApi.seek(s))},moveToNextMarker:function(s){var a=!0,r=[],n=s.find("a");n.each(function(){r.push(parseFloat(t(this).attr("stime")))}),r.sort(function(e,t){return parseInt(e,10)-parseInt(t,10)});for(var i in r)if(r[i]>e.PlayerApi.getPosition()+1)return e.PlayerApi.seek(r[i]),a=!1,!1;a&&n.length&&e.PlayerApi.seek(r[0])},moveToPrevMarker:function(s){var a=!0,r=[],n=s.find("a");n.each(function(){r.push(parseFloat(t(this).attr("stime")))}),r.sort(function(e,t){return parseInt(t,10)-parseInt(e,10)});for(var i in r)if(r[i]<e.PlayerApi.getPosition()-1)return e.PlayerApi.seek(r[i]),a=!1,!1;a&&n.length&&e.PlayerApi.seek(r[0])},startScroll:function(){var s=e.helper.find("#vbs-search-string .vbs-marquee");if(s.is(":visible")){var a=s.find(".vbs-search-word-widget");a.stop(!0).css("left",0);var r=0;e.helper.find(".vbs-word").width(function(e,t){r+=t}),r>s.width()?(a.width(r),e.helper.scrollStringLeft()):a.width(t("#vbs-search-string").width())}},scrollStringLeft:function(){var t=e.helper.find(".vbs-word").length,s=1200*t,a=e.helper.find("#vbs-search-string .vbs-marquee"),r=a.find(".vbs-search-word-widget");r.animate({left:a.width()-r.width()},{duration:s,complete:function(){e.helper.scrollStringRight()}})},scrollStringRight:function(){var t=e.helper.find(".vbs-word").length,s=1200*t;e.helper.find("#vbs-search-string .vbs-marquee .vbs-search-word-widget").animate({left:"1"},{duration:s,complete:function(){e.helper.scrollStringLeft()}})},getMaxKeywordHeight:function(){var t=e.helper.find(".vbs-topics-list").height(),s=e.helper.find(".vbs-keywords-list-tab ul.vbs-active").height()+10;return t>s?t:s},getKeywordHeight:function(){var e=t(".vbs-topics").height(),s=t(".vbs-keywords-list-tab").height()+10;return e>s?e:s},checkKeyword:function(s,a,r){e.helper.find("#vbs-search-string .vbs-search-word-widget .vbs-word a.vbs-add-search-word").remove(),s=e.common.uniqueArray(s);for(var n in s){var i=e.helper.replaceTrimAndLower(s[n]);if(!e.common.findTermInArray(e.data.keywords,i)){var o=[];for(var l in r)r[l].term==i&&r[l].hits.map(function(e){o=o.concat(e.time)});if(o.length>0){var d=t('<a href="#add" class="vbs-add-search-word" title="Add to all topics"></a>');d.data("data-kwa",s[n]),d.data("data-kwt",o.join(",")),e.helper.find("#vbs-search-string .vbs-search-word-widget .vbs-word").each(function(){var e=t(this).find(".vbs-search_word").text();e===s[n]&&t(this).append(d)})}}}},localSearch:function(s,a){if(a.length>1)return e.api.getSearch(a),!1;var r=[],n=[];e.helper.find(".vbs-widget .vbs-word").each(function(e,s){var a=t(s),r=a.find(".vbs-search_word").text().replace(/"/g,"").toLowerCase();n[r]=a.find(".vbs-marker").css("border-bottom-color")});var i=[],o=s.attr("t").split(","),l=[];o.map(function(t){e.speakers.filterResultForSpeaker(t)&&(i=i.concat(t),l=l.concat(e.helper.getPhraseByTime(t-1e3,t+1500,a)))});var d=e.helper.find(".vbs-record-timeline-wrap");e.data.markersStyles={markersWrapper:d,markersContainer:d.find(".vbs-markers"),markersWrapperWidth:d.width()};var c=e.view.markerWidget(i,l,n[a]);e.data.markersStyles.markersContainer.append(c),r=r.concat(i),r.sort(function(e,t){return e-t}),e.PlayerApi.seek(r[0])},getPhraseByTime:function(t,s,a){var r="",n=e.helper.find(".vbs-transcript-wrapper > span > span:wordtime("+1e3*t+","+1e3*s+")");if(r=e.helper.getTextFromElems(n),"undefined"!=typeof Fuse){var i=r.split(" "),o=a.split(" ").length,l=[];if(o>1)for(var d=0;d<i.length;d++){for(var c="",p=0;o>p;p++)i[d+p]&&(c+=i[d+p]+" ");l.push(c.trim())}else l=i;var v=new Fuse(l,{threshold:.4}),u=v.search(a),b=u.length>0?u[0]:null;if(null!==b){r="";for(var m=0;m<l.length;m++){var f=l[m];f=f.split(" ")[0],m>=b&&b+o-1>=m&&(f="<b>"+f+"</b>"),r+=f+" "}}}return r},getTextFromElems:function(s){var a="";return s.each(function(){if(!t(this).attr("m")){var s=t(this).text();s=e.helper.replaceAndTrim(s),""===s||s.match(/\w+/g)?""!==s&&(a+=""===a?s:" "+s):a+=s}}),a},highlight:function(s){var a=Math.round(s);1==a&&(a=0);var r=Math.floor(a/e.settings.transcriptHighlight);a=r*e.settings.transcriptHighlight;var n=e.helper.find(".vbs-transcript-block"),i=n.find(".vbs-transcript-wrapper"),o=n.find(".vbs-transcript-prewrapper");i.children("span").removeClass("vbs-hl"),i.children("span:wordtime("+a+","+(a+e.settings.transcriptHighlight-1)+")").addClass("vbs-hl");var l=i.children("span.vbs-hl").length?i.children("span.vbs-hl"):!1,d=o.length?o:!1;l&&d&&o.not(".vbs-t-hover").stop(!0,!0).animate({scrollTop:l.offset().top-d.offset().top+d.scrollTop()-(d.height()-20)/2},500),t("body").hasClass("vbs-readermode")&&o.not(".vbs-t-hover").length&&(d=n.length?n:!1,l&&d&&n.stop(!0,!0).animate({scrollTop:l.offset().top-d.offset().top+d.scrollTop()-(d.height()-20)/2},500))},manageHighlightSnippets:function(s){for(var a=e.data.highlightSnippets,r=e.helper.find(".vbs-transcript-wrapper"),n=0;n<a.length;n++){var i=a[n],o=r.find(".vbs-trans-word:wordtime("+1e3*i.startTime+","+1e3*i.endTime+")");o.each(function(){var e=s?i.color:"";t(this).css("background-color",e)})}},track:function(t,s){if(s="undefined"!=typeof s?s:!1,"undefined"!=typeof ga&&e.settings.trackEvents)switch(t){case"play":return ga("send","event",e.settings.mediaId,"Play",e.PlayerApi.getPosition()),!0;case"pause":return ga("send","event",e.settings.mediaId,"Pause",e.PlayerApi.getPosition()),!0;case"seek":return ga("send","event",e.settings.mediaId,"Seek",s),!0;case"keyword":return ga("send","event",e.settings.mediaId,"Keyword",s),!0;case"transcript":return ga("send","event",e.settings.mediaId,"Transcript",s),!0;default:return!1}return!1},editTranscriptText:function(){for(var t=e.api.response.transcript.transcript,s="",a=0,r=0,n=t.length,i=0;n>i;i++){var o=t[i];0===i&&(s+='<span t="0">');for(var l=2;10>=l;l++)Math.floor(o.s/1e3)>=r+e.settings.transcriptHighlight*l&&(r+=e.settings.transcriptHighlight*l,s+='<span t="'+r+'"></span>');Math.floor(o.s/1e3)>=r+e.settings.transcriptHighlight&&(r+=e.settings.transcriptHighlight,s+='</span><span t="'+r+'">'),a+=o.s;var d=e.speakers.createSpeakerAttr(o),c=e.helper.replaceN(o.w);s+=o.w.match(/\w+/g)?'<span class="w vbs-wd '+(d.length?"vbs-edit-speaker":"")+'" t="'+o.s+'" '+d+"> "+c+"</span>":'<span class="vbs-wd" t="'+o.s+'" '+d+">"+c+"</span>"}return s+="</span>"},isTurn:function(e){return"undefined"!=typeof e&&"turn"==e},getClearWordFromTranscript:function(t){return e.helper.replaceAndTrim(t).replace(/:$/,"")},showSaveQuestion:function(){var s=t(".vbs-edit-speaker").length,a=e.helper.find(".vbs-edition-block").find('.w:not(".vbs-edit-speaker")').length,r=t(".vbs-transcript-prewrapper").find(".w").length-s,n=t(".vbs-save-popup");n.removeClass("vbs-long-edit vbs-short-edit"),a>r&&a>r/5?n.addClass("vbs-long-edit"):r>a&&r/5>a&&n.addClass("vbs-short-edit"),e.helper.find(".vbs-save-popup-wrapper").fadeIn("fast")},saveTranscript:function(){var t=e.helper.find(".vbs-edition-block").html();t=t.replace(/<br\s*[\/]?>/gi,"\n"),t=t.replace(/\\n/,"\n");var s=document.createElement("div");s.innerHTML=t;var a=s.textContent||s.innerText||"";e.api.saveTrancript(a.trim());var r=e.helper.find(".vbs-save-popup-wrapper");e.settings.modalSave?(r.find(".vbs-save-popup").fadeOut("fast"),r.find(".vbs-save-loading-popup").fadeIn("fast")):(r.fadeOut("fast"),e.helper.exitEditFullscreen())},saveTranscriptComplete:function(){e.helper.setIsSaving(!1),e.view.initAfterSaveTranscript(),e.data.waiterSave=setInterval(function(){e.data.waiterSave&&e.helper.waitReadyAfterSave()},100)},saveTranscriptError:function(s){if(e.helper.setIsSaving(!1),e.settings.modalSave){var a=e.helper.find(".vbs-save-popup-wrapper");a.find(".vbs-save-popup").show(),a.find(".vbs-save-loading-popup").fadeOut("fast"),a.fadeOut("fast");var r=e.templates.parse("abstractErrorPopup",{errorTitle:"Could not save transcript",errorText:s});t(".vbsp-"+e.helper.randId()+".vbs-content").append(r)}else{e.helper.clearSavingMessages();var n=e.templates.parse("textErrorMessage",{errorText:s});t("#"+e.settings.controlsBlock).after(n)}},setIsSaving:function(s){e.data.isSaving=s,e.settings.modalSave||(s?(t(".vbs-edit-btn").addClass("vbs-disable-button"),e.helper.clearSavingMessages(),t("#"+e.settings.controlsBlock).after(e.templates.get("savingMessage"))):t(".vbs-edit-btn").removeClass("vbs-disable-button"))},clearSavingMessages:function(){t(".vbs-saving").remove(),t(".vbs-success-saving").remove(),t(".vbs-text-error-message").remove()},getIsSaving:function(){return e.data.isSaving},adjustMediaTime:function(){var t=e.helper.find(".vbs-media-block"),s=t.find(".vbs-section-title"),a=t.find(".vbs-section-btns"),r=s.offset().left+s.width(),n=a.offset().left;if(r>=n&&(s.find(".vbs-voice-name").hide(),s=t.find(".vbs-section-title"),a=t.find(".vbs-section-btns"),r=s.offset().left+s.width(),n=a.offset().left,r>=n&&(s.find(".vbs-time").hide(),t.hasClass("vbs-video")))){var i=e.helper.parseTime(e.data.duration);e.helper.findc(".vbs-player-wrapper").append('<span class="vbs-time vbs-time-in-player"><span class="vbs-ctime">00:00:00</span> / <span class="vbs-ftime">'+i+"</span></span>")}},checkErrors:function(){if(e.settings.modalErrors){var s=t(".vbsp-"+e.helper.randId()+".vbs-content");if(e.api.errors.processing)s.append(e.templates.get("reloadOverlayCredentials"));else if(e.api.errors.failure){e.settings.tabView?s.append(e.templates.parse("abstractAlertPopup",{errorTitle:"File has not finishing processing yet",errorText:"Search, keywords, and transcript for this file are not available. If reloading does not solve the problem, please contact support for assistance."})):s.append(e.templates.get("errorPopup"));var a=s.find(".vbs-big-error-popup"),r=parseInt(a.css("height"));a.css("marginTop",-r/2)}}else if(e.api.errors.processing||e.api.errors.failure){var n="File not indexed. Search, Keywords & Transcript are unavailable for this recording.";e.api.errors.processing&&(n="Could not load recording data, indexing file may not be complete. If reload does not solve problem contact support for assistance");var i=e.templates.parse("textErrorMessage",{errorText:n});t("#"+e.settings.controlsBlock).after(i)}},debug:function(){var t="inited";"rtmp"==e.settings.stream?t=e.api.response.metadata.response.rtmpUrl+e.api.response.metadata.response.rtmpFile:("http"==e.settings.stream||e.settings.stream===!0)&&(t=e.api.response.metadata.response.streamUrl);var s={type:e.settings.playerType,mode:e.PlayerApi.getRenderingMode(),inited:e.instances.length,isStream:e.settings.stream,streamUrl:t,mediaID:e.settings.mediaId?e.settings.mediaId:e.settings.externalId,statusMetaData:e.api.response.metadata&&e.api.response.metadata.requestStatus?e.api.response.metadata.requestStatus:!1,statusKeyword:e.api.response.keywords&&e.api.response.keywords.requestStatus?e.api.response.keywords.requestStatus:!1,statusTranscript:e.api.response.transcript&&e.api.response.transcript.requestStatus?e.api.response.transcript.requestStatus:!1,statusTranscriptFileStatus:e.api.response.transcript&&e.api.response.transcript.fileStatus?e.api.response.transcript.fileStatus:!1,statusComments:e.api.response.comments&&e.api.response.comments.requestStatus?e.api.response.comments.requestStatus:!1,browserAppVersion:navigator.appVersion,browserUserAgent:navigator.userAgent,browserPlatform:navigator.platform,browserUserLanguage:navigator.userLanguage,url:window.location.href};"undefined"!=typeof _LTracker&&_LTracker.push(s);var a=e.helper.find(".vbs-logger");if(a.length>0)a.remove();else{e.helper.find(".vbs-record-player").after(e.templates.parse("loggerBlock",{response:JSON.stringify(s)}));var r=e.helper.find(".vbs-logger textarea");r.bind("focus",function(){this.select()})}console.log(s)},replaceAndTrim:function(e){return e.replace(/<br\s*[\/]?>/gi,"").replace(/\n/gi,"").trim()},replaceN:function(e){return e.replace(/\\n/g,"<br>").replace(/\n/g,"<br>")},replaceTrimAndLower:function(e){return e.replace(/"/g,"").toLowerCase().trim()},collapseNewsBlock:function(){var s=t("#"+e.settings.newsBlock);if(s.length>0&&e.settings.toggleBlocks&&e.settings.toggleNewsBlock){var a=s.find(".vbs-section-body");s.find(".vbs-section-title").addClass("vbs-hidden").attr("data-title","Show News"),s.find(".vbs-news-words-wrapper").hide(),a.slideUp()}},expandNewsBlock:function(){var s=t("#"+e.settings.newsBlock);if(s.length>0&&e.settings.toggleBlocks&&e.settings.toggleNewsBlock){var a=s.find(".vbs-section-body");s.find(".vbs-section-title").removeClass("vbs-hidden").attr("data-title","Hide News"),s.find(".vbs-news-words-wrapper").show(),a.slideDown()}},updateQuotesVisibility:function(){if(e.settings.vbsButtons.unquotes){var t=e.helper.find(".vbs-search-form"),s=e.helper.getSearchWordsArray(),a=s.filter(function(e){return 0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1});a.length>0?t.addClass("vbs-quoted"):t.removeClass("vbs-quoted")}},removeQuotes:function(){var s=e.helper.getSearchWordsArray(),a=[];s.forEach(function(e){if(0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1){e=e.replace(/"/g,"");var t=e.split(" ");t.forEach(function(e){a.push(e)})}else a.push(e)});var r=a.join(" ");e.helper.find("#vbs-voice_search_txt").val(r).data("data-val",r),t("#vbs-search-form").submit()},clearIntervals:function(){clearInterval(e.data.waiterSave),e.data.waiterSave=null,e.instances.length>0&&e.instances[e.current_instance]&&e.instances[e.current_instance].player&&(clearInterval(e.instances[e.current_instance].player.find_player_interval),e.instances[e.current_instance].player.find_player_interval=null),clearInterval(e.events.time),e.events.time=null,clearInterval(e.data.waiter),e.data.waiter=null,clearInterval(e.data.metadataWaiter),e.data.metadataWaiter=null},isIe:function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")?parseInt(e.split("msie")[1]):!1},isRetina:function(){var e="(-webkit-min-device-pixel-ratio: 1.5),            (min--moz-device-pixel-ratio: 1.5),            (-o-min-device-pixel-ratio: 3/2),            (min-resolution: 1.5dppx)";return window.devicePixelRatio>1?!0:window.matchMedia&&window.matchMedia(e).matches?!0:!1},isMobile:function(){if(e.data.isMobile)return e.data.isMobile;var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),e.data.isMobile=t,t},is_iDevice:function(){var e=!1;return function(t){/ip(hone|od|ad)/i.test(t)&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},renderMobile:function(){t("body").addClass("vbs-mobile"),e.helper.isRetina()&&t("body").addClass("vbs-retina")},getMobileWidth:function(){var e=t(".vbs-content").width();return e},setOnTimeInterval:function(){e.events.time=setInterval(function(){e.events.time&&e.events.onTime()},250)},isMediaTypeEqualVideo:function(){var t=e.settings.mediaTypeOverride;if(t)return"video"===t;if(e.api.response){var s=e.api.response.metadata;return!(s&&s.response&&s.response.hasVideo===!1)}return!0},isApi2_0:function(){return"2.0"===e.settings.apiVersion},clearMessage:function(){e.settings.localSearch?(t(".vbs-message").remove(),t(".vbs-text-error-message").remove()):(t(".vbs-message").fadeOut(),t(".vbs-text-error-message").fadeOut())},showMessage:function(t,s){e.helper.clearMessage();var a=e.templates.parse("infoMessage",{errorText:t,mode:s});e.helper.appendMessage(a)},appendMessage:function(s){e.settings.searchBarOuter?t("#"+e.settings.searchBarBlock).before(s):t("#"+e.settings.keywordsBlock).before(s)},checkScrollForResize:function(e){var t=e.find(".vbs-transcript-wrapper");e.height()>t.height()?e.find(".ui-resizable-se,.ui-resizable-e").addClass("vbs-no-scroll"):e.find(".ui-resizable-se,.ui-resizable-e").removeClass("vbs-no-scroll")},setDeletedIdsInLocalStorage:function(){var t=e.helper.getDeletedIdsInLocalStorage();t.push(e.settings.mediaId),localStorage.setItem("vbs-deleted-ids",JSON.stringify(t))},getDeletedIdsInLocalStorage:function(){return JSON.parse(localStorage.getItem("vbs-deleted-ids"))||[]},clearUiForDeletedIds:function(){var s=e.helper.getDeletedIdsInLocalStorage(),a=s.filter(function(t){return t===e.settings.mediaId});a.length>0&&(t(".vbs-section-btns,.vbs-order-human-trans,.vbs-time").remove(),t(".vbs-record-player").hide(),e.helper.showMessage("No such media file!","error"),e.PlayerApi.destroy())},hasSpottedKeywordsInGroups:function(){for(var e=voiceBase.api.response.keywords,t=e.groups,s=!1,a=0;a<t.length;a++){var r=t[a];if(r.keywords.length>0){s=!0;break}}return s},showAutoGeneratedKeywords:function(){var t=e.helper.find(".vbs-keywords-wrapper");t.find(".vbs-keyword-message").remove();var s=t.find(".vbs-topics"),a=s.hasClass("vbs-no-visible-topics");s.removeClass("vbs-no-visible-topics").find(".vbs-hidden-topic").removeClass("vbs-hidden-topic"),a&&s.find("li").first().click()},hideAutoGeneratedKeywords:function(){var t=e.helper.find(".vbs-keywords-wrapper"),s=t.find(".vbs-topics");s.find("li:not(.group)").addClass("vbs-hidden-topic"),s.find("li").removeClass("vbs-active");var a=s.find(".group");if(a.length>0)a.first().click();else if(t.find(".vbs-keywords-list-tab ul").removeClass("vbs-active"),s.addClass("vbs-no-visible-topics"),0===t.find(".vbs-keyword-message").length){var r=e.templates.parse("infoMessage",{errorText:"None of the specified keywords or phrases were spotted for this media file",mode:"error"}),n='<div class="vbs-keyword-message">'+r+"</div>";t.prepend(n)}}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.methods={init:function(t){e.reSettings(t),e.init(e.settings.playerId),e.view.init(this)},ready:function(){e.settings.ready.apply(this)},favorite:function(t){return t?e.helper.find(".vbs-star-btn").addClass("vbs-active").attr("data-tile","Remove from Favorites"):e.helper.find(".vbs-star-btn").removeClass("vbs-active").attr("data-tile","Add from Favorites"),t},favoriteToggle:function(){var t=e.helper.find(".vbs-star-btn");return t.toggleClass("vbs-active"),t.hasClass("vbs-active")},isFavorite:function(){return e.helper.find(".vbs-star-btn").hasClass("vbs-active")},getPosition:function(){return Math.round(e.PlayerApi.getPosition())},getSearchString:function(){return e.helper.find("#vbs-voice_search_txt").val()},getSharePositionUrl:function(){var t={};return t.vbt=Math.round(e.PlayerApi.getPosition()),e.helper.getNewUrl(t)},getShareSearchStringUrl:function(){var t={};return t.vbs=encodeURI(e.helper.find("#vbs-voice_search_txt").val()),e.helper.getNewUrl(t)},getShareFlag:function(){return e.helper.find('.vbs-share-radio-row input[name="share-opt"]:checked').val()},search:function(t){return e.helper.find("#vbs-voice_search_txt").val(t),e.helper.find("#vbs-search-form").submit(),t},position:function(t){return e.PlayerApi.seek(t),t},destroy:function(){e.helper.clearIntervals(),e.PlayerApi.destroy(),t(this).remove(),t(".vbs-content").remove()},addCustomMarkers:function(t){e.data.customMarkers=t},showCustomMarkers:function(){e.view.showCustomMarkers()},hideCustomMarkers:function(){e.view.hideCustomMarkers()},nextCustomMarkers:function(){var t=e.helper.find(".vbs-custom-markers");e.helper.moveToNextMarker(t)},prevCustomMarkers:function(){var t=e.helper.find(".vbs-custom-markers");e.helper.moveToPrevMarker(t)},addHighlightTranscript:function(t){e.data.highlightSnippets=t},showHighlightTranscript:function(){e.helper.manageHighlightSnippets(!0)},hideHighlightTranscript:function(){e.helper.manageHighlightSnippets(!1)},hasSpottedKeywordsInGroups:function(){return e.helper.hasSpottedKeywordsInGroups()},showAutoGeneratedKeywords:function(){e.helper.showAutoGeneratedKeywords()},hideAutoGeneratedKeywords:function(){e.helper.hideAutoGeneratedKeywords()}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.Player=function(t,s){var a=this;a.instance=t;var r=e.settings.playerType;r=r.toLowerCase().replace(/^\s+|\s+$/,""),a.player_type=r,a.instance.player_ready=!1,a.find_player_interval=setInterval(function(){if(a.find_player_interval)try{a.interface=new e.interface[r](s,a.instance),clearInterval(a.find_player_interval),a.find_player_interval=null,e.helper.setOnTimeInterval()}catch(t){console.log(t)}},250)},e.interface={youtube:function(t,s){var a=this;if(a.instance=s,document.getElementById(t)&&"iframe"==document.getElementById(t).tagName.toLowerCase()){if("undefined"==typeof YT||"undefined"==typeof YT.Player)throw"not_ready";if(!YT.loaded)throw"not_ready";if(a.instance.ytplayerloaded)return!1;a.youtube_player=new YT.Player(t),a.instance.ytplayerloaded=!0}else a.youtube_player=window.document[t];a.play=function(){a.youtube_player.playVideo()},a.pause=function(){a.youtube_player.pauseVideo()},a.play_state=function(){try{var e=a.youtube_player.getPlayerState();return 1==parseInt(e)||5==parseInt(e)?"PLAYING":"PAUSED"}catch(t){return"PAUSED"}},a.position=function(){try{return a.youtube_player.getCurrentTime()+.07}catch(e){return 0}},a.duration=function(){return a.youtube_player?parseInt(a.youtube_player.getDuration()+.5):!1},a.seek=function(e){e=parseInt(e,10),a.youtube_player.seekTo(e),a.play()},a.get_volume=function(){return a.youtube_player?a.youtube_player.getVolume():!1},a.set_volume=function(e){a.youtube_player.setVolume(e)},a.get_buffer=function(){return a.youtube_player&&a.youtube_player.getVideoBytesLoaded?100*a.youtube_player.getVideoBytesLoaded()/a.youtube_player.getVideoBytesTotal():!1},a.destroy=function(){},window.onYouTubePlayerReady=function(){a.instance.player_ready||(a.instance.player_ready=!0,e.settings.localApp&&(YSP.api.init("ytplayer"),YSP.api.getLanguages(function(t){e.data.localData.languages=t.languages,e.view.initApi()})))}},jwplayer:function(s,a){var r=this;if(r.instance=a,"undefined"==typeof jwplayer||!jwplayer(s)||!jwplayer(s).play)throw"not_ready";
r.jw_player=jwplayer(s),r.jw_player.onReady(function(){i()}),r.jw_player.onError(function(s){t(".vbs-text-error-message").remove();var a=s.message;"Error loading media: File could not be played"===a&&e.helper.is_iDevice()&&(a="This media file cannot be played on your current device and operating system. Please try on a different device or upgrade to a supported version of iOS 8.");var r=e.templates.parse("textErrorMessage",{errorText:a});t("#"+e.settings.controlsBlock).after(r)});var n=function(){r.play=function(){r.jw_player.play()},r.pause=function(){r.jw_player.pause()},r.play_state=function(){return"PLAYING"==r.jw_player.getState()?"PLAYING":"PAUSED"},r.position=function(){return r.jw_player.getPosition()},r.duration=function(){return r.jw_player.getDuration()},r.seek=function(e){r.jw_player.seek(e)},r.get_volume=function(){return r.jw_player.getVolume()},r.set_volume=function(e){return r.jw_player.setVolume(e)},r.get_buffer=function(){return r.jw_player.getBuffer()},r.get_rendering_mode=function(){return r.jw_player.getRenderingMode()},r.load_file=function(t){e.settings.hasPlaylist?r.jw_player.load(t):r.jw_player.load([{file:t}])},r.getWidth=function(){var e=r.jw_player.getWidth();if("100%"===e){var s=r.jw_player.getContainer();e=t(s).width()}return e},r.getHeight=function(){var e=r.jw_player.getHeight();if("100%"===e){var s=r.jw_player.getContainer();e=t(s).height()}return e},r.setSize=function(e,t){(null===e||"undefined"==typeof e)&&(e=r.jw_player.getWidth()),(null===t||"undefined"==typeof t)&&(t=r.jw_player.getHeight()),r.jw_player.resize(e,t)};var s=null;r.initPluginFromPlaylistItem=function(){var a=r.getCurrentPlaylistItem(),n=e.PlayerApi.getPlaylistItemId(a);if(n.id!==s){s=n.id,delete e.settings.mediaId,delete e.settings.externalId,e.helper.clearIntervals(),n.isMediaid?e.settings.mediaId=a.vbs_mediaid:e.settings.externalId=a.vbs_externalid,e.helper.setOnTimeInterval(),e.view.initApi();var i=r.jw_player.getPlaylistIndex();t(".vbs-playlist-item").removeClass("active"),t(".vbs-selected-playlist-item").find(".vbs-item-name").text(a.title);var o=t("[data-playlist-item-index="+i+"]");o.addClass("active"),o[0].scrollIntoView()}},r.setPlaylistItem=function(e){e=parseInt(e),r.jw_player.playlistItem(e)},r.getPlaylistItemIndex=function(){return r.jw_player.getPlaylistIndex()},r.onChangePlayListItem=function(){r.jw_player.onPlaylistItem(function(){r.initPluginFromPlaylistItem()})},r.getCurrentPlaylistItem=function(){return r.jw_player.getPlaylistItem()},r.getPlaylist=function(){return r.jw_player.getPlaylist()},r.renderPlaylist=function(){var s=r.getPlaylist();t("#"+e.settings.controlsBlock).before(e.templates.get("playlist"));var a="";s.forEach(function(t,s){a+=e.templates.parse("playlist-item",{title:t.title,index:s})}),t(".vbs-playlist-dropdown").append(a)},r.destroy=function(){r.jw_player.getRenderingMode()&&r.jw_player.remove()}},i=function(){if(r.instance.player_ready=!0,n(),e.helper.isMobile()){var s=e.PlayerApi.getMobilePlayerSize();r.setSize(s.mobile_width,s.mobile_height),t("#"+e.settings.mediaBlock).css("width",s.mobile_width)}e.settings.hasPlaylist&&(e.settings.nativePlaylist||r.renderPlaylist(),r.onChangePlayListItem())};n(),r.instance.player_ready=!0},kaltura:function(s,a){var r=this;if(r.instance=a,r.kaltura_player=t("#"+s).get(0),r.kaltura_states={buffered:0,bytes_total:0,player_state:!1,playhead_time:0,volume:1,ready:!1},window.bytesTotalChangeHandler=function(e){r.kaltura_states.bytes_total=e},window.html5_kaltura_play_handler=function(){console.log("Kaltura is PLAYING!"),r.kaltura_states.player_state=!0},window.html5_kaltura_pause_handler=function(){console.log("Kaltura is PAUSED!"),r.kaltura_states.player_state=!1},window.html5_kaltura_update_playhead=function(e){r.kaltura_states.playhead_time=parseFloat(e)},window.volumeChangedHandler=function(e){r.kaltura_states.volume=e.newVolume},window.bytesDownloadedChangeHandler=function(e){r.kaltura_states.buffered=e.newValue},window.playerSeekEndHandler=function(){r.play()},r.player_state=!1,r.playhead_time=0,r.player_id=s,r.play=function(){r.kaltura_player.sendNotification("doPlay")},r.pause=function(){r.kaltura_player.sendNotification("doPause")},r.play_state=function(){return r.kaltura_states.player_state?"PLAYING":"PAUSED"},r.position=function(){return r.kaltura_states.playhead_time},r.duration=function(){return r.kaltura_player.evaluate("{mediaProxy.entry.msDuration}")/1e3},r.video_id=function(){return r.kaltura_player.evaluate("{mediaProxy.entry.id}")},r.seek=function(e){r.kaltura_player.sendNotification("doPlay"),setTimeout(function(){r.kaltura_player.sendNotification("doSeek",parseFloat(parseInt(e)))},0)},r.play_file=function(e){if(e.video_id!=this.video_id()){var t=e.m||0;r.kaltura_player.sendNotification("changeMedia",{entryId:e.video_id,seekFromStart:t.toString()}),r.timer=setInterval(function(){return"PLAYING"==r.play_state()&&r.video_id()==e.video_id?(clearInterval(r.timer),!0):void r.play()},200)}else this.seek(e.m)},r.get_buffer=function(){return r.kaltura_states.bytes_total&&r.kaltura_states.buffered?100*r.kaltura_states.buffered/r.kaltura_states.bytes_total:0},r.get_volume=function(){return 100*r.kaltura_states.volume},r.set_volume=function(e){r.kaltura_player.sendNotification("changeVolume",e/100)},r.getPlayerIframe=function(){return t("#"+r.player_id+"_ifp").contents()},r.destroy=function(){},window.kdpReady=function(){if(r.kaltura_states.ready=!0,r.instance.player_ready=!0,console.log("Kaltura is ready!"),r.kaltura_player.addJsListener("volumeChanged","volumeChangedHandler"),r.kaltura_player.addJsListener("playerPlayed","html5_kaltura_play_handler"),r.kaltura_player.addJsListener("playerPaused","html5_kaltura_pause_handler"),r.kaltura_player.addJsListener("playerPlayEnd","html5_kaltura_pause_handler"),r.kaltura_player.addJsListener("playerUpdatePlayhead","html5_kaltura_update_playhead"),r.kaltura_player.addJsListener("bytesTotalChange","bytesTotalChangeHandler"),r.kaltura_player.addJsListener("bytesDownloadedChange","bytesDownloadedChangeHandler"),r.kaltura_player.addJsListener("playerSeekEnd","playerSeekEndHandler"),"OBJECT"==r.kaltura_player.tagName&&r.play(),e.settings.markersInNativeTimeline&&e.settings.cssPathForPlayerFrame){var t=document.createElement("link");t.href=e.settings.cssPathForPlayerFrame,t.rel="stylesheet",t.type="text/css";var s=r.getPlayerIframe();s[0].body.appendChild(t)}},window.jsCallbackReady=function(){},!r.kaltura_player||!r.kaltura_player.addJsListener)throw"not_ready";window.kdpReady()},flowplayer:function(s,a){var r=this;if(r.instance=a,"undefined"==typeof flowplayer)throw"not_ready";r.flow_player=t("#"+s);var n=flowplayer(r.flow_player);r.play=function(){n.play()},r.pause=function(){return n.pause()},r.play_state=function(){var e=n.paused;return e?"PAUSED":"PLAYING"},r.position=function(){return n.video?n.video.time:0},r.duration=function(){return n.video?n.video.duration:0},r.seek=function(e){n.seek(e),r.play()},r.get_buffer=function(){return n.video?100*n.video.buffer/r.duration():0},r.flow_player.bind("volume",function(){var t=r.get_volume();e.PlayerApi.setUiVolume(t)}),r.get_volume=function(){return 100*n.volumeLevel},r.set_volume=function(e){n.volume(e/100)},r.destroy=function(){}},sublime:function(e,s){var a=this;if(a.instance=s,"undefined"==typeof sublime||"undefined"==typeof sublime.player)throw"not_ready";if("undefined"==typeof sublime.player(e))throw"not_ready";a.player_id=e,a.default_size={width:t("#"+a.player_id).width(),height:t("#"+a.player_id).height()},a.player_state=!1;var r=sublime.player(a.player_id);r.on({start:function(){a.player_state="PLAYING"},end:function(){a.player_state="PAUSED"},stop:function(){a.player_state="PAUSED"},pause:function(){a.player_state="PAUSED"},play:function(){a.player_state="PLAYING"}}),a.play=function(){r.play()},a.pause=function(){r.pause()},a.play_state=function(){return a.player_state},a.position=function(){return r.playbackTime()},a.duration=function(){return r.duration()},a.get_buffer=function(){return 0},a.seek=function(e){r.seekTo(e),a.play()},a.setSize=function(e,t){r.setSize(e,t)},a.setDefaultSize=function(){r.setSize(a.default_size.width,a.default_size.height)},a.destroy=function(){}},video_js:function(s,a){var r=this;if(r.instance=a,r.player_id=s,"undefined"==typeof _V_)throw"not_ready";var n=_V_(s);r.instance.player_ready=!0,r.play=function(){n.play()},r.pause=function(){n.pause()},r.play_state=function(){return n.paused()?"PAUSED":"PLAYING"},r.position=function(){return n.currentTime()},r.duration=function(){return n.duration()},r.seek=function(e){n.currentTime(e),r.play()},r.get_buffer=function(){return 100*n.bufferedPercent()||0},n.on("volumechange",function(){var t=r.get_volume();e.PlayerApi.setUiVolume(t)}),r.get_volume=function(){return 100*n.volume()},r.set_volume=function(e){n.volume(e/100)},r.destroy=function(){t("#"+r.player_id).length>0&&n.dispose()}},jplayer:function(s,a){var r=this;r.instance=a,r.player_id=s;var n=t("#"+r.player_id);r.default_size={width:t("#"+r.player_id).width(),height:t("#"+r.player_id).height()},r.play=function(){n.jPlayer("play")},r.pause=function(){n.jPlayer("pause")},r.play_state=function(){return n.data("jPlayer").status.paused?"PAUSED":"PLAYING"},r.position=function(){return n.data("jPlayer").status.currentTime||0},r.duration=function(){return n.data("jPlayer").status.duration||0},r.seek=function(e){e=parseInt(e),n.jPlayer("play",e)},r.get_buffer=function(){return 0},r.get_volume=function(){return 100*n.data("jPlayer").options.volume||0},r.set_volume=function(e){t("#jplayer").jPlayer("volume",e/100)},r.isVideo=function(){return n.data("jPlayer").status.video},r.getGui=function(){return t(n.data("jPlayer").ancestorJq)},r.initEvents=function(){n.bind(t.jPlayer.event.volumechange,function(){var t=r.get_volume();e.PlayerApi.setUiVolume(t)})},r.setSize=function(e,t){n.jPlayer({size:{width:e,height:t}})},r.setDefaultSize=function(){r.setSize(r.default_size.width,r.default_size.height)},r.destroy=function(){};var i=function(){var e=r.getGui();r.isVideo()||e.hide(),r.initEvents()};i()}},e.PlayerApi={startPlayer:function(t){e.helper.showLoader(),window.setTimeout(function(){e.PlayerApi.cseek(t)},200),window.setTimeout(function(){e.data.movelistner=!1,e.data.dragging=!1},300)},cseek:function(t){e.instances[e.current_instance].player.interface.seek(t)},seek:function(t){e.PlayerApi.startPlayer(t)},play:function(){e.instances[e.current_instance].player.interface.play()},pause:function(){e.instances[e.current_instance].player.interface.pause()},getOffset:function(t){var s=e.helper.find(".vbs-record-timeline-wrap");return t*s.width()/e.data.duration},getDuration:function(){return e.instances[e.current_instance].player.interface.duration()},getPosition:function(){return e.instances[e.current_instance].player.interface.position()},getStatus:function(){return e.instances[e.current_instance].player.interface.play_state()},getVolume:function(){return e.instances[e.current_instance].player.interface.get_volume()},setVolume:function(t){return e.instances[e.current_instance].player.interface.set_volume(t)},setUiVolume:function(t){e.helper.find(".vbs-volume-slider-full").css("height",t+"%"),e.helper.find(".vbs-volume-slider-handler").css("bottom",t+"%")},getBuffer:function(){return e.instances[e.current_instance].player.interface.get_buffer()},getRenderingMode:function(){return e.instances[e.current_instance].player.interface.get_rendering_mode()},loadFile:function(t){return e.instances[e.current_instance].player.interface.load_file(t)},isPlayerReady:function(){return e.instances[e.current_instance].player_ready},getMobilePlayerSize:function(){var t=e.PlayerApi.getPlayerWidth(),s=e.PlayerApi.getPlayerHeight(),a=t&&s?t/s:0,r=e.helper.getMobileWidth(),n=r/a;return n=n>screen.availHeight?screen.availHeight:n,{mobile_width:r,mobile_height:n}},getPlayerWidth:function(){return e.instances[e.current_instance].player.interface.getWidth()},getPlayerHeight:function(){return e.instances[e.current_instance].player.interface.getHeight()},setSizePlayer:function(t,s){var a=e.instances[e.current_instance].player.interface;return a&&a.setSize?a.setSize(t,s):null},setDefaultSizePlayer:function(){return e.instances[e.current_instance].player.interface.setDefaultSize()},hidePlayer:function(){if("kaltura"!=e.settings.playerType)var s=setInterval(function(){e.instances.length&&(clearTimeout(s),e.helper.findc(".vbs-player-wrapper").css({height:0}),"jwplayer"===e.settings.playerType&&(e.PlayerApi.setSizePlayer(0,0),t("#"+e.settings.playerId).css({opacity:0})))},100)},setPlaylistItem:function(t){return e.instances[e.current_instance].player.interface.setPlaylistItem(t)},getPlaylistItemIndex:function(){return e.instances[e.current_instance].player.interface.getPlaylistItemIndex()},getPlaylist:function(){return e.instances[e.current_instance].player.interface.getPlaylist()},getCurrentPlaylistItem:function(){return e.instances[e.current_instance].player.interface.getCurrentPlaylistItem()},getPlaylistItemId:function(e){var t,s=!1;return e.vbs_mediaid?(t=e.vbs_mediaid,s=!0):e.vbs_externalid&&(t=e.vbs_externalid),{id:t,isMediaid:s}},getStreamUrl:function(t){var s="";return"html5"!=e.PlayerApi.getRenderingMode()&&"rtmp"==e.settings.stream?s=t.rtmpUrl+""+t.rtmpFile:("http"==e.settings.stream||e.settings.stream===!0)&&(s=t.streamUrl),s},getPlayerIframe:function(){return e.instances[e.current_instance].player.interface.getPlayerIframe()},destroy:function(){e.instances[e.current_instance]&&e.instances[e.current_instance].player&&e.instances[e.current_instance].player.interface&&e.instances[e.current_instance].player.interface.destroy&&e.instances[e.current_instance].player.interface.destroy()}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return jQuery.extend(jQuery.expr[":"],{speakertime:function(e,s,a){var r=parseFloat(t(e).attr("s")),n=parseFloat(t(e).attr("e")),i=a[3].split(/\s?,\s?/),o=parseFloat(i[0]);return!isNaN(r)&&!isNaN(n)&&!isNaN(o)&&n>=o&&o>=r}}),e.speakers={inSpeakers:function(t){for(var s in e.data.speakers)if(e.data.speakers[s].toLowerCase()==t.toLowerCase())return!0;return!1},getSpeakerNameByKey:function(t){return"undefined"!=typeof e.data.speakers[t]?e.data.speakers[t]:""},getSpeakerKeyByName:function(t){for(var s in e.data.speakers)if(e.data.speakers[s].toLowerCase()==t.toLowerCase())return s;return""},setSpeakerName:function(t,s){for(var a in e.data.speakers)if(a===t)return e.data.speakers[a]=s,!0;return!1},addSpeakerKey:function(t){if(t&&!e.speakers.inSpeakers(t)&&">>"!=t){var s=Object.keys(e.data.speakers).length+1;e.data.speakers["vbs-sp"+s+"o"]=t}},filterResultForSpeaker:function(t){if("undefined"==typeof e.settings.filterSpeaker||"all"==e.settings.filterSpeaker)return!0;for(var s in e.data.allSpeakers)if(1e3*t>parseFloat(e.data.allSpeakers[s].t)&&("undefined"!=typeof e.data.allSpeakers[parseInt(s)+1]&&1e3*t<=parseFloat(e.data.allSpeakers[parseInt(s)+1].t)||"undefined"==typeof e.data.allSpeakers[parseInt(s)+1]&&1e3*t<=1e3*e.data.duration)&&e.speakers.getSpeakerKeyByName(e.data.allSpeakers[parseInt(s)].s)==e.settings.filterSpeaker)return!0;return!1},filterSpeakersList:function(s){e.helper.find(".vbs-select-dropdown li").removeClass("vbs-disabled").each(function(){var e=t(this),a=e.attr("data-speaker");s.indexOf(a)<0&&"all"!=a&&e.addClass("vbs-disabled")})},parseSpeakersInCategory:function(t,s,a){for(var r in t.speakers){var n=e.helper.replaceAndTrim(t.speakers[r]);if(e.speakers.addSpeakerKey(n),!e.common.inArrayV(s,n)){var i=Object.keys(a).length+1;s.push(n),a.push("vbs-sp"+i+"o")}}var o=[];if("undefined"!=typeof t.speakers&&t.speakers.length)for(var l in t.speakers)o.push(e.speakers.getSpeakerKeyByName(e.helper.replaceAndTrim(t.speakers[l])));return o.join(),{isps:o,speakersName:s,speakersArray:a}},createSpeakerAttr:function(t){var s=e.helper.isTurn(t.m),a=e.helper.getClearWordFromTranscript(t.w),r=s?a:!1,n="";if(r){e.speakers.addSpeakerKey(r);var i=e.speakers.getSpeakerKeyByName(r);n='m="'+i+'"'}return n},speakerIsSpeaking:function(){var s=1e3*e.data.position,a=t(".vbs-speakers > div:speakertime("+s+")");if(a.length){var r=a.attr("cnum"),n=e.speakers.getSpeakerNameByKey(r);if("undefined"!=typeof n&&e.data.lspeaker!=n&&">>"!=n.trim()){e.data.lspeaker=n;var i=e.templates.parse("speakerIsSpeaking",{speakerKey:r,speakerName:n});e.helper.find(".vbs-voice-name").html(i),e.helper.adjustMediaTime()}}else e.helper.find(".vbs-voice-name").html("")},speakersWidget:function(){var s=[],a=1,r=e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper");r.find("span.w[m]").each(function(){var r=t(this),n={};n.s=e.speakers.getSpeakerNameByKey(r.attr("m")),n.t=r.attr("t"),s.push(n);var i,o="";e.settings.turnTimes&&(">>"==n.s.trim()?(i=a%2?"vbs-sp1":"vbs-sp2",a++):i=e.speakers.getSpeakerKeyByName(n.s),o+=e.templates.parse("speakerTranscriptLabel",{spClass:i,speakerName:n.s,speakerTime:e.helper.parseTime(n.t/1e3)})),jQuery(o).insertBefore(this)}),a>1&&r.addClass("vbs-machine"),a=1,e.data.allSpeakers=s,s.length&&(e.speakers.renderSpeakersInTimeline(),a>1&&($speakers.addClass("vbs-machine"),e.helper.find(".vbs-media-block .vbs-section-title, .vbs-time-name-wrapper-narrow").addClass("vbs-machine")))},renderSpeakersInTimeline:function(){var t=e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper"),s=e.data.allSpeakers;if(s.length){e.settings.turnTimes&&t.addClass("vbs-turntimes");var a=e.helper.find(".vbs-record-timeline-wrap").width()-1,r="";for(var n in s){s[n].s=e.helper.replaceAndTrim(s[n].s);var i,o=s[n].t/1e3*a/e.data.duration;i="undefined"!=typeof s[parseFloat(n)+1]?(s[parseFloat(n)+1].t-s[parseFloat(n)].t)/1e3*a/e.data.duration:(e.data.duration-s[parseFloat(n)].t/1e3)*a/e.data.duration;var l;l="undefined"!=typeof s[parseFloat(n)+1]?parseFloat(s[parseFloat(n)+1].t):1e3*e.data.duration;var d;">>"==s[n].s.trim()?(d=snn%2?"vbs-sp1":"vbs-sp2",snn++):d=e.speakers.getSpeakerKeyByName(s[n].s),r+=" "+e.templates.parse("speakersTemplate",{position:o,width:i,s:parseFloat(s[parseFloat(n)].t),e:l,speaker:s[n].s,colorclass:d})}var c=e.helper.find(".vbs-speakers");c.html(r)}},speakerFilterWidget:function(t){var s='<li data-speaker="all">All Speakers</li>';for(var a in t)s+='<li data-speaker="'+a+'">'+t[a]+"</li>";if(e.helper.find(".vbs-search-form").removeClass("vbs-no-speaker"),!e.settings.searchBarOuter){var r=e.helper.findc("#"+e.settings.keywordsBlock),n=e.helper.find(".vbs-keywords-wrapper");r.width()<e.settings.mediumResponsiveWithSpeakers&&r.width()>=e.settings.minResponsive&&(r.addClass("less-600px"),n.height(n.height()-55))}e.helper.find(".vbs-select-speaker-wrapper .vbs-select-dropdown").html(s)},resizeSpeakers:function(){e.speakers.renderSpeakersInTimeline()},createInsertSpeakerDialog:function(s){t(".vbs-insert-speaker-popup").remove();var a=s.parents(".vbs-vbcmenu"),r=t(".vbs-edit-mode-wrapper");r.append(e.templates.parse("insertSpeakerPopup"));for(var n=t(".vbs-select-insert-speaker-wrapper"),i=n.find(".vbs-select-dropdown"),o=e.speakers.getSpeakersFromEditor(),l=e.templates.get("firstSpeakerItem"),d=0;d<o.length;d++){var c=o[d],p=e.speakers.getSpeakerNameByKey(c);l+=e.templates.parse("speakerItem",{speaker_name:p,speaker_key:c})}i.html(l),t(".vbs-insert-speaker-popup").css({top:a.offset().top+r.scrollTop(),left:a.offset().left}).fadeIn(function(){t(".vbs-insert-speaker-input").focus()})},selectSpeakerInInsertDialog:function(s){s.parents(".vbs-select-dropdown").fadeOut("fast");var a=t(".vbs-select-insert-speaker"),r=a.find(".vbs-speaker-selected"),n=t(".vbs-speaker-input-wrapper"),i=s.attr("data-speaker-key");if(i){var o=e.speakers.getSpeakerNameByKey(i);a.removeClass("vbs-new-speaker").attr("data-speaker-key",i),n.hide(),r.html(o)}else{var l=n.find(".vbs-insert-speaker-input");n.show(),a.addClass("vbs-new-speaker"),r.html("Insert new speaker"),setTimeout(function(){l.focus()},0)}a.removeClass("vbs-s-show")},insertSpeakerToEditor:function(){var s,a,r=t(".vbs-edit-mode-wrapper").find(".vbs-menu-target"),n=t(r).attr("t"),i=t(".vbs-select-insert-speaker");if(i.hasClass("vbs-new-speaker")?(s=t(".vbs-insert-speaker-input").val(),e.speakers.addSpeakerKey(s),a=e.speakers.getSpeakerKeyByName(s)):(a=i.attr("data-speaker-key"),s=e.speakers.getSpeakerNameByKey(a)),!r.prev().hasClass("vbs-edit-speaker")&&a){var o=e.templates.parse("insertSpeakerText",{speakerKey:a,speakerTime:n,speakerName:s});r.first().before(o)}},getSpeakersFromEditor:function(){var e=[],s=t(".vbs-edit-speaker");return s.each(function(){var s=t(this).attr("m"),a=e.filter(function(e){return e===s});a.length||e.push(s)}),e},findSpeakerElementsInEditor:function(e){var s=t(".vbs-edit-mode-wrapper"),a=[];return s.find(".vbs-edit-speaker").each(function(){var s=t(this).attr("m");e===s&&a.push(t(this))}),a},createRenameSpeakerDialog:function(s){t(".vbs-rename-speaker-popup").remove(),e.speakers.enableRenameAllSpeakersInEditor();var a=s.parents(".vbs-vbcmenu"),r=s.attr("data-speaker-key"),n=e.speakers.getSpeakerNameByKey(r),i=t(".vbs-edit-mode-wrapper");i.append(e.templates.parse("renameSpeakerPopup",{current_speaker_key:r,current_speaker_name:n})),e.speakers.disableRenameSpeakersInEditor(r),setTimeout(function(){t("#vbs-rename_speaker_input").focus()},0),t(".vbs-rename-speaker-popup").css({top:a.offset().top+i.scrollTop(),left:a.offset().left}).fadeIn()},renameSpeaker:function(){var s=(t(".vbs-edit-mode-wrapper"),t("#vbs-rename_speaker_input").val()),a=t("#vbs-rename_speaker_input").attr("data-old-speaker-key");e.speakers.inSpeakers(s)||e.speakers.addSpeakerKey(s);var r=e.speakers.getSpeakerKeyByName(s),n=e.speakers.findSpeakerElementsInEditor(a);n.forEach(function(e){e.text(s+":").prepend("<br><br>").attr("m",r)}),e.speakers.clearEditorSpeakers(),e.speakers.enableRenameAllSpeakersInEditor(a)},renameSpeakerFromEditor:function(t){var s=t.attr("m"),a=e.helper.getClearWordFromTranscript(t.text());-1!=a.lastIndexOf(":")&&(a=a.substring(0,a.lastIndexOf(":"))),e.speakers.inSpeakers(a)||e.speakers.addSpeakerKey(a),s=e.speakers.getSpeakerKeyByName(a),t.attr("m",s),e.speakers.clearEditorSpeakers()},clearEditorSpeakers:function(){for(var s=t(".vbs-edit-mode-wrapper"),a=Object.keys(voiceBase.data.speakers),r=0;r<a.length;r++){var n=s.find('span.w[m="'+a[r]+'"]');0===n.length&&(e.data.speakers[a[r]]="")}},disableRenameSpeakersInEditor:function(t){var s=e.speakers.findSpeakerElementsInEditor(t);s.forEach(function(e){e.attr("contenteditable","false")})},enableRenameAllSpeakersInEditor:function(){var e=t(".vbs-edit-speaker");e.each(function(){t(this).attr("contenteditable","true")})}},e}(voiceBase,jQuery),voiceBase=function(e){"use strict";var t=function(){var t="";return e.settings.tabView&&(t+=" vbs-tab "),t};return e.templates={parse:function(e,t){var s=this.get(e);for(var a in t){var r=new RegExp("{{\\s*"+a+"\\s*}}","gi");s=s.replace(r,t[a])}return s},get:function(s){var a="";switch(s){case"vbs-media":return a='<div class="vbs-media-block">\n                <div class="vbs-section-header">\n                    <div class="vbs-section-title">\n                        <span class="vbs-section-name vbs-sna">audio</span>\n                        <span class="vbs-section-name vbs-snv"></span>\n                        <span class="vbs-time"><span class="vbs-ctime">00:00:00</span> / <span class="vbs-ftime">00:00:00</span></span>\n                        <span class="vbs-voice-name"></span>\n                    </div>\n                    <div class="vbs-section-btns"><ul class="vbs-clearfix">',a+=e.settings.vbsButtons.downloadMedia?'<li><a href="#" class="vbs-download-audio-btn" format="pdf" data-title="Download Recording"></a></li>':"",a+=e.settings.vbsButtons.remove?'<li><a href="#" class="vbs-del-btn" data-title="Delete Recording"></a><div class="vbs-download-popup vbs-delete-popup vbs-popup"><div class="vbs-arrow"></div><h3>Are you sure you want to delete this recording?</h3><a href="#" class="vbs-red-btn">Delete</a><a href="#" class="vbs-blue-btn">Cancel</a></div></li>':"",a+=e.settings.vbsButtons.favorite?'<li><a href="#" class="vbs-star-btn"></a></li>':"",a+=e.settings.vbsButtons.help?'<li><a href="#" class="vbs-help-btn" data-title="Help"></a></li>':"",a+='</ul></div>\n                    <div class="clear-block"></div>\n                </div>\n                <div class="vbs-section-body"></div>\n            </div>';case"vbs-controls":var r=e.settings.vbsButtons.prev&&e.settings.vbsButtons.next?" vbs-3-left-btns":e.settings.vbsButtons.prev||e.settings.vbsButtons.next?" vbs-2-left-btns":" vbs-1-left-btns";return a='<div class="vbs-record-player'+r+'">\n                <div class="vbs-player-control">\n                    <a href="#" class="vbs-play-btn" data-title="Play"></a>',a+=e.settings.vbsButtons.prev?'<a href="javascript:void(0)" class="vbs-prev-btn" data-title="Back 15 Seconds"></a>':"",a+=e.settings.vbsButtons.next?'<a href="javascript:void(0)" class="vbs-next-action-btn vbs-next-notactive" data-title="Next Keyword Marker"></a>':"",a+='</div>\n                <div class="vbs-time-name-wrapper-narrow">\n                    <span class="vbs-time"><span class="vbs-ctime">00:00:00</span> / <span class="vbs-ftime">00:00:00</span></span> <br>\n                    <span class="vbs-voice-name"></span>\n                </div>\n                <div class="vbs-timeline">\n                    <div class="vbs-record-preview">\n                        <div class="vbs-record-timeline-wrap">\n                            <div class="">\n                                <div class="vbs-dragger"></div>\n                                <div class="vbs-record-timeline"></div>\n                                <div class="vbs-record-progress"></div>\n                                <div class="vbs-speakers"></div>\n                                <div class="vbs-player-slider"></div>\n                                <div class="vbs-record_buffer"></div>\n                                <div class="vbs-utterance-markers"></div>\n                            </div>\n                            <!--markers-->\n                            <div class="vbs-markers"></div>\n                            <div class="vbs-custom-markers"></div>\n                            <!-- / markers-->\n                            <div class="vbs-markers-hovers"></div>\n                            <div class="vbs-comments-wrapper-block"></div>\n                            <div class="vbs-record-disabler" style="width: 0%;"></div>\n                        </div>\n                    </div>\n                </div>',a+=e.settings.vbsButtons.share?'<div class="vbs-share-btn-wrapper"><a href="#" class="vbs-share-btn vbs-popup-btn" data-title="Share"></a></div>':"",e.helper.is_iDevice()||(a+='<div class="vbs-volume-toolbar">\n                            <a href="#" class="vbs-volume-btn" data-title="Volume"></a>\n                            <div class="vbs-volume-toolbar-block" style="display: none;">\n                                <div class="vbs-volume-slider">\n                                    <div class="vbs-volume-slider-bg"></div>\n                                    <div class="vbs-volume-slider-full"></div>\n                                    <div class="vbs-volume-slider-handler"></div>\n                                </div>\n                            </div>                        </div>'),a+="</div>";case"vbs-searchbar-outer":return a='<div id="vbs-searchbar-block"><div class="vbs-search-form vbs-no-speaker"><form action="#" id="vbs-search-form"><div class="vbs-widget-wrap"><div class="vbs-widget"><input name="get_voice_search" value="" size="20" id="vbs-voice_search_txt" class="vbs-formfields" type="text" placeholder="Search Keywords..." autocomplete=off><div id="vbs-search-string"><div class="vbs-marquee"><div class="vbs-search-word-widget"></div></div></div>',a+=e.settings.vbsButtons.pwrdb?'<span class="vbs-powered-by-label">Powered by VoiceBase</span>':"",a+='</div><a href="#" id="vbs-clear-string" title="Clear String"></a></div>',e.settings.vbsButtons.unquotes&&(a+='<a href="javascript:void(0)" class="vbs-unquote-btn">Unquoted</a>'),a+='<div class="vbs-search-btn" data-title="Search">   <button type="submit"></button></div></form></div></div>';case"vbs-keywords":a='<div class="vbs-keywords-block '+t()+'">\n                <div class="vbs-section-header">\n                    <div class="vbs-section-title" data-title="Hide Keywords">\n                        <span class="vbs-section-name">Keywords</span>\n                    </div>\n\n                    <div class="vbs-search-form vbs-no-speaker ',a+=e.settings.vbsButtons.evernote&&"undefined"!=typeof filepicker?"vbs-one-btn":"vbs-no-btns",a+='">',e.settings.searchBarOuter||(a+='<form action="#" id="vbs-search-form">\n                            <div class="vbs-widget-wrap">\n                                <div class="vbs-widget">\n                                    <input name="get_voice_search" value="" size="20" id="vbs-voice_search_txt" class="vbs-formfields" type="text" placeholder="Search Keywords..." autocomplete=off>\n                                    <div id="vbs-search-string">\n                                        <div class="vbs-marquee">\n                                            <div class="vbs-search-word-widget"></div>\n                                        </div>\n                                    </div>',a+=e.settings.vbsButtons.pwrdb?'<span class="vbs-powered-by-label">Powered by VoiceBase</span>':"",a+='</div>\n                             <a href="#" id="vbs-clear-string" title="Clear String"></a>\n                            </div>',e.settings.vbsButtons.unquotes&&(a+='<a href="javascript:void(0)" class="vbs-unquote-btn">Unquoted</a>'),a+='<div class="vbs-search-btn" data-title="Search">\n                                    <button type="submit"></button>\n                            </div>',a+="</form>"),a+='<div class="vbs-select-speaker-wrapper">\n                        <div class="vbs-select-speaker">Select speaker...</div>\n                        <ul class="vbs-select-dropdown"></ul>\n                    </div>',a+="</div>";var n="";return e.settings.vbsButtons.evernote&&"undefined"!=typeof filepicker&&(n+='<li><a href="#" class="vbs-evernote-btn" data-title="Send to Evernote"></a></li>'),n&&(a+='<div class="vbs-section-btns"><ul>',a+=n,a+="</ul></div>"),a+='<div class="clear-block"></div>\n                </div>\n                <!-- / section header-->\n\n                <div class="vbs-section-body">\n                    <div class="vbs-keywords-wrapper vbs-scroll" style="{{ styles }}">\n                        <div class="vbs-topics"></div>\n                        <div class="vbs-keywords-list-wrapper">\n                            <div class="vbs-keywords-list-tab"></div>\n                        </div>\n                        <div class="clear-block"></div>\n                    </div>',a+=e.settings.showMore?'<div class="vbs-more-btn"><a href="#">Show More...</a></div>':"",a+="\n                </div>\n            </div>";case"vbs-edit-trans-mode":var i='<div class="vbs-edit-mode-wrapper">\n                <div class="vbs-controls-wrapper">\n                    <div id="vbs-controls" class="vbs-controls-box">\n                        <div class="vbs-edition-btns vbs-clearfix">';return i+='<div class="vbs-save-exit-btns">\n                                <a href="#" class="vbs-save-btn vbs-save-edition-popup-trigger" id="vbs-save-edition-popup-trigger">Save & Re-sync</a>\n                                <a href="#" class="vbs-exit-btn vbs-edit-mode-exit">Exit</a>\n                            </div>\n                        </div>\n                        <div class="vbs-record-player vbs-3-left-btns">\n                            <div class="vbs-player-control">\n                                <a href="#" class="vbs-play-btn" data-title="Play"></a>\n                                <a href="#" class="vbs-prev-btn" data-title="Back 15 Seconds"></a>\n                                <a href="#" class="vbs-next-action-btn vbs-next-notactive" data-title="Next Keyword Marker"></a>\n                            </div>\n                            <div class="vbs-time-name-wrapper-narrow" style="opacity: 0;">\n                                <span class="vbs-time">\n                                    <span class="vbs-ctime">00:00:00</span> / <span class="vbs-ftime">00:04:03</span>\n                                </span> <br>\n                                <span class="vbs-voice-name"></span>\n                            </div>\n                                <div class="vbs-timeline">\n                                    <div class="vbs-record-preview">\n                                        <div class="vbs-record-timeline-wrap">\n                                            <div class="">\n                                                <div class="vbs-dragger"></div>\n                                                <div class="vbs-record-timeline"></div>\n                                                <div class="vbs-record-progress" style="width: 0%;"></div>\n                                                <div class="vbs-speakers"></div>\n                                                <div class="vbs-player-slider" style="left: 0%;"></div>\n                                                <div class="vbs-record_buffer"></div>\n                                            </div>\n                                            <!--markers-->  \n                                            <div class="vbs-markers"></div>\n                                            <!-- / markers-->\n                                            <div class="vbs-markers-hovers"></div>\n                                            <div class="vbs-comments-wrapper-block"></div>\n                                            <div class="vbs-record-disabler" style="width: 0%;"></div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="vbs-volume-toolbar">\n                                    <a href="#" class="vbs-volume-btn" data-title="Volume"></a>\n                                    <div class="vbs-volume-toolbar-block" style="display: none;">\n                                        <div class="vbs-volume-slider">\n                                            <div class="vbs-volume-slider-bg"></div>\n                                            <div class="vbs-volume-slider-full"></div>\n                                            <div class="vbs-volume-slider-handler"></div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="vbs-edit-instr vbs-clearfix">\n                    <div class="vbs-mouse-btns-desc">\n                        <span><b>Left click</b> on text to <em>Edit</em></span>\n                        <span><b>Right click</b> on text to <em>Menu</em></span>\n                    </div>\n                    </div>\n                <div class="vbs-edition-block" contenteditable="true">\n                    {{ ourtranscript }}\n                </div>\n                <div class="vbs-popup-overlay vbs-save-popup-wrapper">\n                    <div class="vbs-save-popup">\n                        <h2>Unsaved Changes</h2>\n                        <p class="vbs-normal-save-message">You have unsaved changes that will be lost unless you save them.</p>\n                        <p class="vbs-save-message-short-editing">Edited transcript is too short relative to the original and may be rejected by the system. Attempt to save?</p>\n                        <p class="vbs-save-message-long-editing">Edited transcript is too long relative to the original and may be rejected by the system. Attempt to save?</p>\n                        <a href="#" class="vbs-save-btn vbs-save-edition-btn">Save Changes</a>\n                        <a href="#" class="vbs-exit-btn vbs-discard-edition-btn" >Discard Changes</a>\n                        <a href="#" class="vbs-exit-btn vbs-cancel-edition-btn">Cancel</a>\n                    </div>\n                    <div class="vbs-save-done-popup">\n                        <div class="vbs-save-done-img"></div>                        <h3>Done!</h3>\n                    </div>\n                    <div class="vbs-save-loading-popup">\n                        <div class="vbs-ajax-loader"></div>\n                        <h3>Saving & Re-syncing!</h3>\n                        <p>This may take a little time, especially if you’re editing a longer transcript.</p>\n                    </div>\n                </div>\n                </div>';
case"vbs-transcript":var o=e.settings.showMore?"":"vbs-no-showmore-btn";return a='<div class="vbs-transcript-block '+o+t()+'">\n                    <div class="vbs-edit-mode-prewrapper"></div>\n        <div class="vbs-section-header">\n            <div class="vbs-section-title">\n                <span class="vbs-section-name vbs-snh">human transcript</span>\n                <span class="vbs-section-name vbs-snm">machine transcript</span>\n            </div>',a+=e.settings.vbsButtons.orderTranscript?'<div class="vbs-order-human-trans" data-title="See Transcript Price & Options"><a href="#" target="_blank">Order Human Transcript</a></div>':"",a+='<div class="vbs-section-btns">\n                <ul class="vbs-clearfix">',a+=e.settings.vbsButtons.downloadTranscript?'<li><a href="#" class="vbs-cloud-btn vbs-popup-btn" data-title="Download Transcript"></a>\n                <div class="vbs-download-popup vbs-popup">\n                    <div class="vbs-arrow"></div>\n                    <h3>Download transcript</h3>\n                    <a href="#pdf" class="vbs-donwload-pdf" format="pdf">PDF</a>\n                    <a href="#rtf" class="vbs-donwload-rtf" format="rtf">RTF</a>\n                    <a href="#srt" class="vbs-donwload-srt" format="srt">SRT</a>\n                </div>\n                </li>':"",a+=e.settings.vbsButtons.edit?'<li><a href="#" class="vbs-edit-btn" data-title="Edit Transcript"></a></li>':"",a+=e.settings.vbsButtons.print?'<li><a href="#" class="vbs-print-btn" data-title="Print Transcript"></a></li>':"",a+=e.settings.vbsButtons.readermode?'<li><a href="#" class="vbs-readermode-btn" data-title="Reader Mode"></a></li>':"",a+='</ul>\n            </div>\n        </div>\n        <div class="vbs-section-body">\n           <!-- transcript-->\n            <div class="vbs-transcript-prewrapper vbs-resizable"><div class="vbs-transcript-wrapper"></div></div>\n            <!-- / transcript-->\n            ',a+=e.settings.showMore?'<div class="vbs-more-btn"><a href="#">Show More...</a></div>':"",a+="\n        </div>\n    </div>";case"vbs-comments":a='\n                <div class="vbs-comments-block '+t()+'">\n                    <div class="vbs-section-header">\n                        <div class="vbs-section-title" data-title="Show Comments">\n                            <span class="vbs-section-name"></span>\n                        </div>';var l=!0;return e.settings.restrictions.length>0&&(l=e.settings.restrictions.indexOf("manageComments")>-1||e.settings.restrictions.indexOf("manageOwnComments")>-1),l&&(a+='<div class="vbs-section-btns">\n                            <ul class="vbs-clearfix">\n                                <li>',a+=e.settings.tabView?'<a href="#" class="vbs-comments-btn vbs-popup-btn" data-title="Add a Comment"><div class="vbs-comments-btn-icon"></div><span>Add New Comment</span></a>':'<a href="#" class="vbs-comments-btn vbs-popup-btn" data-title="Add a Comment"></a>',a+="</li>\n                            </ul>\n                        </div>"),a+='</div>\n                    <!--wrapper for comments content-->\n                    <div class="vbs-section-body"></div>\n                </div>';case"vbs-news":return a='\n                <div class="vbs-news-block '+t()+'">\n                    <div class="vbs-section-header">\n                        <div class="vbs-section-title" data-title="Show News">\n                            <span class="vbs-section-name">                                <span>News stories</span>                                <span class="vbs-news-words-wrapper">                                    <span class="vbs-small-text"> related to </span>                                    <span class="vbs-news-words"></span>                                </span>                            </span>\n                        </div>\n                    </div>\n                    <!--wrapper for news content-->\n                    <div class="vbs-section-body">\n                        <div class="vbs-news-wrapper vbs-scroll">\n                        </div>\n                    </div>\n                </div>';case"vbs-news-elem":return a="",a+='<a href="{{ url }}" target="_blank" class="vbs-news-elem"><div class="vbs-news-elem-title">{{ title }}</div><div class="vbs-news-elem-body">   <span class="vbs-news-elem-source">{{ source }}</span>   <span>&nbsp;-&nbsp;</span>   <span class="vbs-news-elem-time">{{ time }}</span></div></a>';case"vbs-empty-news":return a='<div class="empty_news_message">{{ message }}</div>';case"disabler":return'<div class="vbs-disabler"></div>';case"reloadOverlay":return a='<div class="vbs-reload-overlay">\n                    <div class="vbs-reload-message-wrapper vbs-clearfix">\n                    <div class="vbs-reload-message"><a href="javascript:void(0)" class="overlay_dismiss">&times;</a><span>Some details were not load</span></div>\n                        <a href="javascript:location.reload();" class="vbs-reload-btn"></a>\n                    </div>\n                    </div>';case"reloadOverlayCredentials":return a='<div class="vbs-reload-overlay">\n                    <div class="vbs-reload-message-wrapper vbs-large-error-text vbs-clearfix">\n                    <div class="vbs-reload-message">\n                        <a href="javascript:void(0)" class="overlay_dismiss">&times;</a>\n                        <span>Could not load recording data, indexing file may not be complete. If reload does not solve problem contact support for assistance</span></div>\n                        <a href="javascript:location.reload();" class="vbs-reload-btn"></a>\n                    </div>\n                    </div>';case"sharePopup":return a='<div class="vbs-share-popup vbs-popup" style="display: block;">\n                        <div class="vbs-arrow"></div>\n\n                        <div class="vbs-share-radio-row vbs-clearfix vbs-checked">\n                            <input type="radio" name="share-opt" value="share-position" id="vbs-share-position" checked="checked">\n                            <label for="vbs-share-position">\n                                Share position <span class="vbsp-time" vbct="{{ vbt }}">{{ vbspTime }}</span> <br>\n                                <span class="vbs-explanation">Drag the timeline to change</span>\n                            </label>\n                            <a href="#" class="vbs-play-btn"></a>\n                        </div>\n\n                        <div class="vbs-share-radio-row vbs-clearfix">\n                            <input type="radio" name="share-opt" value="share-search" id="vbs-share-search">\n                            <label for="vbs-share-search">\n                                Share search  <br>\n                                <span class="vbs-explanation">The current search or keyword  selected</span>\n                            </label>\n                        </div>\n\n                        <div class="vbs-share-radio-row vbs-clearfix">\n                            <input type="radio" name="share-opt" value="share-file" id="vbs-share-file">\n                            <label for="vbs-share-file">Share file from start</label>\n                        </div>\n\n                        <div class="vbs-link-row vbs-clearfix {{ zclip }}">\n                            <input type="text" id="vbsp-url" class="vbsp-url" value="{{ url }}" >\n                            <a href="#" class="vbs-copy-btn">Copy</a>\n                        </div>\n\n                        {{ addthis }}\n\n                        <div class="vbs-share-footer">\n                            {{ vbShareButton }}<a href="#" class="vbs-cancel-btn">Cancel</a>\n                        </div>\n                    </div>';case"commentPopup":return a='\n                    <div class="vbs-comments-popup vbs-comments-add-popup vbs-popup">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-comment-popup-row vbs-clearfix">\n                            <label>\n                                Comment position: <span class="vbs-time" id="vbs-comment-timeline" vbct="{{ vbt }}">{{ vbspTime }}</span> <br>\n                                <span class="vbs-explanation">Drag the timeline to change</span>\n                            </label>\n                            <a href="#" class="vbs-play-btn"></a>\n                        </div>\n                        <div class="vbs-enter-comment-row">\n                            <textarea id="vbs-comment-text" placeholder="Enter your comment..."></textarea>\n                        </div>\n                        <div class="vbs-comment-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" class="vbs-confirm-btn">Add comment</a>\n                        </div>\n                    </div>';case"commentDeletePopup":return a='<div class="vbs-comments-popup vbs-popup vbs-comment-delete-popup">\n                                <div class="vbs-arrow"></div>\n                                <span>Delete This Comment?</span>\n                                <div class="vbs-comment-footer">\n                                    <a href="#" class="vbs-cancel-btn" c_id="{{ c_id }}">Yes, Delete</a>\n                                    <a href="#" class="vbs-confirm-btn">No, Cancel</a>\n                                </div>\n                            </div>';case"commentReplyPopup":return a='\n                    <div class="vbs-comments-popup vbs-popup">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-enter-comment-row">\n                            <textarea id="vbs-comment-reply-text" placeholder="Enter your comment..."></textarea>\n                        </div>\n                        <div class="vbs-comment-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" c_id={{ c_id }} class="vbs-confirm-btn">Add comment</a>\n                        </div>\n                    </div>';case"commentEditFirstPopup":return a='\n                    <div class="vbs-comments-popup vbs-popup">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-comment-popup-row vbs-clearfix">\n                            <label>\n                                Comment position: <span class="vbs-time" id="vbs-comment-timeline" vbct="{{ vbt }}">{{ vbspTime }}</span> <br>\n                                <span class="vbs-explanation">Drag the timeline to change</span>\n                            </label>\n                            <a href="#" class="vbs-play-btn"></a>\n                        </div>\n                        <div class="vbs-enter-comment-row">\n                            <textarea id="vbs-comment-text" placeholder="Enter your comment...">{{ commentText }}</textarea>\n                        </div>\n                        <div class="vbs-comment-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" class="vbs-confirm-btn" c_id="{{ c_id }}">Save Changes</a>\n                        </div>\n                    </div>';case"commentEditPopup":return a='\n                    <div class="vbs-comments-popup vbs-popup vbs-edit-wr">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-enter-comment-row">\n                            <textarea id="vbs-comment-text" placeholder="Enter your comment...">{{ commentText }}</textarea>\n                        </div>\n                        <div class="vbs-comment-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" class="vbs-confirm-btn" c_id="{{ c_id }}">Save Changes</a>\n                        </div>\n                    </div>';case"renameSpeakerPopup":return a='\n                    <div class="vbs-rename-speaker-popup vbs-common-popup">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-common-popup-header vbs-clearfix">\n                            <div class="rename_speaker_label">Rename speaker</div>                            <div class="vbs-old-speaker-name">{{ current_speaker_name }}</div>                            <div class="rename_speaker_label">to:</div>                        </div>\n                        <div class="vbs-common-popup-body">\n                            <input type="text" id="vbs-rename_speaker_input" data-vbs-validate="required" data-old-speaker-key="{{ current_speaker_key }}" placeholder="Enter new speaker name"/>                        </div>\n                        <div class="vbs-common-popup-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" class="vbs-confirm-btn">Rename</a>\n                        </div>\n                    </div>\n';case"insertSpeakerPopup":return a='\n                    <div class="vbs-insert-speaker-popup vbs-common-popup">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-common-popup-header vbs-clearfix">\n                            <div class="rename_speaker_label">Insert speaker</div>                        </div>\n                        <div class="vbs-common-popup-body">\n                            <div class="vbs-select-wrapper vbs-select-insert-speaker-wrapper">\n                                <div class="vbs-select-title vbs-select-insert-speaker vbs-new-speaker">                                    <div class="vbs-speaker-selected">Insert new speaker</div>                                </div>\n                                <ul class="vbs-select-dropdown"></ul>\n                            </div>\n                            <div class="vbs-speaker-input-wrapper">                                <input type="text" data-vbs-validate="required,ignore[invisible]" class="vbs-insert-speaker-input" value="" placeholder="Enter speaker name"/>                            </div>                        </div>\n                        <div class="vbs-common-popup-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" class="vbs-confirm-btn">Insert</a>\n                        </div>\n                    </div>\n';case"categoriesLiTemplate":return'<li class="{{liclass}}">   <a href="javascript:void(0);" speakers="{{ speakers }}">{{ title }}</a>   <div class="vbs-topic-del-btn-wrap"><i class="vbs-cross-btn vbs-popup-btn"></i></div></li>';case"newCategoriesLiTemplate":return'<li {{ keyclass }}><a href="javascript:void(0);" t="{{ times }}" in="{{ internalName }}" speakers="{{ speakers }}" {{ sptimes }}>{{ title }}</a></li>';case"categoriesKeywords":return'<div class="category"><h3>{{ cattitle }} (<span class="ccount">{{ count }}</span>)</h3><div class="new-topics"><ul>{{ lis }}</ul><div class="clearblock"></div></div></div>';case"keywordsTemplate":return'<li {{ keyclass }}><a href="#" t="{{ times }}" speakers="{{ speakers }}" {{ sptimes }}>{{ name }}</a>{{ keycounter }}</li>';case"markerTemplate":return'<a href="#" class="vbs-marker" style="border-bottom-color:{{ stcolor }}; z-index:91; left:{{ position }}px;" stime="{{ time }}"><ins></ins></a><span ctime="{{ time }}" class="vbs-comment">{{ phrase }}</span>';case"customMarkerTemplate":return'<a href="#" class="vbs-marker vbs-custom-marker" style="z-index:91; left:{{ position }}px;" stime="{{ time }}"><ins></ins></a><span ctime="{{ time }}" class="vbs-comment">{{ phrase }}</span>';case"markerKeyTemplate":return'<a href="#" class="vbs-marker key" style="z-index:91; left:{{ position }}px;" stime="{{ time }}"><ins></ins></a>';case"searchWordTemplate":return'<span class="vbs-word">   <em>       <dfn style="border-bottom-color: {{ color }};" class="vbs-marker"><ins></ins></dfn>       {{ clean_word }}       <span class="vbs-search_word" style="display:none">{{ word }}</span>   </em></span>';case"mainDiv":return a='<!--media-->\n<div id="vbs-media"></div>\n<!--controls-->\n<div id="vbs-controls"></div>',e.settings.tabView?(a+='<!-- tabs-->\n<div class="vbs-not-media-sections vbs-tabs-view">\n    <div class="vbs-tabs-links vbs-clearfix">\n',e.settings.showKeywordsBlock&&(a+='        <a href="#" data-href=".vbs-keywords-block" class="vbs-active">Keywords</a>\n'),e.settings.showTranscriptBlock&&(a+='        <a href="#" data-href=".vbs-transcript-block">Transcript</a>\n'),e.settings.showCommentsBlock&&(a+='        <a href="#" data-href=".vbs-comments-block">Comments</a>\n'),a+='</div>\n    <!--keywords-->\n    <div id="vbs-keywords"></div>\n    <!-- transcript -->\n    <div id="vbs-transcript"></div>\n    <!-- comments -->\n    <div id="vbs-comments"></div>\n</div>\n'):(a+='<!--keywords-->\n                        <div id="vbs-keywords"></div>',e.settings.showNewsBlock&&(a+='<!--news-->\n                            <div id="vbs-news"></div>'),a+='<!-- transcript -->\n                        <div id="vbs-transcript"></div>\n                        <!-- comments -->\n                        <div id="vbs-comments"></div>'),a;case"speakersTemplate":return'<div class="vbs-speaker {{ colorclass }}" rel="tooltip" data-plcement="top" style="width: {{ width }}px; left: {{ position }}px;" s="{{ s }}" e="{{ e }}" cnum="{{ colorclass }}"></div>';case"speakersAllFilter":return'<div id="speakers-block" speakerlist="{{ speakerlist }}" style="{{ style }}"><div class="current-speaker"><h3 data-speaker="all">All speakers</h3></div><div class="speakers-list">Click to drill down into what {{ speakers_links }} talked about, or see keywords for <a href="#all" data-speaker="all">All Speakers</a></div><div style="clear: both;"></div></div>';case"speakersFilter":return'<div id="speakers-block" speakerlist="{{ speakerlist }}" style="{{ style }}"><div class="current-speaker"><h3 data-speaker="{{ curspeaker }}">{{ curspeaker }}</h3></div><div class="speakers-list">Click to drill down into what {{ speakers_links }} talked about, or see keywords for <a href="#all" data-speaker="all">All Speakers</a></div><div style="clear: both;"></div></div>';case"speakerIsSpeaking":return'<span class="{{ speakerKey }}">{{ speakerName }}</span> is speaking';case"speakerTranscriptLabel":return'<span class="vbs-clearfix"></span><span class="vbs-trans-info">   <span class="vbs-human-trans-name {{ spClass }}" title="{{ speakerName }}">{{ speakerName }}</span>   <span class="vbs-human-trans-time">{{ speakerTime }}</span></span>';case"deleteTopicPopup":return a='<div class="vbs-comments-popup vbs-popup vbs-topic-delete-popup" data-topic="{{ topicname }}">\n                            <div class="vbs-arrow"></div>\n                            <span>Delete Topic?</span>\n                            <div class="vbs-comment-footer">\n                                <a href="#" class="vbs-cancel-btn">Yes</a>\n                                <a href="#" class="vbs-confirm-btn">No</a>\n                            </div>\n                        </div>';case"vbsCommentsTimeline":return a='<div class="vbs-comments-wrapper {{ rightClass }}" style="left:{{ position }}px;" stime="{{ stime }}">\n                            <div class="vbs-comment-small"></div>\n                            <div class="vbs-comment-preview"><a href="#" stime="{{ stime }}">{{ commentText }}</a></div>\n                        </div>';case"alertPopup":return a='<div class="vbs-alert_popup" data-action="{{ action }}"><div class="modalDialog_transparentDivs" style="left: 0px; top: 0px; display: block; width: 1925px; height: 662px;"></div>\n                <div class="modalDialog_contentDiv" id="DHTMLSuite_modalBox_contentDiv" style="display: block; width: 433px; left: 744px; top: 267px;"><div class="popup"><!--[if lt IE 7]><iframe></iframe><![endif]--><div class="inpopup"><a href="#" class="modal_close" alt="Close" title="Close"></a><h4>Delete Confirmation</h4><p>Do you really want to remove this topic with keywords?</p><div class="voicebase_buttons"><span><a href="#" class="modal_confirm">Confirm Delete</a></span><ins><a href="#" class="modal_cancel">Cancel Delete</a></ins></div><div class="fixer">&nbsp;</div></div></div></div></div>';case"errorPopup":return'<div class="vbs-white-popup-overlay">   <div class="vbs-big-error-popup">       <a href="javascript:void(0)" class="overlay_dismiss">&times;</a>       <h2>Could not load recording data</h2>       <p>Indexing file may not be complete. If reloading does not solve the problem, please contact support for assistance.</p>       <a href="javascript:location.reload();" class="vbs-reload-btn"></a>       <a href="http://www.voicebase.com/contact-us/" target="_blank" class="vbs-contact-support-btn"></a>   </div></div>';case"abstractErrorPopup":return'<div class="vbs-white-popup-overlay"><div class="vbs-big-error-popup"><a href="javascript:void(0)" class="overlay_dismiss">&times;</a><h2>{{ errorTitle }}</h2><p>{{ errorText }}</p><a href="javascript:location.reload();" class="vbs-reload-btn"></a><a href="http://www.voicebase.com/contact-us/" target="_blank" class="vbs-contact-support-btn"></a></div></div>';case"abstractAlertPopup":return'<div class="vbs-white-popup-overlay"><div class="vbs-big-error-popup"><h2>{{ errorTitle }}</h2><p>{{ errorText }}</p></div></div>';case"textErrorMessage":return'<div class="vbs-text-error-message"><p>{{ errorText }}</p></div>';case"infoMessage":return'<div class="vbs-message vbs-message-{{ mode }}"><p>{{ errorText }}</p></div>';case"endSearchMessage":return'<div class="vbs-message vbs-message-info"><p>Your search is taking a long time...</p><p>Please wait or click to <a href="javascript:void(0)" class="vbs-cancel-search">Cancel</a></p></div>';case"utteranceBlock":return'<div class="vbs-utterance-block vbs-clearfix"><div class="vbs-utterance-title"><p>utterance detection</p></div><div class="vbs-utterance-list"><ul class="vbs-clearfix"></ul></div></div>';case"utteranceCheckBox":return'<li><label class="vbs-utter-{{ rownum }}"><input type="checkbox" checked data-row="{{ rownum }}"/>{{ title }}<span class="vbs-utter-num">({{ segmentsCount }})</span></label></li>';case"utteranceMarker":return'<div class="vbs-utter-marker vbs-utter-{{ rownum }} vbs-utter-row{{ rownum }}" data-stime="{{ startTime }}" style="width:{{ width }}px; left:{{ position }}px;"><div class="vbs-utter-tooltip"><p class="vbs-utter-title">{{ title }}</p><p class="vbs-utter-time">{{ time }}</p></div></div>';case"loggerBlock":return'<div class="vbs-logger"><textarea>{{ response }}</textarea></div>';case"languageSelect":return a='<div class="vbs-select-wrapper vbs-select-language-wrapper">\n                            <div class="vbs-select-title vbs-select-language">Select language...</div>\n                            <ul class="vbs-select-dropdown"></ul>\n                        </div>';case"languageItem":return a='<li data-lang-code="{{ lang_code }}">{{ lang_name }}</li>';case"firstSpeakerItem":return a='<li class="vbs-insert-new-speaker">Insert new speaker</li>';case"speakerItem":return a='<li data-speaker-key="{{ speaker_key }}">{{ speaker_name }}</li>';case"insertSpeakerText":return a='<span class="w vbs-wd vbs-edit-speaker" m="{{ speakerKey }}" t="{{ speakerTime }}"><br><br>{{ speakerName }}:</span>';case"savingMessage":return a='<div class="vbs-saving">   <div class="vbs-saving-inner">       <div class="vbs-saving-loader"></div>       <div class="vbs-saving-message">Saving & Re-syncing...</div>   </div></div>';case"successSavingMessage":return a='<div class="vbs-success-saving">   <div class="vbs-saving-inner">       <div class="vbs-saving-loader"></div>       <div class="vbs-saving-message">Transcript Saved</div>   </div></div>';case"playlist":return a='                    <div class="vbs-playlist collapsed">\n                        <div class="vbs-selected-playlist-item">                            <div class="vbs-item-name"></div>\n                            <i></i>\n                        </div>\n                        <div class="vbs-clearfix"></div>\n                        <ul class="vbs-playlist-dropdown">\n                        </ul>\n                    </div>';case"playlist-item":return a='                    <li class="vbs-playlist-item" data-playlist-item-index="{{ index }}">\n                        <span class="vbs-playlist-item-title">{{ title }}</span>                    </li>';case"controlsContainer":return a='                    <div class="vbs-after-controls-wrapper">                        <div class="vbs-player-control"></div>\n                        <div class="vbs-share-control"></div>\n                    </div>';default:return""}}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";return e.validator={validate:function(s){var a=s.find("[data-vbs-validate]"),r=[];return a.each(function(){var s=t(this),a=e.validator.getRules(s),n=a.rules,i=!1;a.ignoreRule&&(i=e.validator.conditions.ignore(s,a.ignoreRule.params[0])),!i&&n&&n.forEach(function(t){var a=e.validator.conditions[t.name](s,t.params);if(!a){var n=e.validator.getMessage(t.name,t.params);r.push({field:s,rule:t.name,message:n})}})}),r.length>0?(e.validator.clearMessages(s),e.validator.showMessages(r),!1):!0},clearMessages:function(e){e.find(".vbs-msg").remove()},showMessages:function(t){t.forEach(function(t){var s=t.field,a=e.validator.createMessage(t.message);s.after(a)})},createMessage:function(e){var t='<div class="vbs-msg vbs-msg-alert">'+e+"</div>";return t},getRules:function(t){var s=t.attr("data-vbs-validate"),a={};if(s){var r=[],n=s.split(",");return n.forEach(function(t){for(var s=t.trim().split(/\[|,|\]/),n=0;n<s.length;n++)s[n]=s[n].replace(" ",""),""===s[n]&&s.splice(n,1);if(s.length>0){var i={};i.name=s[0],s.splice(0,1),i.params=s,e.validator.conditions[i.name]&&("ignore"===i.name?a.ignoreRule=i:r.push(i))}}),a.rules=r,a.rules.length>0?a:null}return null},getValue:function(e){var t;switch(e.prop("type")){case"radio":case"checkbox":t=e.is(":checked");break;default:t=e.val()}return t},getMessage:function(t,s){for(var a=e.validator.messages[t]?e.validator.messages[t]:"",r=0;r<s.length;r++){var n=new RegExp("{{\\s*param"+(r+1)+"\\s*}}","gi");a=a.replace(n,s[r])}return a&&(a="* "+a),a},conditions:{required:function(t){var s=e.validator.getValue(t);return!(null===s||""===s)},minSize:function(t,s){var a=parseInt(s[0]),r=e.validator.getValue(t),n=r.length||0;return n>=a},maxSize:function(t,s){var a=parseInt(s[0]),r=e.validator.getValue(t),n=r.length||0;return a>=n},visible:function(e){return e.is(":visible")},ignore:function(t,s){if("invisible"===s){var a=e.validator.conditions.visible(t);return!a}}},messages:{required:"This field is required",minSize:"{{ param1 }} characters required",maxSize:"{{ param1 }} characters allowed"}},e}(voiceBase,jQuery),voiceBase=function(e,t){"use strict";function s(e){e.find(".vbs-section-title").addClass("vbs-no-toggle")}function a(){e.settings.toggleBlocks?(e.settings.toggleMediaBlock||s(t("#"+e.settings.mediaBlock)),e.settings.toggleKeywordsBlock||s(t("#"+e.settings.keywordsBlock)),e.settings.toggleTranscriptBlock||s(t("#"+e.settings.transcriptBlock)),e.settings.toggleCommentBlock||s(t("#"+e.settings.commentsBlock)),e.settings.toggleNewsBlock||s(t("#"+e.settings.newsBlock))):t(".vbs-section-title").addClass("vbs-no-toggle")}function r(){var s=t("#"+e.settings.mediaBlock),a=t("#"+e.settings.keywordsBlock),r=t("#"+e.settings.transcriptBlock),n=t("#"+e.settings.commentsBlock);e.settings.hasMediaBlockHeader||s.hide(),e.settings.hasKeywordsBlockHeader||a.find(".vbs-keywords-block").addClass("vbs-no-header"),e.settings.hasTranscriptBlockHeader||r.find(".vbs-transcript-block").addClass("vbs-no-header"),e.settings.hasCommentsBlockHeader||n.find(".vbs-comments-block").addClass("vbs-no-header")}return e.view={main:null,pluginDiv:null,init:function(t){this.initMainElem(t),e.settings.hasPlaylist||e.settings.localApp||this.initApi(),e.helper.isMobile()&&e.helper.renderMobile()},initMainElem:function(s){this.main="OBJECT"===s[0].tagName&&"jwplayer"==e.settings.playerType?t(s).parent():s;var a=document.createElement("div");a.className="vbsp-"+e.helper.randId()+" vbs-content",a.innerHTML=e.templates.get("mainDiv"),this.pluginDiv=t(a),t(this.main).after(this.pluginDiv)},initApi:function(){e.api.init(),e.settings.token||e.settings.example||e.settings.localApp?e.settings.example&&!e.settings.localApp?e.api.getExampleToken():e.view.initWithToken():e.api.getToken(e.settings.tokenTimeOut)},initWithToken:function(){e.data.vclass="vbs-"+e.helper.randId(),t(".vbs-white-popup-overlay").remove(),t(".vbs-text-error-message").remove(),e.view.renderMediaBlock(),e.settings.localApp?e.api.setLocalMetaData():e.api.getMetaData(),e.view.renderControlsBlock(),e.settings.showKeywordsBlock?(e.view.renderKeywordsBlock(),e.settings.localApp||e.helper.isApi2_0()||e.api.getKeywords()):e.api.ready.keywords=!0,e.settings.showTranscriptBlock?(e.view.renderTranscriptBlock(),e.settings.localApp||e.helper.isApi2_0()||e.api.getTranscript()):e.api.ready.transcript=!0,e.settings.showCommentsBlock?(e.view.renderCommentsBlock(),e.helper.isApi2_0()||e.comments.getComments()):e.api.ready.comments=!0,e.settings.localApp&&e.view.renderLanguageBlock(),e.settings.showNewsBlock&&e.view.renderNewsBlock(),e.settings.tabView&&e.view.renderTabs(),a(),r(),e.data.waiter=setInterval(function(){e.data.waiter&&e.helper.waitReady()},100),e.events.registerEvents()},initLocalData:function(){var s=e.data.localData.selected_language,a=t("#"+e.settings.keywordsBlock),r=t("#"+e.settings.transcriptBlock);e.data.localData.keywords?e.api.setKeywords(e.data.localData.keywords[s]):YSP.api.getKeywords(function(t){e.data.localData.keywords=t.keywords,a.removeClass("vbs-loading"),e.api.setKeywords(e.data.localData.keywords[e.data.localData.selected_language])}),e.data.localData.transcripts?e.api.setTranscript(e.data.localData.transcripts[s]):YSP.api.getTranscript(function(t){e.data.localData.transcripts=t.transcripts,r.removeClass("vbs-loading"),e.api.setTranscript(e.data.localData.transcripts[e.data.localData.selected_language])})},renderControlsBlock:function(){var s=t("#"+e.settings.controlsBlock);s.empty().html(e.templates.get("vbs-controls")).addClass(e.data.vclass+" vbs-controls").css({width:e.settings.controlsWidth}),e.view.setResponsiveClass(s),e.settings.showControlsBlock||s.addClass("vbs-hide-controls")},renderMediaBlock:function(){var s=t("#"+e.settings.mediaBlock);s.empty().html(e.templates.parse("vbs-media")).addClass(e.data.vclass).css({width:e.settings.mediaWidth}),e.view.setResponsiveClass(s)},renderTimeInMediaTitle:function(){var s=t("#"+e.settings.mediaBlock),a=e.helper.parseTime(e.data.duration);e.helper.find(".vbs-ftime").text(a),s.hasClass("less-600px")||!e.settings.hasMediaBlockHeader?t(".vbs-time-in-player").find(".vbs-time").show():s.find(".vbs-section-header").find(".vbs-time").show()},renderKeywordsBlock:function(){var s=t("#"+e.settings.keywordsBlock),a=t("#"+e.settings.controlsBlock);if(e.settings.searchBarOuter){t("#vbs-searchbar-block").remove();var r=t("#"+e.settings.searchBarBlock);r.length>0?r.empty().append(e.templates.parse("vbs-searchbar-outer")):a.after(e.templates.parse("vbs-searchbar-outer"));var n=t("#vbs-searchbar-block");n.addClass(e.data.vclass).css({width:e.settings.searchBarBlockWidth}),s.empty().html(e.templates.parse("vbs-keywords",{styles:"height: "+e.settings.keywordsHeight+"px;"})).addClass(e.data.vclass).css({width:e.settings.keywordsWidth}),s.find(".vbs-search-form").addClass("no_border")}else s.empty().html(e.templates.parse("vbs-keywords",{styles:"height: "+e.settings.keywordsHeight+"px;"})).addClass(e.data.vclass).css({width:e.settings.keywordsWidth}),e.view.setResponsiveClass(s);e.settings.markersInNativeTimeline&&e.view.renderControlsAfterSearchBar(),e.settings.localApp&&(s.addClass("vbs-local-app vbs-loading"),s.find(".vbs-section-title").attr("data-title","Loading keywords"))
},renderControlsAfterSearchBar:function(){if(e.settings.searchBarOuter){var s=t("#vbs-searchbar-block");s.addClass("vbs-controls-after-searchbar vbs-searchbar-outer"),t(".vbs-after-controls-wrapper").remove(),s.find(".vbs-search-form").after(e.templates.get("controlsContainer")),t(".vbs-prev-btn,.vbs-next-action-btn").appendTo(".vbs-controls-after-searchbar .vbs-player-control"),t(".vbs-share-btn-wrapper").appendTo(".vbs-controls-after-searchbar .vbs-share-control"),s.find(".vbs-search-form").width(s.width()-t(".vbs-controls-after-searchbar .vbs-after-controls-wrapper").width()-2)}else{var a=t(".vbs-keywords-block "),r=t(".vbs-search-form");0===a.find(".vbs-section-btns").length&&r.after('<div class="vbs-section-btns"><ul></ul></div>');var n=a.find(".vbs-section-btns");n.find(".vbs-controls-after-searchbar").remove(),n.addClass("vbs-controls-after-searchbar-wrapper").find("ul").append('<li class="vbs-controls-after-searchbar vbs-searchbar-inner"></li>'),n.find(".vbs-controls-after-searchbar").append(e.templates.get("controlsContainer")),t(".vbs-prev-btn,.vbs-next-action-btn").appendTo(".vbs-controls-after-searchbar-wrapper .vbs-player-control"),t(".vbs-share-btn-wrapper").appendTo(".vbs-controls-after-searchbar-wrapper .vbs-share-control"),r.removeClass("vbs-one-btn vbs-no-btns"),e.settings.vbsButtons.evernote&&"undefined"!=typeof filepicker?r.addClass("vbs-four-btns"):r.addClass("vbs-three-btns")}},resetControlsPlace:function(){t(".vbs-controls-after-searchbar").find(".vbs-prev-btn").appendTo(".vbs-record-player .vbs-player-control"),t(".vbs-controls-after-searchbar").find(".vbs-next-action-btn").appendTo(".vbs-record-player .vbs-player-control"),t(".vbs-search-form").removeClass("vbs-four-btns vbs-three-btns"),t(".vbs-volume-toolbar").after(t(".vbs-controls-after-searchbar").find(".vbs-share-btn-wrapper")),e.settings.searchBarOuter&&t(".vbs-search-form").width(295)},renderTabs:function(){var s=t("#"+e.settings.keywordsBlock),a=t(".vbs-tabs-view");e.view.setResponsiveClass(a),a.hasClass("less-600px")||a.hasClass("less-480px")||a.addClass("vbs-normal-width");var r=t(".vbs-tabs-links");r.find("a").removeClass("vbs-active"),r.find('[data-href=".vbs-keywords-block"]').addClass("vbs-active"),s.find(".vbs-keywords-block").addClass("vbs-tab-visible")},checkEmptyHeadersForTabs:function(){var e=t(".vbs-tabs-view");e.hasClass("vbs-normal-width")||t(".vbs-tab").each(function(){var e=t(this).find(".vbs-section-header"),s=t(this).hasClass("vbs-keywords-block")&&0===e.find(".vbs-no-speaker").length?!0:!1;s||0!==e.find(".vbs-section-btns").length||t(this).addClass("vbs-tab-empty-header")})},renderTranscriptBlock:function(){var s=t("#"+e.settings.transcriptBlock);s.addClass(e.data.vclass).empty().html(e.templates.get("vbs-transcript")).css({width:e.settings.transcriptWidth}),e.view.setResponsiveClass(s),e.settings.localApp&&(s.addClass("vbs-local-app vbs-loading"),s.find(".vbs-section-title").attr("data-title","Loading transcript"))},renderCommentsBlock:function(){var s=t("#"+e.settings.commentsBlock);s.addClass(e.data.vclass).empty().html(e.templates.get("vbs-comments")).css({width:e.settings.commentsWidth}),e.view.setResponsiveClass(s)},renderNewsBlock:function(){var s=t("#"+e.settings.newsBlock);s.addClass(e.data.vclass).empty().html(e.templates.get("vbs-news")).css({width:e.settings.newsWidth}),e.view.setResponsiveClass(s),e.settings.expandNewsBlock?e.helper.expandNewsBlock():e.helper.collapseNewsBlock()},renderLanguageBlock:function(){if(e.data.localData.languages&&e.data.localData.languages.length>0){var s=t("#"+e.settings.mediaBlock),a=s.find(".vbs-section-header .vbs-section-btns");a.after(e.templates.get("languageSelect"));for(var r=s.find(".vbs-select-language-wrapper"),n=[],i="",o=0;o<e.data.localData.languages.length;o++){var l=e.data.localData.languages[o],d=Object.keys(l)[0],c=l[d],p={lang_code:d,lang_name:c};i+=e.templates.parse("languageItem",p),0===d.indexOf("en")&&n.push(p)}r.find(".vbs-select-dropdown").html(i),n.length>0?e.view.selectLanguage(n[0]):e.view.selectLanguage(e.data.localData.languages[0])}},selectLanguage:function(s){var a=t(".vbs-select-language-wrapper").find(".vbs-select-language"),r=s.lang_code;a.removeClass("vbs-s-show").html(s.lang_name).attr(r),e.data.localData.selected_language=r,e.view.initLocalData()},checkResponsive:function(){var s=[t("#"+e.settings.controlsBlock),t("#"+e.settings.mediaBlock),t("#"+e.settings.keywordsBlock),t("#"+e.settings.transcriptBlock),t("#"+e.settings.commentsBlock),t("#"+e.settings.newsBlock)];s.forEach(function(t){e.view.setResponsiveClass(t)})},setResponsiveClass:function(t){t.width()<e.settings.mediumResponsive&&t.width()>=e.settings.minResponsive?t.addClass("less-600px"):t.width()<e.settings.minResponsive&&t.addClass("less-600px").addClass("less-460px")},initAfterSaveTranscript:function(){e.api.ready.keywords=!1,e.helper.find(".vbs-keywords-block .vbs-topics").html(""),e.helper.find(".vbs-keywords-block .vbs-keywords-list-tab").html(""),e.helper.find(".vbs-select-speaker-wrapper .vbs-select-dropdown").html(""),e.helper.find(".vbs-search-form").addClass("vbs-no-speaker"),e.data.speakers={},e.api.ready.transcript=!1,e.helper.find(".vbs-transcript-block").removeClass("vbs-human").removeClass("vbs-with-order-btn"),e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper").html("").removeClass("vbs-turntimes"),e.helper.find(".vbs-speakers").html("").removeClass("vbs-machine"),e.helper.find(".vbs-media-block .vbs-section-title, .vbs-time-name-wrapper-narrow").removeClass("vbs-machine"),e.api.getKeywords(),e.api.getTranscript()},searchWordWidget:function(t){if(t.length>0){var s=e.helper.find(".vbs-search-word-widget"),a=e.helper.find("#vbs-voice_search_txt");a.css("opacity","0"),e.helper.find("#vbs-search-string").show();var r="";for(var n in t){var i="";i=n>7?"#"+("000000"+(16777215*Math.random()<<0).toString(16)).slice(-6):e.settings.colors[n],r+=" "+e.templates.parse("searchWordTemplate",{word:t[n],clean_word:t[n].replace(/"/g,""),color:i},"span")}s.html(r),e.data.searcht&&e.settings.editKeywords&&a.data("data-val")==a.val()&&e.helper.checkKeyword(t,e.data.searcht,e.data.searchHits),a.data("data-val")!=a.val()&&(e.data.searcht=null,e.data.searchHits=null),e.helper.updateQuotesVisibility(),e.helper.startScroll()}},markerWidget:function(t,s,a){var r=(e.data.markersStyles.markersWrapper,e.data.markersStyles.markersContainer,e.data.markersStyles.markersWrapperWidth),n="";("undefined"==typeof a||null===a)&&(a=e.settings.colors[0]),("undefined"==typeof s||null===s)&&(s=null);for(var i in t){var o=t[i]*r/e.data.duration,l="undefined"==typeof s[i]?"":s[i];l=e.common.unEscapeHtml(s[i]),n+=" "+e.templates.parse("markerTemplate",{position:o,time:t[i],stcolor:a,phrase:l})}return n},showCustomMarkers:function(){var s=e.helper.find(".vbs-record-timeline-wrap"),a=t(".vbs-custom-markers");if(0===a.find(".vbs-custom-marker").length){var r=s.width(),n=e.data.customMarkers,i="";for(var o in n){var l=o*r/e.data.duration,d=n[o];d=e.common.unEscapeHtml(d),i+=" "+e.templates.parse("customMarkerTemplate",{position:l,time:o,stcolor:"#aaa",phrase:d})}a.append(i)}a.show()},hideCustomMarkers:function(){var e=t(".vbs-custom-markers");e.hide()},markerWidgetForNativeTimeline:function(){{var s=e.data.duration,a=t(".vbs-markers").find(".vbs-marker");e.PlayerApi.getPlayerIframe()}e.view.clearScrubberOfMarks(),t.each(a,function(a,r){var n=t(r).attr("stime"),i=t(r).css("border-bottom-color"),o=(t(r).css("left"),n/s*100);e.view.createScruberMark("vb_scrubber_mark"+a,i,o,10,"keyword-marks keyword-mark-"+a);var l=t('span[ctime="'+n+'"]');"undefined"!=typeof r?e.view.createPhraseBar("vb_scrubber_mark"+a,l.text()):console.log("Keyword phrase-bar not found for "+n)})},clearScrubberOfMarks:function(){var t=e.PlayerApi.getPlayerIframe();t.find(".keyword-marks").remove(),t.find(".vb-keyphrase").remove()},createScruberMark:function(t,s,a,r,n){var i=e.PlayerApi.getPlayerIframe(),o=i.find(".playHead"),l=i.find("#"+t);if(l.length>0)l.css("left",a+"%");else{r="undefined"!=typeof r?r:10,s="undefined"!=typeof s?s:"#dddddd";var d=i.find(".scrubber"),c=d.height();l=jQuery('<a class="scrubber-marker '+n+'"></a>'),e.view.setMarkerCss(l,c,a,s,t,r),o.after(l)}},createPhraseBar:function(s,a){var r=e.PlayerApi.getPlayerIframe(),n=t('<span class="vb-keyphrase" style="display: none;">'+a+"</span>");n.css({position:"absolute","text-align":"center",width:"100%",height:"17px","padding-top":"3px","margin-top":"-20px","background-color":"#EDF0F8","border-radius":"2px",color:"#333","font-family":"Helvetica, Arial, sans-serif","font-size":"13px","z-index":99}).attr("sourcemarker",s),r.find(".controlBarContainer").prepend(n),r.find("#"+s).mouseenter(function(){r.find("span[sourcemarker="+this.id+"]").show()}),r.find("#"+s).mouseleave(function(){r.find("span[sourcemarker="+this.id+"]").hide()})},setMarkerCss:function(e,t,s,a,r,n){e.css({"border-top-width":t,"border-top-style":"solid","border-top-color":a,left:s+"%",position:"absolute","border-left-width":n/2,"border-left-style":"solid","border-left-color":"transparent","border-right-width":n/2,"border-right-style":"solid","border-right-color":"transparent","z-index":99}).attr("id",r)},keywordHover:function(t){if(""===t)return!1;var s=e.helper.find(".vbs-record-timeline-wrap"),a="";t=t.split(",");for(var r in t){var n=parseFloat(t[r])*s.width()/e.data.duration;a+=" "+e.templates.parse("markerKeyTemplate",{position:n,time:parseFloat(t[r])})}e.helper.find(".vbs-markers-hovers").html(a)},removeKeywordHover:function(){e.helper.find(".vbs-markers-hovers").html("")},favorite:function(t){return t?e.helper.find(".vbs-star-btn").addClass("vbs-active").attr("data-tile","Remove from Favorites"):e.helper.find(".vbs-star-btn").removeClass("vbs-active").attr("data-tile","Add from Favorites"),t},favoriteToggle:function(){return e.helper.find(".vbs-star-btn").toggleClass("vbs-active"),!0},resizeTimelineElements:function(){var s=e.helper.find(".vbs-record-timeline-wrap").width(),a=e.data.duration;e.helper.find(".vbs-markers a").each(function(){var e=t(this),r=e.attr("stime"),n=r*s/a;e.css("left",n)}),e.speakers.resizeSpeakers(),e.comments.resizeCommentsTWidget(),e.helper.startScroll()},tooltips:function(){t(".vbs-tooltip").remove(),t("body").append('<span class="vbs-tooltip"></span>'),t("[data-title]").each(function(){var s=t(this),a=t(".vbs-tooltip");s.hover(function(){a.stop(!0,!0).hide();var t=s.attr("data-title");a.text(t);var r=e.view.getPositionElementForTooltip(s),n=parseInt(a.css("width"))+20,i=34,o={top:r.top>i?r.top-i:r.top+r.height+8,left:r.left+r.width/2-n/2};a.css({top:o.top+"px",left:o.left+"px"}),r.top>i?a.removeClass("vbs-arrow-on-top"):a.addClass("vbs-arrow-on-top"),a.stop(!0,!0).fadeIn(100)},function(){a.stop(!0,!0).fadeOut(100)})})},getPositionElementForTooltip:function(e){var s=e[0].getBoundingClientRect(),a=e.offset(),r={scroll:e.scrollTop()},n=t("body"),i={top:0,left:0};("absolute"===n.css("position")||"relative"===n.css("position")||"fixed"===n.css("position"))&&(i=n.offset());var o=t.extend({},s,r,a);return o.top-=i.top,o.left-=i.left,o},hideTooltips:function(){t(".vbs-tooltip").hide()}},e}(voiceBase,jQuery);
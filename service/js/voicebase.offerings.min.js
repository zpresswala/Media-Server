var voiceBaseOfferings=function(e){"use strict";var s={};return s.init=function(e){s.reSettings(e),s.view.createPopup(),s.view.showPopup(),s.events.registerEvents(),s.api.getOfferings(function(e){s.view.createOfferTable(e)})},s.reSettings=function(r){s.settings=e.extend(!0,s.settings,r)},s.settings={apiUrl:"",version:"1.1",action:"getOfferings",apiKey:"",password:"",mediaId:"",mediaLengthInMinutes:0,language:"en",recordName:"",mode:"upgrade",mediaUrl:""},s.data={currentOffer:null},s}(jQuery),voiceBaseOfferings=function(e){"use strict";return e.templates={offeringPopup:function(){return'<div class="vbs-offerings-popup">   <div class="vbs-offerings-popup-header">       <h2 class="vbs-offerings-popup-header-title">Choose the Accuracy and Delivery You Need</h2>       <a href="javascript:void(0)" class="vbs-offerings-popup-close">x</a>   </div>   <div class="vbs-offerings-popup-body">       <div class="vbs-choose-offer-container"></div>       <div class="vbs-confirm-offer-container"></div>   </div>   <div class="vbs-offerings-popup-footer">          </div></div>'},ajaxLoader:function(){return'<div class="vbs-ajax-loader"></div>'},offeringTable:function(){return'<div class="vbs-humanRequest"><table>   <thead>       <th class="vbs-summary">Accuracy</th>       <th class="vbs-delivery vbs-delivery-1">1 Day</th>       <th class="vbs-delivery vbs-delivery-2-4">2-4 Days</th>       <th class="vbs-delivery vbs-delivery-5-7">5-7 Days</th>       <th style="width: 140px;"># Human Reviews</th>       <th class="vbs-last">Recommended for</th>   </thead>   <tbody>       <tr class="vbs-accuracy-row vbs-accuracy-econo">           <td class="vbs-accuracy">               <h5>Econo 90-95%</h5>               <span class="vbs-accuracy-label">Speaker Turns</span>           </td>           <td class="vbs-delivery vbs-delivery-1"></td>           <td class="vbs-delivery vbs-delivery-2-4"></td>           <td class="vbs-delivery vbs-delivery-5-7"></td>           <td class="vbs-review">               <strong>1</strong><br>               <span>human review</span>           </td>           <td class="vbs-recommended">               <span>Lectures, sermons, drafts, SEO and documents which will be edited, lowest price</span>           </td>       </tr>       <tr class="vbs-accuracy-row vbs-pro-98">           <td class="vbs-accuracy">               <h5>Pro 98%</h5>               <span class="vbs-accuracy-label">Speaker Turns</span>           </td>           <td class="vbs-delivery vbs-delivery-1"></td>           <td class="vbs-delivery vbs-delivery-2-4"></td>           <td class="vbs-delivery vbs-delivery-5-7"></td>           <td class="vbs-review" rowspan="2">               <strong>2</strong><br>               <span>human reviews</span>           </td>           <td class="vbs-recommended" rowspan="2">               <span>Interviews, webinars, corporate, research & most other use cases. Generally OK for internal distribution with little or no reviews.</span>           </td>       </tr>       <tr class="vbs-accuracy-row vbs-pro-plus-98">           <td class="vbs-accuracy">               <h5>Pro+ 98%</h5>               <span class="vbs-accuracy-label">Speaker ID</span>           </td>           <td class="vbs-delivery vbs-delivery-1"></td>           <td class="vbs-delivery vbs-delivery-2-4"></td>           <td class="vbs-delivery vbs-delivery-5-7"></td>       </tr>       <tr class="vbs-accuracy-row vbs-premium-99">           <td class="vbs-accuracy">               <h5>Premium 99%</h5>               <span class="vbs-accuracy-label">Speaker Turns</span>           </td>           <td class="vbs-delivery vbs-delivery-1"></td>           <td class="vbs-delivery vbs-delivery-2-4"></td>           <td class="vbs-delivery vbs-delivery-5-7"></td>           <td class="vbs-review" rowspan="2">               <strong>3</strong><br>               <span>human reviews</span>           </td>           <td class="vbs-recommended" rowspan="2">               <span>Critical or legal matters, published content, highest possible accuracy.</span>           </td>       </tr>       <tr class="vbs-accuracy-row vbs-premium-plus-99 vbs-row-last">           <td class="vbs-accuracy">               <h5>Premium+ 99%</h5>               <span class="vbs-accuracy-label">Speaker ID</span>           </td>           <td class="vbs-delivery vbs-delivery-1"></td>           <td class="vbs-delivery vbs-delivery-2-4"></td>           <td class="vbs-delivery vbs-delivery-5-7"></td>       </tr>   </tbody></table></div>'},offeringCell:function(){return'<div class="block vbs-offeringCell" id="offering_{{ offeringId }}" data-offer-id="{{ offeringId }}">   <strong>{{ productPrice }}</strong>   <span> per min</span></div>'},totalInfo:function(){return'<div class="vbs-humanCost">   <div class="vbs-cost">       <span class="vbs-cost-label">Total Cost to Transcribe File ({{ mediaLength }}m): </span>       <span class="vbs-cost-value">{{ costValue }}</span>   </div>   <small class="vbs-product-description">       <span class="vbs-product-description-label">Selection</span>       <span class="vbs-product-description-value">{{ productDescription }}</span>   </small></div>'},offeringButtons:function(){return'<div class="vbs-offering-buttons">   <span>       <input type="submit" name="main" value="Continue" class="vbs-offering-btn vbs-aggree-btn">   </span>   <span>       <a href="javascript:void(0)" class="vbs-offering-btn vbs-cancel-btn vbs-cancel-choose-offer">Cancel</a>   </span>   <div class="vbs-human-terms">       by ordering you agree to our        <a href="http://www.voicebase.com/terms-of-use" target="_blank">Terms of Use</a>   </div></div>'},confirmationPage:function(){return'<div class="vbs-confirm-offer-inner-container">   <ul class="vbs-order-details">       <li class="vbs-order-details-title">           <dl>               <dt>Record Name</dt>               <dd class="vbs-dd-length">Length</dd>               <dd>Rate</dd>               <dd class="vbs-dd-last">Cost</dd>           </dl>       </li>       <li>           <dl>               <dt class="vbs-record-name">{{ recordName }}</dt>               <dd class="vbs-dd-length">{{ mediaLengthInMinutes }}</dd>               <dd></dd>               <dd class="vbs-dd-last">{{ amount }}</dd>           </dl>       </li>       <li class="vbs-order-details-total">           <dl>               <dt>TOTAL:</dt>               <dd class="vbs-dd-length">{{ mediaLengthInMinutes }}</dd>               <dd></dd>               <dd class="vbs-dd-last">{{ amount }}</dd>           </dl>       </li>   </ul>   <div class="vbs-clearfix"></div>   <p>{{ qualityDescription }}, {{ deliveryDescription }} <br></p>   <div class="vbs-form-group vbs-field-orderform-notesfortranscriber">       <textarea class="vbs-form-field vbs-form-textarea vbs-orderform-notesfortranscriber" name="OrderForm[notesForTranscriber]" rows="3" cols="50" placeholder="Notes for transcriber: names, brand names, acronyms, and other words to help create an accurate transcript. We cannot change the order here. Do NOT request price changes or partial transcription of the recording."></textarea>   </div>   <div class="vbs-offer-text">       <div>&gt;{{ percent }}% of intelligible content will be transcribed. </div>       <div>Best efforts will be made to identify speakers </div>       <div>Unintelligible content will not be transcribed. </div>       <div>Extremely bad audio will be rejected. </div>       <div>Transcript will be delivered by email</div>       <div>and on the individual recording playback page within the specified time</div>   </div>   <div>       <div class="vbs-offer-text2" dir="ltr">Transcription quality and delivery are highly dependent on a variety of factors including, but not limited to, audio quality, accents, background noise, and speaker fluency. Accuracy is measured relative to the intelligible portion of the recording.</div>       <div class="vbs-offer-text2" dir="ltr">           Speaker identification works best with 2-5 speakers. More than 5 speaker may delay the transcript and may have some misidentification.. <br>       </div> <br>       <p class="vbs-offer-text2 vbs-mt0" dir="ltr">Customers maximum and sole remedy in the event of errors or any alleged damages arising from any aspect of transcript quality or delivery is a refund of the original transcript price.</p>   </div></div><div class="vbs-response-error-message"></div><div class="vbs-confirmation-response-info">   <div class="vbs-response-message-container"></div>   <div class="vbs-close-btn">       <span>           <a href="javascript:void(0)" class="vbs-offering-btn vbs-cancel-btn vbs-offerings-popup-close">Close</a>       </span>   </div></div><div class="vbs-confirm-order-loader"></div><div class="vbs-confirmation-buttons">   <span>       <input type="submit" name="main" value="Place Your Order" class="vbs-offering-btn vbs-aggree-btn vbs-confirm-order">   </span>   <span>       <a href="javascript:void(0)" class="vbs-offering-btn vbs-cancel-btn vbs-cancel-confirm-offer">Cancel</a>   </span></div>'},uploadMediaResponseInfo:function(){return'<div class="vbs-response-message">   <strong>Your order is successfully accepted!</strong></div><div class="vbs-response-message-label">Media id: {{ mediaId }}</div><div class="vbs-response-message-label">File url: <a href="{{ fileUrl }}" target="_blank">{{ fileUrl }}</a></div>'},upgradeTranscriptResponseInfo:function(){return'<div class="vbs-response-message">   <strong>Your order is successfully accepted!</strong></div><div class="vbs-response-message-label">Media id: {{ mediaId }}</div>'}},e}(voiceBaseOfferings,jQuery),voiceBaseOfferings=function(e,s){"use strict";return e.api={getOfferings:function(r){var a=e.settings.apiUrl,n={version:e.settings.version,apikey:e.settings.apiKey,password:e.settings.password,action:e.settings.action,length:e.settings.mediaLengthInMinutes,language:e.settings.language};s.ajax({type:"GET",url:a,data:n,success:function(e){r&&r(e)},error:function(e,s,r){console.log(r+": Error "+e.status)}})},getOfferingData:function(r){var a=new s.Deferred,n=e.settings.apiUrl.replace("services","voice_file");return n+="/getOfferingData",s.ajax({type:"GET",url:n,data:{offeringId:r,mediaId:e.settings.mediaId,length:60*e.settings.mediaLengthInMinutes,languageId:1,maxFileLength:60*e.settings.mediaLengthInMinutes},success:function(e){a.resolve(JSON.parse(e))},error:function(e,s,r){console.log(r+": Error "+e.status),a.reject()}}),a.promise()},upgradeTranscript:function(r){var a=new s.Deferred,n=e.settings.apiUrl;return s.ajax({type:"GET",url:n,data:{version:e.settings.version,apikey:e.settings.apiKey,password:e.settings.password,action:"upgradeTranscript",mediaId:e.settings.mediaId,offeringID:r},success:function(e){"SUCCESS"===e.requestStatus?a.resolve(e):a.reject(e.statusMessage)},error:function(e,s,r){console.log(r+": Error "+e.status),a.reject(r+": Error "+e.status)}}),a.promise()},uploadMedia:function(r){var a=new s.Deferred,n=e.settings.apiUrl;return s.ajax({type:"GET",url:n,data:{version:e.settings.version,apikey:e.settings.apiKey,password:e.settings.password,action:"uploadMedia",mediaURL:e.settings.mediaUrl,transcriptType:"human",offeringID:r},success:function(e){"SUCCESS"===e.requestStatus?a.resolve(e):a.reject(e.statusMessage)},error:function(e,s,r){console.log(r+": Error "+e.status),a.reject(r+": Error "+e.status)}}),a.promise()}},e}(voiceBaseOfferings,jQuery),voiceBaseOfferings=function(e,s){"use strict";return e.events={registerEvents:function(){s(document).off("touchstart click",".vbs-offerings-popup-close, .vbs-offering-btn.vbs-cancel-choose-offer").on("touchstart click",".vbs-offerings-popup-close, .vbs-offering-btn.vbs-cancel-choose-offer",function(){e.view.hidePopup()}),s(document).off("touchstart click",".vbs-offeringCell").on("touchstart click",".vbs-offeringCell",function(){s(".vbs-offeringCell").removeClass("selected"),s(this).addClass("selected");var r="getting data...";e.view.updateTotalCost(r,r);var a=s(this).attr("data-offer-id");e.api.getOfferingData(a).then(function(s){e.data.currentOffer=s;var r=s.quality_name+", "+s.quality_description+", "+s.delivery_description;e.view.updateTotalCost(s.amount_formated,r)},function(){alert("Error of getting offering data!")})}),s(document).off("touchstart click",".vbs-offering-btn.vbs-aggree-btn").on("touchstart click",".vbs-offering-btn.vbs-aggree-btn",function(){e.view.confirmOrder()}),s(document).off("touchstart click",".vbs-offering-btn.vbs-cancel-confirm-offer").on("touchstart click",".vbs-offering-btn.vbs-cancel-confirm-offer",function(){e.view.cancelConfirmOrder()}),s(document).off("touchstart click",".vbs-offering-btn.vbs-confirm-order").on("touchstart click",".vbs-offering-btn.vbs-confirm-order",function(){var r=e.data.currentOffer.ref_offering;e.view.clearResponseErrorMessage();var a=s(".vbs-confirm-order-loader");e.view.addLoader(a),"upgrade"===e.settings.mode?e.api.upgradeTranscript(r).then(function(s){e.view.removeLoader(a),e.view.showResponseOrder(e.settings.mode,s)},function(s){e.view.removeLoader(a),e.view.showResponseErrorMessage(s)}):e.api.uploadMedia(r).then(function(s){e.view.removeLoader(a),e.view.showResponseOrder(e.settings.mode,s)},function(s){e.view.removeLoader(a),e.view.showResponseErrorMessage(s)})})}},e}(voiceBaseOfferings,jQuery),voiceBaseOfferings=function(e,s){"use strict";return e.view={createPopup:function(){e.view.removePopup();var r=s(e.view.getTemplate("offeringPopup"));e.view.addLoader(r.find(".vbs-offerings-popup-body")),s("body").append(r)},createOfferTable:function(r){var a={"vbs-delivery-1":{name:"1 Day",hasInResponse:!1},"vbs-delivery-2-4":{name:"2-4 Days",hasInResponse:!1},"vbs-delivery-5-7":{name:"5-7 Days",hasInResponse:!1}},n={"vbs-accuracy-econo":{name:"Econo 90-95%",hasInResponse:!1,values:{}},"vbs-pro-98":{name:"Pro 98%",hasInResponse:!1,values:{}},"vbs-pro-plus-98":{name:"Pro+ 98%",hasInResponse:!1,values:{}},"vbs-premium-99":{name:"Premium 99%",hasInResponse:!1,values:{}},"vbs-premium-plus-99":{name:"Premium+ 99%",hasInResponse:!1,values:{}}};r.offerings.forEach(function(s){var r=e.view.getKeyByName(a,s.deliveryTime);r&&(a[r].hasInResponse=!0);var t=e.view.getItemByName(n,s.accuracy);t&&(t.hasInResponse=!0,t.values[r]={id:s.offeringId,cost:s.cost,productPrice:s.productPrice})});var t=s(e.view.getTemplate("offeringTable"));for(var i in a)a[i].hasInResponse||t.find(i).remove();for(i in n)if(n[i].hasInResponse)for(var o in n[i].values){var d=n[i].values[o],c=e.view.getTemplate("offeringCell",{offeringId:d.id,productPrice:d.productPrice});t.find("."+i).find("."+o).html(c)}else t.find(i).remove();s(".vbs-offerings-popup").find(".vbs-choose-offer-container").empty().append(t),e.view.removeLoader(s(".vbs-offerings-popup").find(".vbs-offerings-popup-body"));var v=e.view.getTemplate("offeringButtons");s(".vbs-humanRequest").after(v),s("#offering_6").click()},updateTotalCost:function(r,a){s(".vbs-humanCost").remove();var n=e.view.getTemplate("totalInfo",{mediaLength:e.settings.mediaLengthInMinutes,costValue:r,productDescription:a});s(".vbs-humanRequest").after(n)},createConfirmationPage:function(){var r=e.data.currentOffer,a=r.quality_description.indexOf("%"),n=r.quality_description.substring(a-2,a),t=e.view.getTemplate("confirmationPage",{recordName:e.settings.recordName,mediaLengthInMinutes:e.settings.mediaLengthInMinutes,amount:r.amount_formated,deliveryDescription:r.delivery_description,qualityDescription:r.quality_description,percent:n});s(".vbs-offerings-popup").find(".vbs-confirm-offer-container").empty().append(t)},confirmOrder:function(){s(".vbs-offerings-popup").find(".vbs-offerings-popup-header-title").text("Order Details"),e.view.createConfirmationPage();var r=s(".vbs-offerings-popup").find(".vbs-confirm-offer-container");s(".vbs-offerings-popup").find(".vbs-choose-offer-container").hide(),r.show()},cancelConfirmOrder:function(){s(".vbs-offerings-popup").find(".vbs-offerings-popup-header-title").text("Choose the Accuracy and Delivery You Need"),s(".vbs-offerings-popup").find(".vbs-choose-offer-container").show(),s(".vbs-offerings-popup").find(".vbs-confirm-offer-container").hide()},showResponseOrder:function(r,a){s(".vbs-confirmation-buttons").hide();var n,t=s(".vbs-confirmation-response-info");"upgrade"===r?n=e.view.getTemplate("upgradeTranscriptResponseInfo",{mediaId:e.settings.mediaId}):"new"===r&&(n=e.view.getTemplate("uploadMediaResponseInfo",{mediaId:a.mediaId,fileUrl:a.fileUrl})),t.find(".vbs-response-message-container").empty().append(n),t.show()},showResponseErrorMessage:function(e){s(".vbs-response-error-message").empty().append("Error: "+e)},clearResponseErrorMessage:function(){s(".vbs-response-error-message").empty()},getKeyByName:function(e,s){var r=null;for(var a in e)if(e[a].name===s){r=a;break}return r},getItemByName:function(e,s){var r=null;for(var a in e)if(e[a].name===s){r=e[a];break}return r},addLoader:function(s){s.append(e.view.getTemplate("ajaxLoader"))},removeLoader:function(e){e.find(".vbs-ajax-loader").remove()},showPopup:function(){s(".vbs-offerings-popup").show()},hidePopup:function(){s(".vbs-offerings-popup").hide()},removePopup:function(){s(".vbs-offerings-popup").remove()},getTemplate:function(s,r){if(!e.templates[s])return"";var a=e.templates[s]();for(var n in r){var t=new RegExp("{{\\s*"+n+"\\s*}}","gi");a=a.replace(t,r[n])}return a}},e}(voiceBaseOfferings,jQuery);